

================================================================================
文件路径: .eslintrc.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\.eslintrc.js
================================================================================

module.exports = {
  root: true,
  env: {
    node: true
  },
  extends: [
    'plugin:vue/essential',
    'eslint:recommended'
  ],
  parserOptions: {
    parser: '@babel/eslint-parser',
    requireConfigFile: false
  },
  rules: {
    'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'vue/no-parsing-error': [2, { 'x-invalid-end-tag': false }]
  }
} 

================================================================================
文件路径: babel.config.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\babel.config.js
================================================================================

module.exports = {
  presets: [
    '@vue/cli-plugin-babel/preset'
  ]
} 

================================================================================
文件路径: combine.py
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\combine.py
================================================================================

import os

def is_code_file(filename):
    """检查文件是否为代码文件"""
    code_extensions = ['.py', '.js', '.vue', '.html', '.css', '.java', '.c', '.cpp', '.h', '.go', '.php', '.rb', '.sh']
    return any(filename.endswith(ext) for ext in code_extensions)

def get_file_content(filepath):
    """读取文件内容，处理可能的编码问题"""
    try:
        with open(filepath, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        try:
            with open(filepath, 'r', encoding='gbk') as f:
                return f.read()
        except Exception as e:
            return f"<无法读取文件内容，编码错误: {str(e)}>"
    except Exception as e:
        return f"<读取文件出错: {str(e)}>"

def process_directory(root_dir, output_file):
    """处理目录，收集所有代码文件信息"""
    with open(output_file, 'w', encoding='utf-8') as out_f:
        for root, dirs, files in os.walk(root_dir):
            for file in files:
                if is_code_file(file):
                    filepath = os.path.join(root, file)
                    relative_path = os.path.relpath(filepath, start=root_dir)
                    
                    # 写入文件信息
                    out_f.write(f"\n\n{'=' * 80}\n")
                    out_f.write(f"文件路径: {relative_path}\n")
                    out_f.write(f"完整路径: {filepath}\n")
                    out_f.write(f"{'=' * 80}\n\n")
                    
                    # 写入文件内容
                    content = get_file_content(filepath)
                    out_f.write(content)

if __name__ == "__main__":
    # 设置输出文件名
    output_filename = "all_code_contents.txt"
    
    # 获取当前目录
    current_dir = os.getcwd()
    
    print(f"开始处理目录: {current_dir}")
    print(f"代码内容将保存到: {output_filename}")
    
    # 处理目录
    process_directory(current_dir, output_filename)
    
    print("处理完成！")



================================================================================
文件路径: vue.config.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\vue.config.js
================================================================================

module.exports = {
  publicPath: process.env.NODE_ENV === 'production' ? '/' : '/',
  outputDir: 'dist',
  assetsDir: 'static',
  lintOnSave: process.env.NODE_ENV === 'development',
  productionSourceMap: false,
  devServer: {
    port: 8080,
    open: true,
    client: {
      overlay: {
        warnings: false,
        errors: true
      }
    },
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
        pathRewrite: {
          '^/api': '/api'
        }
      }
    }
  },
  css: {
    loaderOptions: {
      sass: {
        // 这里使用的是sass的新API，与node-sass不同
        // 注意：sass-loader v8+需要这样写，v7-使用data
        additionalData: `@import "@/assets/css/variables.scss";`
      }
    }
  }
} 

================================================================================
文件路径: src\App.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\App.vue
================================================================================

<template>
  <div id="app">
    <router-view />
  </div>
</template>

<script>
export default {
  name: 'App'
}
</script>

<style>
@import '@/assets/css/global.css';

#app {
  font-family: 'Poppins', 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  height: 100%;
  width: 100%;
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

/* 全局滚动条样式 */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #a8a8a8;
}

/* 全局过渡效果 */
.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.3s;
}
.fade-enter,
.fade-leave-to {
  opacity: 0;
}

.slide-fade-enter-active {
  transition: all 0.3s ease-out;
}
.slide-fade-leave-active {
  transition: all 0.3s cubic-bezier(1, 0.5, 0.8, 1);
}
.slide-fade-enter-from,
.slide-fade-leave-to {
  transform: translateX(20px);
  opacity: 0;
}
</style>


================================================================================
文件路径: src\main.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\main.js
================================================================================

import Vue from 'vue'
import App from './App.vue'
import router from './router'
import store from './store'
import ElementUI from 'element-ui'
import 'element-ui/lib/theme-chalk/index.css'
import './assets/css/global.css'
import axios from 'axios'

// 提供默认logo
import DefaultLogo from './assets/logo.svg'
Vue.prototype.$defaultLogo = DefaultLogo

// 配置ElementUI
Vue.use(ElementUI, { size: 'medium' })

// 配置axios
axios.defaults.baseURL = process.env.VUE_APP_API_URL || 'http://localhost:8000/api'
// 请求拦截器，添加token到请求头
axios.interceptors.request.use(config => {
  const token = store.getters.token
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
}, error => {
  return Promise.reject(error)
})

// 响应拦截器，处理token过期等问题
axios.interceptors.response.use(response => {
  return response
}, error => {
  if (error.response && error.response.status === 401) {
    // token过期，清除用户信息并跳转到登录页
    store.dispatch('user/logout')
    router.push('/login')
  }
  return Promise.reject(error)
})

Vue.prototype.$http = axios
Vue.config.productionTip = false

new Vue({
  router,
  store,
  render: h => h(App)
}).$mount('#app')


================================================================================
文件路径: src\api\auth.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\api\auth.js
================================================================================




================================================================================
文件路径: src\api\detection.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\api\detection.js
================================================================================

import axios from 'axios'

// 获取检测历史
export function getDetectionHistory() {
  return axios.get('/detection/detections/my_detections/')
}

// 获取检测详情
export function getDetectionDetail(id) {
  return axios.get(`/detection/detections/${id}/`)
}

// 创建新检测
export function createDetection(data) {
  const formData = new FormData()
  formData.append('title', data.title)
  formData.append('content', data.content)
  
  if (data.image) {
    formData.append('image', data.image)
  }
  
  return axios.post('/detection/detections/', formData, {
    headers: {
      'Content-Type': 'multipart/form-data'
    }
  })
}

// 获取检测结果
export function getDetectionResult(id) {
  return axios.get(`/detection/detections/${id}/result/`)
}

// 获取检测统计信息
export function getDetectionStats(isAdmin = false) {
  const url = isAdmin ? '/detection/detections/get_stats/?all=true' : '/detection/detections/get_stats/'
  return axios.get(url)
}

// 删除检测记录
export function deleteDetection(id) {
  return axios.delete(`/detection/detections/${id}/`, {
    headers: {
      'X-CSRFToken': document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*=\s*([^;]*).*$)|^.*$/, '$1')
    }
  })
}


================================================================================
文件路径: src\api\index.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\api\index.js
================================================================================




================================================================================
文件路径: src\api\news.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\api\news.js
================================================================================




================================================================================
文件路径: src\api\user.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\api\user.js
================================================================================

import axios from 'axios'

// 登录
export function login(data) {
  return axios.post('/users/token/', data)
}

// 获取用户信息
export function getUserInfo() {
  return axios.get('/users/me/')
}

// 注册
export function register(data) {
  return axios.post('/users/', data)
}

// 修改用户信息
export function updateUserInfo(id, data) {
  return axios.patch(`/users/${id}/`, data)
}

// 修改密码
export function changePassword(id, data) {
  return axios.post(`/users/${id}/change_password/`, data)
}

// 获取用户统计
export function getUserStats() {
  return axios.get('/users/stats/')
}


================================================================================
文件路径: src\assets\css\global.css
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\assets\css\global.css
================================================================================

/* 全局样式 */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

:root {
  --primary: #4361ee;
  --success: #4cc9f0;
  --warning: #f72585;
  --danger: #f15bb5;
  --info: #4895ef;
  --dark: #2b2d42;
  --light: #f8f9fa;
  --gray: #6c757d;
  --border-radius: 8px;
  --transition: all 0.3s ease;
  --box-shadow: 0 6px 16px 0 rgba(0, 0, 0, 0.08);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: 'Poppins', 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  color: var(--dark);
  background-color: var(--light);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.container {
  padding: 24px;
  max-width: 1200px;
  margin: 0 auto;
}

.page-title {
  margin-bottom: 24px;
  font-size: 24px;
  font-weight: 600;
  color: var(--dark);
}

.card-container {
  background: #fff;
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  padding: 24px;
  margin-bottom: 24px;
  transition: var(--transition);
}

.card-container:hover {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
}

/* 按钮样式 */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 8px 16px;
  border-radius: var(--border-radius);
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  border: none;
  outline: none;
}

.btn-primary {
  background-color: var(--primary);
  color: white;
}

.btn-primary:hover {
  background-color: #3a56d4;
}

/* 新增现代按钮样式 */
.btn-gradient {
  background: linear-gradient(90deg, var(--primary), var(--info));
  color: white;
  border: none;
}

.btn-gradient:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(67, 97, 238, 0.4);
}

.btn-outline {
  background: transparent;
  border: 2px solid var(--primary);
  color: var(--primary);
}

.btn-outline:hover {
  background-color: var(--primary);
  color: white;
}

.btn-rounded {
  border-radius: 50px;
}

.btn-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.btn-icon i {
  margin-right: 8px;
}

.btn-icon-only {
  width: 40px;
  height: 40px;
  padding: 0;
  border-radius: 50%;
}

.btn-floating {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 99;
}

.btn-floating:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
}

.btn-sm {
  padding: 6px 12px;
  font-size: 12px;
}

.btn-lg {
  padding: 12px 24px;
  font-size: 16px;
}

/* 颜色工具类 */
.text-primary {
  color: var(--primary);
}

.text-success {
  color: var(--success);
}

.text-warning {
  color: var(--warning);
}

.text-danger {
  color: var(--danger);
}

.text-info {
  color: var(--info);
}

.text-center {
  text-align: center;
}

.flex-center {
  display: flex;
  justify-content: center;
  align-items: center;
}

.flex-between {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* Margin utilities */
.m-0 { margin: 0; }
.mt-10 { margin-top: 10px; }
.mt-20 { margin-top: 20px; }
.mt-30 { margin-top: 30px; }
.mb-10 { margin-bottom: 10px; }
.mb-20 { margin-bottom: 20px; }
.mb-30 { margin-bottom: 30px; }
.ml-10 { margin-left: 10px; }
.mr-10 { margin-right: 10px; }

/* Padding utilities */
.p-0 { padding: 0; }
.p-10 { padding: 10px; }
.p-20 { padding: 20px; }
.pt-10 { padding-top: 10px; }
.pb-10 { padding-bottom: 10px; }
.pl-10 { padding-left: 10px; }
.pr-10 { padding-right: 10px; }

/* Animation utilities */
.fade-enter-active, .fade-leave-active {
  transition: opacity 0.3s;
}
.fade-enter, .fade-leave-to {
  opacity: 0;
}

/* Form styles */
.form-group {
  margin-bottom: 20px;
}

.form-label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
}

.form-control {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #dee2e6;
  border-radius: var(--border-radius);
  transition: var(--transition);
}

.form-control:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.25);
  outline: none;
} 

================================================================================
文件路径: src\router\index.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\router\index.js
================================================================================

import Vue from 'vue'
import VueRouter from 'vue-router'
import store from '@/store'

Vue.use(VueRouter)

// 路由懒加载
const Home = () => import('@/views/Home.vue')
const Login = () => import('@/views/Login.vue')
const Register = () => import('@/views/Register.vue')
const Layout = () => import('@/views/layout/Layout.vue')
const Dashboard = () => import('@/views/dashboard/Dashboard.vue')
const DetectionCreate = () => import('@/views/detection/Create.vue')
const DetectionHistory = () => import('@/views/detection/History.vue')
const DetectionDetail = () => import('@/views/detection/Detail.vue')
const Profile = () => import('@/views/user/Profile.vue')
const NotFound = () => import('@/views/NotFound.vue')

// 管理员相关组件
const AdminLayout = () => import('@/views/admin/AdminLayout.vue')
const AdminDashboard = () => import('@/views/admin/Dashboard.vue')
const AdminUsers = () => import('@/views/admin/Users.vue')
const AdminSettings = () => import('@/views/admin/Settings.vue')
const DetectionStatistics = () => import('@/views/admin/DetectionStatistics.vue')
// 系统日志页面 - 懒加载
const SystemLogs = () => import('@/views/admin/SystemLogs.vue')

const routes = [
  {
    path: '/',
    name: 'Home',
    component: Home,
    meta: { title: '首页', noAuth: true }
  },
  {
    path: '/login',
    name: 'Login',
    component: Login,
    meta: { title: '登录', noAuth: true }
  },
  {
    path: '/register',
    name: 'Register',
    component: Register,
    meta: { title: '注册', noAuth: true }
  },
  {
    path: '/dashboard',
    component: Layout,
    redirect: '/dashboard/index',
    children: [
      {
        path: 'index',
        name: 'Dashboard',
        component: Dashboard,
        meta: { title: '仪表盘', icon: 'el-icon-data-analysis' }
      },
      {
        path: 'detection/create',
        name: 'DetectionCreate',
        component: DetectionCreate,
        meta: { title: '新闻检测', icon: 'el-icon-search' }
      },
      {
        path: 'detection/history',
        name: 'DetectionHistory',
        component: DetectionHistory,
        meta: { title: '检测历史', icon: 'el-icon-time' }
      },
      {
        path: 'detection/detail/:id',
        name: 'DetectionDetail',
        component: DetectionDetail,
        meta: { title: '检测详情', hideInMenu: true }
      },
      {
        path: 'profile',
        name: 'Profile',
        component: Profile,
        meta: { title: '个人中心', icon: 'el-icon-user' }
      }
    ]
  },
  // 添加管理员路由
  {
    path: '/admin',
    component: AdminLayout,
    redirect: '/admin/dashboard',
    meta: { requiresAdmin: true },
    children: [
      {
        path: 'dashboard',
        name: 'AdminDashboard',
        component: AdminDashboard,
        meta: { title: '控制面板' }
      },
      {
        path: 'users',
        name: 'AdminUsers',
        component: AdminUsers,
        meta: { title: '用户列表' }
      },
      {
        path: 'settings',
        name: 'AdminSettings',
        component: AdminSettings,
        meta: { title: '系统设置' }
      },
      {
        path: 'detection/list',
        name: 'AdminDetectionList',
        component: DetectionHistory,
        meta: { title: '检测列表' }
      },
      {
        path: 'detection/detail/:id',
        name: 'AdminDetectionDetail',
        component: DetectionDetail,
        meta: { title: '检测详情', hideInMenu: true }
      },
      {
        path: 'detection-stats',
        name: 'AdminDetectionStats',
        component: DetectionStatistics,
        meta: { title: '检测统计' }
      },
      {
        path: 'logs',
        name: 'AdminLogs',
        component: SystemLogs,
        meta: { title: '系统日志' }
      }
    ]
  },
  {
    path: '/404',
    name: 'NotFound',
    component: NotFound,
    meta: { title: '页面不存在', noAuth: true, hideInMenu: true }
  },
  // 重定向到404
  { path: '*', redirect: '/404' }
]

const router = new VueRouter({
  mode: 'history',
  base: process.env.BASE_URL,
  routes,
  // 页面切换时滚动到顶部
  scrollBehavior() {
    return { x: 0, y: 0 }
  }
})

// 避免重复导航错误
const originalPush = VueRouter.prototype.push
VueRouter.prototype.push = function push(location) {
  return originalPush.call(this, location).catch(err => {
    if (err.name !== 'NavigationDuplicated') throw err
  })
}

// 全局前置守卫
router.beforeEach((to, from, next) => {
  // 设置页面标题
  document.title = to.meta.title ? `${to.meta.title} - 虚假新闻检测系统` : '虚假新闻检测系统'
  
  // 获取token状态
  const token = store.getters.token
  const isAdmin = store.getters.isAdmin
  
  // 首页特殊处理：已登录用户访问首页时自动跳转到仪表盘
  if (to.path === '/' && token) {
    next({ path: '/dashboard/index' })
    return
  }
  
  // 管理员页面检查
  if (to.matched.some(record => record.meta.requiresAdmin)) {
    if (!token) {
      next({ path: '/login', query: { redirect: to.fullPath } })
      return
    }
    
    if (!isAdmin) {
      next({ path: '/404' })
      return
    }
    
    // 管理员有权限访问，正常通过
    next()
    return
  }
  
  // 不需要登录的页面
  if (to.meta.noAuth) {
    next()
    return
  }
  
  // 判断是否已登录
  if (!token) {
    next({ path: '/login', query: { redirect: to.fullPath } })
    return
  }
  
  next()
})

export default router


================================================================================
文件路径: src\store\getters.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\store\getters.js
================================================================================

const getters = {
  // 用户信息
  token: state => state.user.token,
  user: state => state.user.user,
  roles: state => state.user.roles,
  isAdmin: state => state.user.user ? state.user.user.is_staff : false,
  currentUser: state => state.user.user,
  
  // 检测相关
  detectionHistory: state => state.detection.detectionHistory,
  detectionStats: state => state.detection.stats,
  detections: state => state.detection.list,
  detectionCount: state => state.detection.count,
  currentDetection: state => state.detection.currentDetection
}

export default getters 

================================================================================
文件路径: src\store\index.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\store\index.js
================================================================================

import Vue from 'vue'
import Vuex from 'vuex'
import user from './modules/user'
import detection from './modules/detection'
import getters from './getters'

Vue.use(Vuex)

const store = new Vuex.Store({
  modules: {
    user,
    detection
  },
  getters
})

export default store


================================================================================
文件路径: src\store\modules\auth.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\store\modules\auth.js
================================================================================




================================================================================
文件路径: src\store\modules\detection.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\store\modules\detection.js
================================================================================

import axios from 'axios'

const state = {
  detectionHistory: [],
  currentDetection: null,
  stats: {
    total_count: 0,
    fake_count: 0,
    real_count: 0,
    pending_count: 0,
    completed_count: 0,
    failed_count: 0,
    fake_percentage: 0,
    real_percentage: 0,
    average_confidence: 0
  }
}

const mutations = {
  SET_DETECTION_HISTORY: (state, history) => {
    state.detectionHistory = history
  },
  SET_CURRENT_DETECTION: (state, detection) => {
    state.currentDetection = detection
  },
  ADD_DETECTION: (state, detection) => {
    state.detectionHistory.unshift(detection)
  },
  SET_STATS: (state, stats) => {
    state.stats = stats
  }
}

const actions = {
  // 获取检测历史
  getDetectionHistory({ commit }) {
    return new Promise((resolve, reject) => {
      axios.get('/detection/detections/my_detections/')
        .then(response => {
          const history = response.data.results || response.data
          commit('SET_DETECTION_HISTORY', history)
          resolve(history)
        })
        .catch(error => {
          reject(error)
        })
    })
  },

  // 获取检测详情
  getDetectionDetail({ commit }, id) {
    console.log(`Fetching detection detail for ID: ${id}`);
    if (!id || id === 'undefined') {
      console.error('Attempted to fetch detail with invalid ID:', id);
      return Promise.reject(new Error('Invalid ID for detection detail'));
    }
    return new Promise((resolve, reject) => {
      axios.get(`/detection/detections/${id}/`)
        .then(response => {
          console.log('Backend response from getDetectionDetail:', response.data);
          commit('SET_CURRENT_DETECTION', response.data)
          resolve(response.data)
        })
        .catch(error => {
          console.error(`getDetectionDetail API call failed for ID ${id}:`, error.response || error);
          reject(error)
        })
    })
  },

  // 创建新检测
  createDetection({ commit }, detectionData) {
    return new Promise((resolve, reject) => {
      const formData = new FormData()
      formData.append('title', detectionData.title)
      formData.append('content', detectionData.content)
      if (detectionData.image) {
        formData.append('image', detectionData.image)
      }
      
      axios.post('/detection/detections/', formData, {
        headers: {
          'Content-Type': 'multipart/form-data'
        }
      })
        .then(response => {
          console.log('Backend response from createDetection:', response.data);
          commit('ADD_DETECTION', response.data)
          commit('SET_CURRENT_DETECTION', response.data)
          resolve(response.data)
        })
        .catch(error => {
          console.error('createDetection API call failed:', error.response || error);
          reject(error)
        })
    })
  },

  // 获取检测结果
  getDetectionResult({ commit }, id) {
    return new Promise((resolve, reject) => {
      axios.get(`/detection/detections/${id}/result/`)
        .then(response => {
          commit('SET_CURRENT_DETECTION', response.data)
          resolve(response.data)
        })
        .catch(error => {
          reject(error)
        })
    })
  },

  // 获取检测统计信息
  getDetectionStats({ commit }, isAdmin = false) {
    return new Promise((resolve, reject) => {
      const url = `/detection/detections/get_stats/${isAdmin ? '?all=true' : ''}`
      axios.get(url)
        .then(response => {
          commit('SET_STATS', response.data)
          resolve(response.data)
        })
        .catch(error => {
          reject(error)
        })
    })
  }
}

export default {
  namespaced: true,
  state,
  mutations,
  actions
}


================================================================================
文件路径: src\store\modules\news.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\store\modules\news.js
================================================================================




================================================================================
文件路径: src\store\modules\user.js
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\store\modules\user.js
================================================================================

import axios from 'axios'
import router from '@/router'
import Cookies from 'js-cookie'

const TOKEN_KEY = 'mm_dfd_token'
const USER_KEY = 'mm_dfd_user'

const state = {
  token: Cookies.get(TOKEN_KEY),
  user: JSON.parse(localStorage.getItem(USER_KEY) || '{}'),
  roles: []
}

const mutations = {
  SET_TOKEN: (state, token) => {
    state.token = token
  },
  SET_USER: (state, user) => {
    state.user = user
  },
  SET_ROLES: (state, roles) => {
    state.roles = roles
  }
}

const actions = {
  // 用户登录
  login({ commit }, userInfo) {
    const { username, password } = userInfo
    return new Promise((resolve, reject) => {
      axios.post('/users/token/', { username, password })
        .then(response => {
          const { access } = response.data
          commit('SET_TOKEN', access)
          Cookies.set(TOKEN_KEY, access, { expires: 7 }) // 保存7天
          resolve()
        })
        .catch(error => {
          reject(error)
        })
    })
  },

  // 获取用户信息
  getUserInfo({ commit }) {
    return new Promise((resolve, reject) => {
      axios.get('/users/me/')
        .then(response => {
          const user = response.data
          commit('SET_USER', user)
          localStorage.setItem(USER_KEY, JSON.stringify(user))
          
          // 设置用户角色
          const roles = ['user']
          if (user.is_staff) {
            roles.push('admin')
          }
          commit('SET_ROLES', roles)
          resolve(user)
        })
        .catch(error => {
          reject(error)
        })
    })
  },

  // 用户注册
  register({}, userInfo) {
    return new Promise((resolve, reject) => {
      axios.post('/users/', userInfo)
        .then(response => {
          resolve(response.data)
        })
        .catch(error => {
          reject(error)
        })
    })
  },

  // 更新用户信息
  updateUserInfo({ commit, state }, userInfo) {
    return new Promise((resolve, reject) => {
      axios.patch(`/users/${state.user.id}/`, userInfo)
        .then(response => {
          const updatedUser = { ...state.user, ...response.data }
          commit('SET_USER', updatedUser)
          localStorage.setItem(USER_KEY, JSON.stringify(updatedUser))
          resolve(updatedUser)
        })
        .catch(error => {
          reject(error)
        })
    })
  },

  // 修改密码
  changePassword({ state }, passwordInfo) {
    return new Promise((resolve, reject) => {
      axios.post(`/users/${state.user.id}/change_password/`, passwordInfo)
        .then(response => {
          resolve(response.data)
        })
        .catch(error => {
          reject(error)
        })
    })
  },

  // 用户登出
  logout({ commit }) {
    commit('SET_TOKEN', '')
    commit('SET_USER', {})
    commit('SET_ROLES', [])
    Cookies.remove(TOKEN_KEY)
    localStorage.removeItem(USER_KEY)
    router.push('/login')
  }
}

export default {
  namespaced: true,
  state,
  mutations,
  actions
}


================================================================================
文件路径: src\views\Home.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\Home.vue
================================================================================

<template>
  <div class="home-container">
    <!-- 导航栏 -->
    <header class="navbar">
      <div class="container navbar-container">
        <div class="logo-section">
          <el-image :src="logoSrc" alt="Logo" class="logo"></el-image>
          <h1 class="brand-name">MM-DFD</h1>
        </div>
        <div class="nav-links">
          <a href="#hero" class="nav-link">首页</a>
          <a href="#features" class="nav-link">功能</a>
          <a href="#about" class="nav-link">关于我们</a>
          <a href="#contact" class="nav-link">联系我们</a>
        </div>
        <div class="auth-buttons">
          <el-button type="text" class="login-btn" @click="goToLogin">登录</el-button>
          <el-button type="primary" class="register-btn btn-gradient btn-rounded" @click="goToRegister">免费注册</el-button>
        </div>
      </div>
    </header>

    <!-- 英雄区 -->
    <section id="hero" class="hero-section">
      <div class="container hero-container">
        <div class="hero-content">
          <h1 class="hero-title">多模态深度学习社交媒体虚假新闻检测系统</h1>
          <p class="hero-description">
            基于先进的深度学习技术，结合文本、图像等多模态数据，精准识别社交媒体上的虚假新闻，提供专业的真伪鉴别服务
          </p>
          <div class="hero-buttons">
            <el-button type="primary" class="btn-gradient btn-rounded btn-lg" @click="goToRegister">
              <i class="el-icon-s-promotion"></i> 开始免费体验
            </el-button>
            <el-button class="btn-outline btn-rounded btn-lg" @click="scrollToFeatures">
              <i class="el-icon-view"></i> 了解更多
            </el-button>
          </div>
        </div>
        <div class="hero-image">
          <div class="image-placeholder">
            <div class="detection-illustration"></div>
          </div>
        </div>
      </div>
      <div class="hero-background">
        <div class="bg-blob blob-1"></div>
        <div class="bg-blob blob-2"></div>
        <div class="bg-blob blob-3"></div>
      </div>
    </section>

    <!-- 统计数据 -->
    <section class="stats-section">
      <div class="container stats-container">
        <div class="stat-item">
          <div class="stat-number">90.3%</div>
          <div class="stat-label">检测准确率</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">200+</div>
          <div class="stat-label">每日检测次数</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">100+</div>
          <div class="stat-label">注册用户</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">24/7</div>
          <div class="stat-label">全天候服务</div>
        </div>
      </div>
    </section>

    <!-- 功能特点 -->
    <section id="features" class="features-section">
      <div class="container">
        <h2 class="section-title">强大功能<span class="highlight">特性</span></h2>
        <p class="section-subtitle">我们的系统采用最先进的技术，为您提供全方位的虚假新闻检测服务</p>
        
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="el-icon-picture"></i>
            </div>
            <h3 class="feature-title">多模态分析</h3>
            <p class="feature-description">
              同时分析文本、图像等多种信息，全方位评估新闻内容的真实性，提高检测准确率
            </p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">
              <i class="el-icon-cpu"></i>
            </div>
            <h3 class="feature-title">深度学习技术</h3>
            <p class="feature-description">
              采用前沿的深度学习算法，不断学习和适应新的虚假信息传播模式和技术
            </p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">
              <i class="el-icon-lightning"></i>
            </div>
            <h3 class="feature-title">实时检测</h3>
            <p class="feature-description">
              快速响应，在几秒钟内完成新闻检测，及时辨别虚假信息，防止其传播
            </p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">
              <i class="el-icon-data-line"></i>
            </div>
            <h3 class="feature-title">详细分析报告</h3>
            <p class="feature-description">
              提供全面的分析报告，包括可信度评分、可疑内容标记和详细分析解释
            </p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">
              <i class="el-icon-refresh"></i>
            </div>
            <h3 class="feature-title">持续更新</h3>
            <p class="feature-description">
              系统不断学习新的虚假信息模式，更新检测算法，确保始终保持高准确率
            </p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">
              <i class="el-icon-lock"></i>
            </div>
            <h3 class="feature-title">隐私保护</h3>
            <p class="feature-description">
              严格保护用户数据和检测内容的隐私，确保信息安全不被泄露或滥用
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- 关于我们 -->
    <section id="about" class="about-section">
      <div class="container">
        <div class="about-content">
          <div class="about-text">
            <h2 class="section-title">关于<span class="highlight">我们</span></h2>
            <p class="about-description">
              MM-DFD (多模态深度学习虚假新闻检测系统) 是一个专注于识别和防范虚假新闻传播的先进平台。我们的团队由人工智能专家、数据科学家和媒体研究人员组成，致力于创建更可信的信息环境。
            </p>
            <p class="about-description">
              在当今信息爆炸的时代，虚假新闻的快速传播对社会造成了严重影响。我们的使命是通过技术手段帮助用户快速识别虚假信息，提高社会媒体素养，促进健康信息生态系统的形成。
            </p>
            <p class="about-description">
              我们的系统不断学习和进化，适应新的虚假信息传播技术和模式，为用户提供最准确、最及时的检测服务。
            </p>
          </div>
          <div class="about-image">
            <div class="image-placeholder">
              <div class="about-illustration"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 如何使用 -->
    <section class="how-section">
      <div class="container">
        <h2 class="section-title">如何<span class="highlight">使用</span></h2>
        <p class="section-subtitle">简单几步，即可开始使用我们的虚假新闻检测服务</p>
        
        <div class="steps-container">
          <div class="step-item">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3 class="step-title">注册账号</h3>
              <p class="step-description">
                简单注册，创建您的个人账号，即可访问完整功能
              </p>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3 class="step-title">提交内容</h3>
              <p class="step-description">
                上传需要检测的新闻内容，包括文本、图片等多媒体资料
              </p>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3 class="step-title">获取结果</h3>
              <p class="step-description">
                系统快速分析并生成详细的检测报告，帮助您判断真伪
              </p>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">4</div>
            <div class="step-content">
              <h3 class="step-title">查看历史</h3>
              <p class="step-description">
                随时查看您的检测历史记录，便于追踪和管理
              </p>
            </div>
          </div>
        </div>
        
        <div class="cta-container">
          <el-button type="primary" class="btn-gradient btn-rounded btn-lg" @click="goToRegister">
            立即开始使用
          </el-button>
        </div>
      </div>
    </section>

    <!-- 联系我们 -->
    <section id="contact" class="contact-section">
      <div class="container">
        <h2 class="section-title">联系<span class="highlight">我们</span></h2>
        <p class="section-subtitle">如有任何问题或建议，请随时与我们联系</p>
        
        <div class="contact-info">
          <div class="contact-card">
            <div class="contact-icon">
              <i class="el-icon-message"></i>
            </div>
            <h3 class="contact-title">电子邮件</h3>
            <p class="contact-detail">lateyoung1@gmail.com</p>
          </div>
          
          <div class="contact-card">
            <div class="contact-icon">
              <i class="el-icon-phone"></i>
            </div>
            <h3 class="contact-title">电话</h3>
            <p class="contact-detail">+86 123 4567 8910</p>
          </div>
          
          <div class="contact-card">
            <div class="contact-icon">
              <i class="el-icon-location"></i>
            </div>
            <h3 class="contact-title">地址</h3>
            <p class="contact-detail">昆明市呈贡区景明南路</p>
          </div>
        </div>
      </div>
    </section>

    <!-- 页脚 -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-logo">
            <el-image :src="logoSrc" alt="Logo" class="footer-logo-img"></el-image>
            <span class="footer-brand">MM-DFD</span>
          </div>
          
          <div class="footer-links">
            <div class="footer-links-column">
              <h3 class="footer-links-title">产品</h3>
              <a href="#features" class="footer-link">功能</a>
              <a href="#" class="footer-link">价格</a>
              <a href="#" class="footer-link">API</a>
            </div>
            
            <div class="footer-links-column">
              <h3 class="footer-links-title">资源</h3>
              <a href="#" class="footer-link">文档</a>
              <a href="#" class="footer-link">博客</a>
              <a href="#" class="footer-link">常见问题</a>
            </div>
            
            <div class="footer-links-column">
              <h3 class="footer-links-title">公司</h3>
              <a href="#about" class="footer-link">关于我们</a>
              <a href="#contact" class="footer-link">联系我们</a>
              <a href="#" class="footer-link">加入我们</a>
            </div>
            
            <div class="footer-links-column">
              <h3 class="footer-links-title">法律</h3>
              <a href="#" class="footer-link">隐私政策</a>
              <a href="#" class="footer-link">服务条款</a>
            </div>
          </div>
        </div>
        
        <div class="footer-bottom">
          <p class="copyright">© 2025 MM-DFD (多模态深度学习虚假新闻检测系统). 保留所有权利。</p>
          <div class="social-links">
            <a href="#" class="social-link">
              <i class="el-icon-s-platform"></i>
            </a>
            <a href="#" class="social-link">
              <i class="el-icon-s-marketing"></i>
            </a>
            <a href="#" class="social-link">
              <i class="el-icon-s-promotion"></i>
            </a>
          </div>
        </div>
      </div>
    </footer>
  </div>
</template>

<script>
export default {
  name: 'HomePage',
  data() {
    return {
      
    }
  },
  computed: {
    logoSrc() {
      try {
        return require('@/assets/logo.svg')
      } catch (e) {
        return ''
      }
    }
  },
  methods: {
    goToLogin() {
      this.$router.push('/login')
    },
    goToRegister() {
      this.$router.push('/register')
    },
    scrollToFeatures() {
      const featuresSection = document.getElementById('features')
      if (featuresSection) {
        featuresSection.scrollIntoView({ behavior: 'smooth' })
      }
    }
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

/* 全局样式 */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
}

.section-title {
  font-size: 36px;
  font-weight: 700;
  margin-bottom: 20px;
  text-align: center;
  color: $main-font-color;
  
  .highlight {
    color: $primary-color;
    position: relative;
    
    &::after {
      content: '';
      position: absolute;
      bottom: 5px;
      left: 0;
      width: 100%;
      height: 8px;
      background-color: rgba($primary-color, 0.2);
      z-index: -1;
    }
  }
}

.section-subtitle {
  font-size: 18px;
  line-height: 1.6;
  text-align: center;
  color: $secondary-font-color;
  max-width: 700px;
  margin: 0 auto 60px;
}

/* 导航栏 */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background-color: rgba(255, 255, 255, 0.95);
  box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
  z-index: 100;
  backdrop-filter: blur(10px);
  padding: 10px 0;
}

.navbar-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo-section {
  display: flex;
  align-items: center;
}

.logo {
  width: 40px;
  height: 40px;
}

.brand-name {
  margin: 0 0 0 10px;
  font-size: 24px;
  font-weight: 700;
  color: $main-font-color;
}

.nav-links {
  display: flex;
  gap: 30px;
}

.nav-link {
  color: $regular-font-color;
  text-decoration: none;
  font-weight: 500;
  font-size: 16px;
  transition: $transition-base;
  position: relative;
  
  &::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 0;
    height: 2px;
    background-color: $primary-color;
    transition: $transition-base;
  }
  
  &:hover {
    color: $primary-color;
    
    &::after {
      width: 100%;
    }
  }
}

.auth-buttons {
  display: flex;
  align-items: center;
  gap: 15px;
}

.login-btn {
  color: $primary-color;
  font-weight: 500;
  
  &:hover {
    color: darken($primary-color, 10%);
  }
}

.register-btn {
  padding: 10px 20px;
}

/* 英雄区 */
.hero-section {
  padding: 160px 0 100px;
  position: relative;
  overflow: hidden;
}

.hero-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 60px;
}

.hero-content {
  flex: 1;
  max-width: 600px;
}

.hero-title {
  font-size: 48px;
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 24px;
  color: $main-font-color;
  animation: fadeInUp 0.8s ease-out;
}

.hero-description {
  font-size: 18px;
  line-height: 1.6;
  color: $secondary-font-color;
  margin-bottom: 40px;
  animation: fadeInUp 1s ease-out;
}

.hero-buttons {
  display: flex;
  gap: 20px;
  animation: fadeInUp 1.2s ease-out;
}

.hero-image {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  animation: fadeIn 1.2s ease-out;
}

.image-placeholder {
  width: 100%;
  height: 400px;
  position: relative;
}

.detection-illustration {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: url('data:image/svg+xml;base64,PHN2ZyBpZD0iYjY1ODhjYTUtNjIzYy00YjJlLTljOGEtODVkYzRkMGM2ZGJmIiBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9Ijg4NS45MzQ3MyIgaGVpZ2h0PSI1OTAuMDAwMDEiIHZpZXdCb3g9IjAgMCA4ODUuOTM0NzMgNTkwLjAwMDAxIj48cGF0aCBkPSJNOTk1LjExOTQxLDY5NWwtLjk5OTc0LjAwMDMxVjI5NGExOTYuMDAwNDMsMTk2LjAwMDQzLDAsMCwwLTE5Ni0xOTZIMzA4LjExOTQxYTE5Ni4wMDA0MywxOTYuMDAwNDMsMCwwLDAtMTk2LDE5NnYyNzZhMTk2LjAwMDQyLDE5Ni4wMDA0MiwwLDAsMCwxOTYsMTk2aDQ5MVYWPSI+PC9wYXRoPjxwYXRoIGQ9Ik01MDEuNzE0NTUsNDYzLjQ0NTVjLTY0LjAwODczLDAtMTE2LjExNzc2LTUyLjEwOTM3LTExNi4xMTc3Ni0xMTYuMTE4MTFzNTIuMTA5LTExNi4xMTc3NiwxMTYuMTE3NzYtMTE2LjExNzc2UzYxNy44MzIzMSwyODMuMzE4NjYsNjE3LjgzMjMxLDM0Ny4zMjczOSw1NjUuNzIzMjgsNDYzLjQ0NTUsNTAxLjcxNDU1LDQ2My40NDU1Wm0wLTIwMi4xMTc3NmMtNDcuNDM2LDAtODYuMTE3NzYsMzguNjgxNzYtODYuMTE3NzYsODYuMTE3NzUsMCw0Ny40MzY1MiwzOC42ODE3Niw4Ni4xMTgxMSw4Ni4xMTc3Niw4Ni4xMTgxMXM4Ni4xMTc3Ni0zOC42ODE1OSw4Ni4xMTc3Ni04Ni4xMTgxMUM1ODcuODMyMzEsMzAwLjAwOTUsNTQ5LjE1MDU1LDI2MS4zMjc3NCw1MDEuNzE0NTUsMjYxLjMyNzc0WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE1Ny4wMzI2MyAtMTU1KSIgZmlsbD0iIzJiMmQ0MiI+PC9wYXRoPjxjaXJjbGUgY3g9IjM0NC42ODE5MyIgY3k9IjE5Mi4zMjczOSIgcj0iMTUiIGZpbGw9IiM0MzYxZWUiPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjM0NC42ODE5MyIgY3k9IjE5Mi4zMjczOSIgcj0iMTUiIGZpbGw9IiM0MzYxZWUiPjwvY2lyY2xlPjwvc3ZnPg==');
  background-size: cover;
  background-position: center;
  border-radius: $border-radius-large;
  box-shadow: $box-shadow-base;
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba($primary-color, 0.3), rgba($info-color, 0.3));
    border-radius: $border-radius-large;
  }
}

.hero-background {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: -1;
}

.bg-blob {
  position: absolute;
  border-radius: 50%;
  filter: blur(70px);
  opacity: 0.1;
}

.blob-1 {
  width: 500px;
  height: 500px;
  background: linear-gradient(135deg, $primary-color, $info-color);
  top: -200px;
  right: -100px;
  animation: float 20s infinite alternate ease-in-out;
}

.blob-2 {
  width: 600px;
  height: 600px;
  background: linear-gradient(135deg, $success-color, $info-color);
  bottom: -300px;
  left: -200px;
  animation: float 25s infinite alternate-reverse ease-in-out;
}

.blob-3 {
  width: 300px;
  height: 300px;
  background: linear-gradient(135deg, $warning-color, $primary-color);
  top: 40%;
  left: 40%;
  animation: float 15s infinite alternate ease-in-out;
}

/* 统计数据 */
.stats-section {
  padding: 60px 0;
  background-color: #fff;
  box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.03);
}

.stats-container {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  gap: 30px;
}

.stat-item {
  text-align: center;
  padding: 20px;
}

.stat-number {
  font-size: 48px;
  font-weight: 700;
  color: $primary-color;
  margin-bottom: 10px;
  background: linear-gradient(135deg, $primary-color, $info-color);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.stat-label {
  font-size: 18px;
  color: $regular-font-color;
  font-weight: 500;
}

/* 功能特点 */
.features-section {
  padding: 100px 0;
  background-color: $background-color;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 30px;
  margin-top: 60px;
}

.feature-card {
  background-color: white;
  border-radius: $border-radius-large;
  padding: 30px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
  transition: $transition-base;
  
  &:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
  }
}

.feature-icon {
  font-size: 40px;
  width: 80px;
  height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, rgba($primary-color, 0.1), rgba($info-color, 0.1));
  border-radius: 20px;
  margin-bottom: 20px;
  color: $primary-color;
}

.feature-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 15px;
  color: $main-font-color;
}

.feature-description {
  color: $regular-font-color;
  line-height: 1.6;
}

/* 关于我们 */
.about-section {
  padding: 100px 0;
}

.about-content {
  display: flex;
  align-items: center;
  gap: 60px;
}

.about-text {
  flex: 1;
}

.about-description {
  margin-bottom: 20px;
  color: $regular-font-color;
  font-size: 16px;
  line-height: 1.8;
}

.about-image {
  flex: 1;
}

.about-illustration {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: url('data:image/svg+xml;base64,PHN2ZyBpZD0iZTU1Y2QxOTUtYmI5ZC00ODI2LWFlNDktNzVlMzZkYTQ1ZTk3IiBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9Ijg5My42Mjg4MSIgaGVpZ2h0PSI3NDcuMTI2MjYiIHZpZXdCb3g9IjAgMCA4OTMuNjI4ODEgNzQ3LjEyNjI2Ij48cGF0aCBkPSJNMzg5Ljc3OTEyLDI2MC41OTg5NGMtMzQuNjYyOTQsMC03Mi45NTI4LDEuMzY4OS0xMTMuODY1NzgsNC4wOTk2MS0yMC44OTk5LDEuMzk0NTMtNDIuMTU3MjYsMy4xMjQ5MS02My4yMTE2Myw1LjE1MjM5LTM5LjUxOTc0LDMuODA0LTc2Ljg0MzczLDguMzg3NDUtMTExLjA4MTQyLDEzLjYzNDgtNS40OTgwNS44NDIyOS0xMS4wMjc4MywxLjcxMzg3LTE2LjQ3MDIxLDIuNjA3NDJhMTU1MS4wMjk2MywxNTUxLjAyOTYzLDAsMCwwLTE1Ny42OTQ3MywzMy43OTE3NmwtNC44OTY3MiwxLjI0OC45NzkzNSw3LjkyMzg5YTQ0MS4xNDcwOSw0NDEuMTQ3MDksMCwwLDAsNjguNjQ0ODQsMTgyLjgwNTY3bDEuMzgxODQsMi4yNDY1OCwyLjYxNjIxLS43NjUxM2E1ODMuNDIzNCw1ODMuNDIzNCwwLDAsMSw4MS4wMzgtMTcuOTQ1MzFsLjI4LTIuNjA3NGMzLjAxNzU4LTI4LjAwNDUsMTUuNTM3NTktNTkuODg0NzYsMzUuMjE3NzQtODkuODI5MzUsMTYuMDcyMjctMjQuMzkyNTgsMzMuNjY4NDUtNDQuMDcwMzcsNDkuMzE0LTU5LjE3OTJsMTAuMzcyLTkuNDkyMTktLjA1NjE1LS42MTc2NGMtMS4yNzY2MS0xNC4wMTM2Nyw1LjExNjctMjcuOTIwOSwxOS44NTgyLTQ0LjU0NTlDMjE3LjYzMjI1LDIzOS45MDYsODM2LjAwMDczLDI2MC41OTg5NCwzODkuNzc5MTIsMjYwLjU5ODk0WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE1My4xODU1OSAtNzYuNDM2ODcpIiBmaWxsPSIjZjJmMmYyIj48L3BhdGg+PHBhdGggZD0iTTE4Ni44NDY0NSwzMzIuNjM4MzVjNDYuODg5LTM3LjExMzgxLDE0MC44MDUzLTI4LjY0OTMsMjA2LjU0MzY3LTIwLjE3NDhDNDY0LjcxNywzMjIuNTQzNDksNTM2LjMzOTcyLDM0MS41NjY3MSw2MTAuMTAxLDM0MS41NjY3MVYzMzkuNTE3QzUzNi43MzUsMzM5LjUxNyw0NjUuNDQsNzYuNDM2ODcsMTUzLjE4NTU5LDc2LjQzNjg3WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE1My4xODU1OSAtNzYuNDM2ODcpIiBmaWxsPSIjNDM2MWVlIj48L3BhdGg+PHBhdGggZD0iTTQ5OC4zNzM1Miw1NDYuMTI0MDdhODcuMjQ1Nyw4Ny4yNDU3LDAsMCwxLTM2LjU4ODA3LDE3LjM5MzMxLDE5Ljg4Mjg1LDE5Ljg4Mjg1LDAsMCwxLTUuNjE2MDcuMDM5MTUsMTAuNjQ0MSwxMC42NDQxLDAsMCwxLTguNDAzLTUuNzgyNzksMTYuMDQzNzQsMTYuMDQzNzQsMCwwLDEtLjkyMTQ5LTEzLjAyMzcxYzIuNjAyLTguODk2NDgsMTAuNjY2ODUtMTUuOTE3MjQsMTguNDk5NzYtMjAuNzMxNzNhNzcuMDAxNDksNzcuMDAxNDksMCwwLDEsMzQuODE1NjctOS43NzgxYzUuMzU3NTItLjM5Mjc0LDExLjQ5MDUuOTA3NjksMTMuMjk0Nyw1Ljk2OTY5YTkuNTMyMTMsOS41MzIxMywwLDAsMS0xLjA1NTg1LDguNjc0MSwxNi41ODM0OSwxNi41ODM0OSwwLDAsMS03LjcyMTgxLDUuNzQzMDZaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTUzLjE4NTU5IC03Ni40MzY4NykiIGZpbGw9IiNmYmJlYmUiPjwvcGF0aD48cGF0aCBkPSJNNDYwLjAxNjMzLDU3OC45OTM0N2EzOS4zNDUzNCwzOS4zNDUzNCwwLDAsMCwyLjQ2OTc3LTUuNzM4MjZsMTUuNzcyNy0xLjY5OTE0LTEyLjc2MzcxLTguNDUzLDEwLjk2NDExLTEzLjA3MjQ0LTU4LjY0MjA3LDcuMzg0MzFhMjcuMDM5NTUsMjcuMDM5NTUsMCwwLDAtMTMuMjMwMjEsMTEuNDEwNDVsLjIzNTQ1LS43ODUxNWEyNC40NTgzNCwyNC40NTgzNCwwLDAsMC00LjE1OTg4LDEzLjMyNTQxYy0uMTQ0NDksNC43NDk1MywxLjMzMDkyLDkuNjEwNTYsNC40MDQ2MSwxMy4xNDI3MWEyOC4zOTgsMjguMzk4LDAsMCwwLDkuMTAxMDksNi4yNTk4MmM3LjYyMzI3LDMuMjE0NTgsMTYuMDkxNTYsNS4yMjY3NCwyNC4yNzkzLDUuNzY0Myw0LjAzNjg2LjM2NjU2LDguMzg1NTMuNDA3ODcsMTEuOTAwOTEtMS43MzE5NHMyLjA2MjgzLTUuOTc2ODUtLjU2NDQ5LTcuOTc0NDRhMTIuMzE4NjMsMTIuMzE4NjMsMCwwLDAtMi43NDItMS4yMjg3M2MtMTAuMTM4MjctMy40Mjk2LTIwLjUyODQ4LTcuNTExMzQtMjguNzE2NTYtMTQuNTExNzJhMzUuMTMzNDcsMzUuMTMzNDcsMCwwLDEtNy42MDA5MS04LjYyMDU1LDM4LjAxNDYzLDM4LjAxNDYzLDAsMCwxLTMuMDIzLTYuNDQ3MTkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNTMuMTg1NTkgLTc2LjQzNjg3KSIgZmlsbD0iIzJiMmQ0MiI+PC9wYXRoPjwvc3ZnPg==');
  background-size: cover;
  background-position: center;
  border-radius: $border-radius-large;
  box-shadow: $box-shadow-base;
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba($info-color, 0.3), rgba($primary-color, 0.3));
    border-radius: $border-radius-large;
  }
}

/* 如何使用 */
.how-section {
  padding: 100px 0;
  background-color: $background-color;
}

.steps-container {
  max-width: 800px;
  margin: 60px auto;
}

.step-item {
  display: flex;
  gap: 30px;
  align-items: flex-start;
  margin-bottom: 50px;
  position: relative;
  
  &:not(:last-child)::after {
    content: '';
    position: absolute;
    top: 80px;
    left: 30px;
    width: 2px;
    height: calc(100% - 30px);
    background-color: rgba($primary-color, 0.2);
  }
}

.step-number {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: linear-gradient(135deg, $primary-color, $info-color);
  color: white;
  font-size: 24px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 10px 20px rgba($primary-color, 0.3);
  z-index: 1;
}

.step-title {
  font-size: 22px;
  font-weight: 600;
  margin-bottom: 10px;
  color: $main-font-color;
}

.step-description {
  color: $regular-font-color;
  line-height: 1.6;
}

.cta-container {
  text-align: center;
  margin-top: 60px;
}

/* 联系我们 */
.contact-section {
  padding: 100px 0;
}

.contact-info {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 30px;
  margin-top: 60px;
}

.contact-card {
  background-color: white;
  border-radius: $border-radius-large;
  padding: 30px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
  text-align: center;
  flex: 1;
  min-width: 250px;
  max-width: 300px;
  transition: $transition-base;
  
  &:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
  }
}

.contact-icon {
  font-size: 30px;
  color: $primary-color;
  margin-bottom: 20px;
}

.contact-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 15px;
  color: $main-font-color;
}

.contact-detail {
  color: $regular-font-color;
  line-height: 1.6;
}

/* 页脚 */
.footer {
  background-color: #2b2d42;
  color: white;
  padding: 80px 0 30px;
}

.footer-content {
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 60px;
  margin-bottom: 60px;
}

.footer-logo {
  display: flex;
  align-items: center;
  margin-bottom: 20px;
}

.footer-logo-img {
  width: 40px;
  height: 40px;
}

.footer-brand {
  font-size: 24px;
  font-weight: 700;
  margin-left: 10px;
}

.footer-links {
  display: flex;
  flex-wrap: wrap;
  gap: 60px;
}

.footer-links-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 20px;
  color: white;
}

.footer-link {
  display: block;
  color: rgba(255, 255, 255, 0.7);
  text-decoration: none;
  margin-bottom: 10px;
  transition: $transition-base;
  
  &:hover {
    color: white;
  }
}

.footer-bottom {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 20px;
}

.copyright {
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
}

.social-links {
  display: flex;
  gap: 15px;
}

.social-link {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background-color: rgba(255, 255, 255, 0.1);
  color: white;
  text-decoration: none;
  transition: $transition-base;
  
  &:hover {
    background-color: $primary-color;
    transform: translateY(-3px);
  }
}

/* 动画 */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes float {
  0% {
    transform: translate(0, 0);
  }
  50% {
    transform: translate(30px, -30px);
  }
  100% {
    transform: translate(0, 0);
  }
}

/* 响应式 */
@media (max-width: $lg) {
  .hero-container {
    flex-direction: column;
  }
  
  .hero-content {
    text-align: center;
    max-width: 100%;
  }
  
  .hero-buttons {
    justify-content: center;
  }
  
  .image-placeholder {
    max-width: 500px;
    margin: 0 auto;
  }
  
  .about-content {
    flex-direction: column-reverse;
  }
  
  .section-title {
    font-size: 32px;
  }
  
  .hero-title {
    font-size: 36px;
  }
}

@media (max-width: $md) {
  .navbar-container {
    flex-direction: column;
    gap: 15px;
  }
  
  .nav-links {
    gap: 15px;
  }
  
  .features-grid {
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }
  
  .footer-content {
    flex-direction: column;
    gap: 40px;
  }
  
  .footer-links {
    gap: 30px;
  }
  
  .footer-bottom {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: $sm) {
  .hero-section {
    padding: 120px 0 60px;
  }
  
  .nav-links {
    flex-direction: column;
    align-items: center;
  }
  
  .auth-buttons {
    flex-direction: column;
    width: 100%;
  }
}
</style> 

================================================================================
文件路径: src\views\Login.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\Login.vue
================================================================================

<template>
  <div class="login-container">
    <div class="login-content">
      <div class="login-card">
        <div class="logo-container">
          <el-image :src="logoSrc" alt="Logo" class="logo"></el-image>
          <h2 class="title">多模态虚假新闻检测系统</h2>
        </div>
        
        <el-form ref="loginForm" :model="loginForm" :rules="loginRules" class="login-form">
          <el-form-item prop="username">
            <el-input 
              v-model="loginForm.username" 
              prefix-icon="el-icon-user" 
              placeholder="用户名"
              class="custom-input"
              @keyup.enter.native="handleLogin"
            />
          </el-form-item>
          
          <el-form-item prop="password">
            <el-input 
              v-model="loginForm.password" 
              prefix-icon="el-icon-lock" 
              type="password" 
              placeholder="密码"
              class="custom-input"
              @keyup.enter.native="handleLogin"
            />
          </el-form-item>
          
          <el-button 
            :loading="loading" 
            type="primary" 
            class="login-button" 
            @click="handleLogin"
          >
            登 录
          </el-button>
          
          <div class="login-options">
            <span class="register-link" @click="goToRegister">注册账号</span>
          </div>
        </el-form>
      </div>
    </div>
    <div class="login-background">
      <div class="bg-decoration bg-decoration-1"></div>
      <div class="bg-decoration bg-decoration-2"></div>
      <div class="bg-decoration bg-decoration-3"></div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'LoginView',
  data() {
    return {
      loginForm: {
        username: '',
        password: ''
      },
      loginRules: {
        username: [
          { required: true, message: '请输入用户名', trigger: 'blur' }
        ],
        password: [
          { required: true, message: '请输入密码', trigger: 'blur' },
          { min: 6, message: '密码长度不能小于6个字符', trigger: 'blur' }
        ]
      },
      loading: false
    }
  },
  computed: {
    logoSrc() {
      try {
        return require('@/assets/logo.svg')
      } catch (e) {
        return this.$defaultLogo || ''
      }
    }
  },
  methods: {
    handleLogin() {
      this.$refs.loginForm.validate(valid => {
        if (valid) {
          this.loading = true
          this.$store.dispatch('user/login', this.loginForm)
            .then(() => {
              this.$message.success('登录成功')
              // 获取用户信息
              return this.$store.dispatch('user/getUserInfo')
            })
            .then(() => {
              // 重定向到仪表盘或指定页面
              const redirect = this.$route.query.redirect || '/dashboard/index'
              this.$router.push(redirect)
            })
            .catch(error => {
              console.error('登录失败:', error)
              this.$message.error('登录失败: ' + (error.response?.data?.detail || '用户名或密码错误'))
            })
            .finally(() => {
              this.loading = false
            })
        } else {
          return false
        }
      })
    },
    goToRegister() {
      this.$router.push('/register')
    }
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.login-container {
  display: flex;
  height: 100vh;
  width: 100vw;
  position: relative;
  overflow: hidden;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.login-content {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  position: relative;
  z-index: 2;
}

.login-card {
  width: 400px;
  padding: 40px;
  background-color: rgba(255, 255, 255, 0.95);
  border-radius: $border-radius-large;
  box-shadow: $box-shadow-base;
  backdrop-filter: blur(10px);
  animation: fadeIn 0.6s ease-out;
}

.logo-container {
  text-align: center;
  margin-bottom: 30px;
}

.logo {
  width: 80px;
  height: 80px;
  transition: transform 0.3s;
  
  &:hover {
    transform: scale(1.05);
  }
}

.title {
  color: $main-font-color;
  margin-top: 16px;
  font-weight: 600;
  font-size: 24px;
}

.login-form {
  margin-top: 30px;
}

.custom-input {
  :deep(.el-input__inner) {
    height: 50px;
    border-radius: $border-radius-base;
    border: 1px solid $border-light-color;
    transition: all 0.3s;
    
    &:hover, &:focus {
      border-color: $primary-color;
      box-shadow: 0 0 0 2px rgba($primary-color, 0.2);
    }
  }
}

.login-button {
  width: 100%;
  margin-top: 24px;
  height: 50px;
  border-radius: $border-radius-base;
  font-size: 16px;
  font-weight: 500;
  background: linear-gradient(90deg, $primary-color, $info-color);
  border: none;
  transition: transform 0.3s, box-shadow 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba($primary-color, 0.4);
  }
  
  &:active {
    transform: translateY(0);
  }
}

.login-options {
  margin-top: 24px;
  display: flex;
  justify-content: flex-end;
}

.register-link {
  color: $primary-color;
  cursor: pointer;
  transition: color 0.3s;
  font-weight: 500;

  &:hover {
    color: darken($primary-color, 10%);
    text-decoration: underline;
  }
}

.login-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
}

.bg-decoration {
  position: absolute;
  border-radius: 50%;
  background: linear-gradient(135deg, rgba($primary-color, 0.6), rgba($info-color, 0.6));
  opacity: 0.1;
  filter: blur(60px);
}

.bg-decoration-1 {
  width: 600px;
  height: 600px;
  top: -100px;
  right: -100px;
  animation: float 10s ease-in-out infinite;
}

.bg-decoration-2 {
  width: 400px;
  height: 400px;
  bottom: -50px;
  left: -50px;
  animation: float 14s ease-in-out infinite reverse;
}

.bg-decoration-3 {
  width: 300px;
  height: 300px;
  top: 40%;
  left: 40%;
  animation: pulse 8s ease-in-out infinite;
}

@keyframes float {
  0% {
    transform: translate(0, 0);
  }
  50% {
    transform: translate(30px, 20px);
  }
  100% {
    transform: translate(0, 0);
  }
}

@keyframes pulse {
  0% {
    transform: scale(1);
    opacity: 0.1;
  }
  50% {
    transform: scale(1.1);
    opacity: 0.2;
  }
  100% {
    transform: scale(1);
    opacity: 0.1;
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: $sm) {
  .login-card {
    width: 90%;
    max-width: 360px;
    padding: 30px;
  }
  
  .logo {
    width: 60px;
    height: 60px;
  }
  
  .title {
    font-size: 20px;
  }
}
</style> 

================================================================================
文件路径: src\views\NotFound.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\NotFound.vue
================================================================================

<template>
  <div class="not-found-container">
    <div class="background-decoration"></div>
    <div class="not-found-content">
      <div class="not-found-icon">404</div>
      <h2>页面不存在</h2>
      <p>抱歉，您访问的页面不存在或已被移除</p>
      <el-button type="primary" class="home-button" @click="goHome">
        <i class="el-icon-s-home"></i> 返回首页
      </el-button>
    </div>
  </div>
</template>

<script>
export default {
  name: 'NotFound',
  methods: {
    goHome() {
      this.$router.push('/')
    }
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.not-found-container {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  position: relative;
  overflow: hidden;
}

.background-decoration {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: 
    radial-gradient(circle at 10% 20%, rgba($primary-color, 0.03) 0%, transparent 20%),
    radial-gradient(circle at 90% 80%, rgba($primary-color, 0.03) 0%, transparent 20%),
    radial-gradient(circle at 50% 50%, rgba($primary-color, 0.06) 0%, transparent 30%),
    radial-gradient(circle at 80% 10%, rgba($info-color, 0.04) 0%, transparent 20%);
  z-index: 0;
}

.not-found-content {
  text-align: center;
  padding: 60px;
  background-color: rgba(255, 255, 255, 0.95);
  border-radius: $border-radius-large;
  box-shadow: $box-shadow-base;
  max-width: 500px;
  position: relative;
  z-index: 1;
  animation: fadeInUp 0.6s ease-out;
  backdrop-filter: blur(10px);
}

.not-found-icon {
  font-size: 120px;
  font-weight: 800;
  background: linear-gradient(135deg, $primary-color, $info-color);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  margin-bottom: 20px;
  line-height: 1;
  animation: pulse 3s infinite;
  text-shadow: 0 10px 30px rgba($primary-color, 0.2);
}

h2 {
  margin: 20px 0;
  color: $main-font-color;
  font-size: 28px;
  font-weight: 600;
}

p {
  margin-bottom: 30px;
  color: $regular-font-color;
  font-size: 16px;
  line-height: 1.6;
}

.home-button {
  height: 48px;
  padding: 0 30px;
  font-size: 16px;
  font-weight: 500;
  border-radius: $border-radius-base;
  background: linear-gradient(90deg, $primary-color, $info-color);
  border: none;
  transition: transform 0.3s, box-shadow 0.3s;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba($primary-color, 0.4);
  }
  
  i {
    margin-right: 8px;
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {
  0% {
    text-shadow: 0 5px 20px rgba($primary-color, 0.2);
  }
  50% {
    text-shadow: 0 5px 30px rgba($primary-color, 0.5);
  }
  100% {
    text-shadow: 0 5px 20px rgba($primary-color, 0.2);
  }
}

@media (max-width: $sm) {
  .not-found-content {
    padding: 40px 20px;
    max-width: 90%;
  }
  
  .not-found-icon {
    font-size: 100px;
  }
  
  h2 {
    font-size: 24px;
  }
}
</style> 

================================================================================
文件路径: src\views\Register.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\Register.vue
================================================================================

<template>
  <div class="register-container">
    <div class="register-content">
      <div class="register-card">
        <div class="logo-container">
          <el-image :src="logoSrc" alt="Logo" class="logo"></el-image>
          <h2 class="title">用户注册</h2>
        </div>
        
        <el-form ref="registerForm" :model="registerForm" :rules="registerRules" class="register-form">
          <el-form-item prop="username">
            <el-input 
              v-model="registerForm.username" 
              prefix-icon="el-icon-user" 
              placeholder="用户名 (4-20个字符)"
              class="custom-input"
            />
          </el-form-item>
          
          <el-form-item prop="email">
            <el-input 
              v-model="registerForm.email" 
              prefix-icon="el-icon-message" 
              placeholder="邮箱"
              class="custom-input"
            />
          </el-form-item>
          
          <el-form-item prop="first_name">
            <el-input 
              v-model="registerForm.first_name" 
              prefix-icon="el-icon-user" 
              placeholder="名字"
              class="custom-input"
            />
          </el-form-item>
          
          <el-form-item prop="last_name">
            <el-input 
              v-model="registerForm.last_name" 
              prefix-icon="el-icon-user" 
              placeholder="姓氏"
              class="custom-input"
            />
          </el-form-item>
          
          <el-form-item prop="password">
            <el-input 
              v-model="registerForm.password" 
              prefix-icon="el-icon-lock" 
              type="password" 
              placeholder="密码 (至少8位)"
              class="custom-input"
            />
          </el-form-item>
          
          <el-form-item prop="password2">
            <el-input 
              v-model="registerForm.password2" 
              prefix-icon="el-icon-lock" 
              type="password" 
              placeholder="确认密码"
              class="custom-input"
            />
          </el-form-item>
          
          <el-button 
            :loading="loading" 
            type="primary" 
            class="register-button" 
            @click="handleRegister"
          >
            注 册
          </el-button>
          
          <div class="register-options">
            <span>已有账号？</span>
            <span class="login-link" @click="goToLogin">立即登录</span>
          </div>
        </el-form>
      </div>
    </div>
    <div class="register-background">
      <div class="bg-decoration bg-decoration-1"></div>
      <div class="bg-decoration bg-decoration-2"></div>
      <div class="bg-decoration bg-decoration-3"></div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'RegisterView',
  data() {
    const validatePass = (rule, value, callback) => {
      if (value === '') {
        callback(new Error('请输入密码'))
      } else if (value.length < 8) {
        callback(new Error('密码长度不能小于8个字符'))
      } else {
        if (this.registerForm.password2 !== '') {
          this.$refs.registerForm.validateField('password2')
        }
        callback()
      }
    }
    const validateConfirmPass = (rule, value, callback) => {
      if (value === '') {
        callback(new Error('请再次输入密码'))
      } else if (value !== this.registerForm.password) {
        callback(new Error('两次输入密码不一致!'))
      } else {
        callback()
      }
    }
    return {
      registerForm: {
        username: '',
        email: '',
        first_name: '',
        last_name: '',
        password: '',
        password2: ''
      },
      registerRules: {
        username: [
          { required: true, message: '请输入用户名', trigger: 'blur' },
          { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' }
        ],
        email: [
          { required: true, message: '请输入邮箱地址', trigger: 'blur' },
          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }
        ],
        first_name: [
          { required: true, message: '请输入名字', trigger: 'blur' }
        ],
        last_name: [
          { required: true, message: '请输入姓氏', trigger: 'blur' }
        ],
        password: [
          { required: true, validator: validatePass, trigger: 'blur' }
        ],
        password2: [
          { required: true, validator: validateConfirmPass, trigger: 'blur' }
        ]
      },
      loading: false
    }
  },
  computed: {
    logoSrc() {
      try {
        return require('@/assets/logo.svg')
      } catch (e) {
        return this.$defaultLogo || ''
      }
    }
  },
  methods: {
    handleRegister() {
      this.$refs.registerForm.validate(valid => {
        if (valid) {
          this.loading = true
          this.$store.dispatch('user/register', this.registerForm)
            .then(() => {
              this.$message.success('注册成功，请登录')
              this.$nextTick(() => {
                this.$router.push('/login')
              })
            })
            .catch(error => {
              console.error('注册失败:', error)
              if (error.response && error.response.data) {
                const errorData = error.response.data;
                if (errorData.password && Array.isArray(errorData.password)) {
                  this.$message.error('密码错误: ' + errorData.password.join(', '));
                } else if (errorData.detail) {
                  this.$message.error(errorData.detail);
                } else if (errorData.username) {
                  this.$message.error('用户名错误: ' + errorData.username.join(', '));
                } else if (errorData.email) {
                  this.$message.error('邮箱错误: ' + errorData.email.join(', '));
                } else {
                  this.$message.error('注册失败，请检查输入信息');
                }
              } else {
                this.$message.error('注册失败，请稍后重试');
              }
            })
            .finally(() => {
              this.loading = false
            })
        } else {
          return false
        }
      })
    },
    goToLogin() {
      this.$router.push('/login')
    }
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.register-container {
  display: flex;
  height: 100vh;
  width: 100vw;
  position: relative;
  overflow: hidden;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.register-content {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  position: relative;
  z-index: 2;
}

.register-card {
  width: 450px;
  padding: 40px;
  background-color: rgba(255, 255, 255, 0.95);
  border-radius: $border-radius-large;
  box-shadow: $box-shadow-base;
  backdrop-filter: blur(10px);
  animation: fadeIn 0.6s ease-out;
}

.logo-container {
  text-align: center;
  margin-bottom: 30px;
}

.logo {
  width: 80px;
  height: 80px;
  transition: transform 0.3s;
  
  &:hover {
    transform: scale(1.05);
  }
}

.title {
  color: $main-font-color;
  margin-top: 16px;
  font-weight: 600;
  font-size: 24px;
}

.register-form {
  margin-top: 20px;
}

.custom-input {
  :deep(.el-input__inner) {
    height: 50px;
    border-radius: $border-radius-base;
    border: 1px solid $border-light-color;
    transition: all 0.3s;
    
    &:hover, &:focus {
      border-color: $primary-color;
      box-shadow: 0 0 0 2px rgba($primary-color, 0.2);
    }
  }
}

.register-button {
  width: 100%;
  margin-top: 24px;
  height: 50px;
  border-radius: $border-radius-base;
  font-size: 16px;
  font-weight: 500;
  background: linear-gradient(90deg, $primary-color, $info-color);
  border: none;
  transition: transform 0.3s, box-shadow 0.3s;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba($primary-color, 0.4);
  }
  
  &:active {
    transform: translateY(0);
  }
}

.register-options {
  margin-top: 24px;
  display: flex;
  justify-content: center;
  gap: 5px;
}

.login-link {
  color: $primary-color;
  cursor: pointer;
  transition: color 0.3s;
  font-weight: 500;

  &:hover {
    color: darken($primary-color, 10%);
    text-decoration: underline;
  }
}

.register-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
}

.bg-decoration {
  position: absolute;
  border-radius: 50%;
  background: linear-gradient(135deg, rgba($primary-color, 0.6), rgba($info-color, 0.6));
  opacity: 0.1;
  filter: blur(60px);
}

.bg-decoration-1 {
  width: 600px;
  height: 600px;
  top: -100px;
  right: -100px;
  animation: float 10s ease-in-out infinite;
}

.bg-decoration-2 {
  width: 400px;
  height: 400px;
  bottom: -50px;
  left: -50px;
  animation: float 14s ease-in-out infinite reverse;
}

.bg-decoration-3 {
  width: 300px;
  height: 300px;
  top: 40%;
  left: 40%;
  animation: pulse 8s ease-in-out infinite;
}

@keyframes float {
  0% {
    transform: translate(0, 0);
  }
  50% {
    transform: translate(30px, 20px);
  }
  100% {
    transform: translate(0, 0);
  }
}

@keyframes pulse {
  0% {
    transform: scale(1);
    opacity: 0.1;
  }
  50% {
    transform: scale(1.1);
    opacity: 0.2;
  }
  100% {
    transform: scale(1);
    opacity: 0.1;
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: $sm) {
  .register-card {
    width: 90%;
    max-width: 400px;
    padding: 30px;
  }
  
  .logo {
    width: 60px;
    height: 60px;
  }
  
  .title {
    font-size: 20px;
  }
}
</style> 

================================================================================
文件路径: src\views\admin\AdminLayout.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\AdminLayout.vue
================================================================================

<template>
  <div class="admin-layout">
    <el-container>
      <el-aside width="220px">
        <div class="admin-logo">
          <h2>后台管理系统</h2>
        </div>
        <el-menu
          :default-active="$route.path"
          class="admin-menu"
          background-color="#304156"
          text-color="#bfcbd9"
          active-text-color="#409EFF"
          router
        >
          <el-menu-item index="/admin/dashboard">
            <i class="el-icon-s-data"></i>
            <span>控制面板</span>
          </el-menu-item>
          
          <el-submenu index="users">
            <template slot="title">
              <i class="el-icon-user"></i>
              <span>用户管理</span>
            </template>
            <el-menu-item index="/admin/users">
              <i class="el-icon-user-solid"></i>
              <span>用户列表</span>
            </el-menu-item>
          </el-submenu>
          
          <el-submenu index="detections">
            <template slot="title">
              <i class="el-icon-search"></i>
              <span>检测管理</span>
            </template>
            <el-menu-item index="/admin/detection/list">
              <i class="el-icon-document"></i>
              <span>检测列表</span>
            </el-menu-item>
            <el-menu-item index="/admin/detection-stats">
              <i class="el-icon-data-analysis"></i>
              <span>统计分析</span>
            </el-menu-item>
          </el-submenu>
          
          <el-submenu index="system">
            <template slot="title">
              <i class="el-icon-setting"></i>
              <span>系统设置</span>
            </template>
            <el-menu-item index="/admin/settings">
              <i class="el-icon-s-tools"></i>
              <span>参数设置</span>
            </el-menu-item>
            <el-menu-item index="/admin/logs">
              <i class="el-icon-notebook-2"></i>
              <span>系统日志</span>
            </el-menu-item>
          </el-submenu>
        </el-menu>
      </el-aside>
      
      <el-container>
        <el-header>
          <div class="admin-header">
            <div class="breadcrumb">
              <el-breadcrumb separator="/">
                <el-breadcrumb-item :to="{ path: '/admin/dashboard' }">首页</el-breadcrumb-item>
                <el-breadcrumb-item v-for="(item, index) in breadcrumbs" :key="index">
                  {{ item }}
                </el-breadcrumb-item>
              </el-breadcrumb>
            </div>
            
            <div class="user-info">
              <el-dropdown trigger="click" @command="handleCommand">
                <span class="el-dropdown-link">
                  <el-avatar :size="32" icon="el-icon-user-solid"></el-avatar>
                  <span class="username">{{ currentUser.username }}</span>
                  <i class="el-icon-arrow-down el-icon--right"></i>
                </span>
                <el-dropdown-menu slot="dropdown">
                  <el-dropdown-item command="profile">个人资料</el-dropdown-item>
                  <el-dropdown-item command="settings">偏好设置</el-dropdown-item>
                  <el-dropdown-item divided command="logout">退出登录</el-dropdown-item>
                </el-dropdown-menu>
              </el-dropdown>
            </div>
          </div>
        </el-header>
        
        <el-main>
          <router-view />
        </el-main>
        
        <el-footer>
          <div class="admin-footer">
            <p>© {{ new Date().getFullYear() }} 虚假新闻检测系统 - 后台管理</p>
          </div>
        </el-footer>
      </el-container>
    </el-container>
  </div>
</template>

<script>
import { mapGetters } from 'vuex'

export default {
  name: 'AdminLayout',
  data() {
    return {
      breadcrumbs: []
    }
  },
  computed: {
    ...mapGetters(['currentUser'])
  },
  watch: {
    $route: {
      handler: function(route) {
        this.updateBreadcrumbs(route)
      },
      immediate: true
    }
  },
  methods: {
    handleCommand(command) {
      if (command === 'logout') {
        this.$store.dispatch('user/logout')
          .then(() => {
            this.$router.push('/login')
            this.$message.success('已成功退出登录')
          })
      } else if (command === 'profile') {
        this.$router.push('/admin/profile')
      } else if (command === 'settings') {
        this.$router.push('/admin/settings')
      }
    },
    
    updateBreadcrumbs(route) {
      const paths = route.path.split('/').filter(Boolean)
      const breadcrumbs = []
      
      if (paths.length > 1 && paths[0] === 'admin') {
        for (let i = 1; i < paths.length; i++) {
          let path = paths[i].charAt(0).toUpperCase() + paths[i].slice(1)
          breadcrumbs.push(this.formatBreadcrumb(path))
        }
      }
      
      this.breadcrumbs = breadcrumbs
    },
    
    formatBreadcrumb(path) {
      const breadcrumbMap = {
        'Dashboard': '控制面板',
        'Users': '用户列表',
        'Create': '添加用户',
        'Detections': '检测列表',
        'Detection-stats': '统计分析',
        'Settings': '系统设置',
        'Logs': '系统日志',
        'Profile': '个人资料'
      }
      
      return breadcrumbMap[path] || path
    }
  }
}
</script>

<style lang="scss" scoped>
.admin-layout {
  min-height: 100vh;
  
  .el-container {
    min-height: 100vh;
  }
  
  .el-aside {
    background-color: #304156;
    color: white;
    height: 100vh;
    position: fixed;
    left: 0;
    top: 0;
    z-index: 10;
  }
  
  .el-container:nth-child(2) {
    margin-left: 220px;
  }
  
  .admin-logo {
    height: 60px;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #263445;
    
    h2 {
      color: white;
      margin: 0;
      font-size: 18px;
    }
  }
  
  .admin-menu {
    border-right: none;
  }
  
  .el-header {
    background-color: white;
    color: #333;
    box-shadow: 0 1px 4px rgba(0, 21, 41, 0.08);
    position: relative;
    z-index: 9;
    padding: 0;
    
    .admin-header {
      height: 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      
      .breadcrumb {
        flex: 1;
      }
      
      .user-info {
        display: flex;
        align-items: center;
        
        .el-dropdown-link {
          display: flex;
          align-items: center;
          cursor: pointer;
          
          .username {
            margin: 0 10px;
          }
        }
      }
    }
  }
  
  .el-main {
    background-color: #f0f2f5;
    padding: 20px;
  }
  
  .el-footer {
    text-align: center;
    color: #999;
    padding: 20px;
    background-color: white;
  }
}
</style> 

================================================================================
文件路径: src\views\admin\Dashboard.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\Dashboard.vue
================================================================================

<template>
  <div class="admin-dashboard">
    <div class="page-header">
      <h1 class="page-title">管理员仪表盘</h1>
      <div class="page-actions">
        <el-button type="primary" icon="el-icon-refresh" @click="refreshData">刷新数据</el-button>
      </div>
    </div>
    
    <!-- 错误消息提示 -->
    <el-alert
      v-if="errorMessage"
      :title="errorMessage"
      type="error"
      :closable="true"
      show-icon
      style="margin-bottom: 20px;"
    >
    </el-alert>
    
    <!-- 数据概览卡片 -->
    <el-row :gutter="20" class="data-overview" v-loading="loading" element-loading-text="加载数据中...">
      <el-col :xs="12" :sm="12" :md="6" :lg="6" :xl="6">
        <el-card shadow="hover" class="data-card">
          <div slot="header" class="clearfix">
            <span>总用户数</span>
          </div>
          <div class="card-body">
            <div class="card-content">
              <div class="card-value">{{ statistics.totalUsers }}</div>
            </div>
            <div class="card-icon">
              <i class="el-icon-user"></i>
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :xs="12" :sm="12" :md="6" :lg="6" :xl="6">
        <el-card shadow="hover" class="data-card">
          <div slot="header" class="clearfix">
            <span>总检测量</span>
          </div>
          <div class="card-body">
            <div class="card-content">
              <div class="card-value">{{ statistics.totalDetections }}</div>
            </div>
            <div class="card-icon">
              <i class="el-icon-search"></i>
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :xs="12" :sm="12" :md="6" :lg="6" :xl="6">
        <el-card shadow="hover" class="data-card">
          <div slot="header" class="clearfix">
            <span>虚假新闻比例</span>
          </div>
          <div class="card-body">
            <div class="card-content">
              <div class="card-value">{{ statistics.fakeNewsRatio }}%</div>
            </div>
            <div class="card-icon">
              <i class="el-icon-warning"></i>
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :xs="12" :sm="12" :md="6" :lg="6" :xl="6">
        <el-card shadow="hover" class="data-card">
          <div slot="header" class="clearfix">
            <span>今日检测量</span>
          </div>
          <div class="card-body">
            <div class="card-content">
              <div class="card-value">{{ statistics.todayDetections }}</div>
            </div>
            <div class="card-icon">
              <i class="el-icon-date"></i>
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>
    
    <!-- 图表 -->
    <el-row :gutter="20" class="charts-row" v-loading="loading" element-loading-text="加载图表中...">
      <el-col :xs="24" :sm="24" :md="12" :lg="12" :xl="12">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测统计</span>
          </div>
          <div class="chart-container" ref="weeklyTrendChart"></div>
        </el-card>
      </el-col>
      
      <el-col :xs="24" :sm="24" :md="12" :lg="12" :xl="12">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测结果分布</span>
          </div>
          <div class="chart-container" ref="resultDistributionChart"></div>
        </el-card>
      </el-col>
    </el-row>
    
    <!-- 最近检测列表 -->
    <el-card shadow="hover" class="recent-detections">
      <div slot="header" class="clearfix">
        <span>最近检测记录</span>
        <el-button style="float: right;" type="text" @click="viewAllDetections">查看全部</el-button>
      </div>
      
      <el-table
        :data="recentDetections"
        style="width: 100%"
        v-loading="loading"
      >
        <el-table-column
          prop="id"
          label="ID"
          width="80">
        </el-table-column>
        <el-table-column
          prop="user"
          label="用户"
          width="120">
        </el-table-column>
        <el-table-column
          prop="title"
          label="标题"
          show-overflow-tooltip>
        </el-table-column>
        <el-table-column
          prop="result"
          label="结果"
          width="100">
          <template slot-scope="scope">
            <el-tag :type="scope.row.result === '真实' ? 'success' : 'danger'">
              {{ scope.row.result }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column
          prop="confidence"
          label="置信度"
          width="100">
          <template slot-scope="scope">
            {{ scope.row.confidence }}%
          </template>
        </el-table-column>
        <el-table-column
          prop="created_at"
          label="检测时间"
          width="180">
        </el-table-column>
        <el-table-column
          fixed="right"
          label="操作"
          width="100">
          <template slot-scope="scope">
            <el-button type="text" size="small" @click="viewDetail(scope.row)">详情</el-button>
          </template>
        </el-table-column>
      </el-table>
    </el-card>
  </div>
</template>

<script>
import * as echarts from 'echarts';
import axios from 'axios';

export default {
  name: 'AdminDashboard',
  data() {
    return {
      loading: false,
      statistics: {
        totalUsers: 0,
        totalDetections: 0,
        fakeNewsRatio: 0,
        todayDetections: 0
      },
      recentDetections: [],
      charts: {
        weeklyTrend: null,
        resultDistribution: null
      },
      errorMessage: ''
    }
  },
  created() {
    this.fetchData();
  },
  mounted() {
    this.initCharts();
  },
  methods: {
    // 获取数据
    fetchData() {
      this.loading = true;
      this.errorMessage = '';
      
      // 获取统计信息
      axios.get('/detection/detections/get_stats/?all=true')
        .then(response => {
          const data = response.data;
          
          this.statistics = {
            totalUsers: data.total_count || 0,
            totalDetections: data.total_count || 0,
            fakeNewsRatio: data.fake_percentage ? Math.round(data.fake_percentage) : 0,
            todayDetections: data.today_detections || 0
          };
          
          // 更新周趋势图表
          if (data.weekly_trend && data.weekly_trend.length > 0) {
            this.updateWeeklyTrendChart(data.weekly_trend);
          } else {
            // 如果后端未提供周趋势数据，则使用空数组
            this.updateWeeklyTrendChart([]);
          }
          
          // 更新结果分布图表
          if (data.result_distribution && data.result_distribution.length > 0) {
            this.updateResultDistributionChart(data.result_distribution);
          } else {
            const resultDistribution = [
              { name: '真实新闻', value: data.real_count || 0 },
              { name: '虚假新闻', value: data.fake_count || 0 }
            ];
            this.updateResultDistributionChart(resultDistribution);
          }
        })
        .catch(error => {
          console.error('获取统计数据失败:', error);
          this.errorMessage = '获取统计数据失败，请重试';
          this.$message.error('获取统计数据失败');
        })
        .finally(() => {
          this.loading = false;
        });
      
      // 获取最近的检测记录
      axios.get('/detection/detections/?limit=10')
        .then(response => {
          this.recentDetections = response.data.results.map(item => ({
            id: item.id,
            user: typeof item.user === 'string' ? item.user : (item.user?.username || '未知'),
            title: item.title,
            result: item.result === 'fake' ? '虚假' : (item.result === 'real' ? '真实' : '未知'),
            confidence: item.confidence_score ? Math.round(item.confidence_score * 100) : 0,
            created_at: new Date(item.created_at).toLocaleString()
          }));
        })
        .catch(error => {
          console.error('获取检测记录失败:', error);
          this.$message.error('获取检测记录失败');
        });
    },
    
    // 刷新数据
    refreshData() {
      this.fetchData();
    },
    
    // 初始化图表
    initCharts() {
      // 初始化周趋势图表
      this.charts.weeklyTrend = echarts.init(this.$refs.weeklyTrendChart);
      
      // 初始化结果分布图表
      this.charts.resultDistribution = echarts.init(this.$refs.resultDistributionChart);
      
      // 设置默认配置
      this.updateWeeklyTrendChart([]);
      this.updateResultDistributionChart([]);
      
      // 监听窗口大小变化，调整图表大小
      window.addEventListener('resize', this.resizeCharts);
    },
    
    // 更新周趋势图表
    updateWeeklyTrendChart(data) {
      if (!data || data.length === 0) {
        data = [
          { date: '今天', count: 0 },
          { date: '昨天', count: 0 },
          { date: '前天', count: 0 },
          { date: new Date(Date.now() - 3*24*60*60*1000).toLocaleDateString(), count: 0 },
          { date: new Date(Date.now() - 4*24*60*60*1000).toLocaleDateString(), count: 0 },
          { date: new Date(Date.now() - 5*24*60*60*1000).toLocaleDateString(), count: 0 },
          { date: new Date(Date.now() - 6*24*60*60*1000).toLocaleDateString(), count: 0 }
        ];
      }
      
      // 提取日期和数量
      const dates = data.map(item => item.date);
      const counts = data.map(item => item.count);
      
      // 设置图表配置
      const option = {
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'shadow'
          }
        },
        grid: {
          left: '3%',
          right: '4%',
          bottom: '3%',
          containLabel: true
        },
        xAxis: {
          type: 'category',
          data: dates
        },
        yAxis: {
          type: 'value'
        },
        series: [{
          name: '检测数量',
          data: counts,
          type: 'bar', // 修改为柱状图
          itemStyle: {
            color: '#409EFF'
          }
        }]
      };
      
      this.charts.weeklyTrend.setOption(option);
    },
    
    // 更新结果分布图表
    updateResultDistributionChart(data) {
      // 如果没有数据，设置默认值
      if (!data || data.length === 0) {
        data = [
          { name: '真实新闻', value: 0 },
          { name: '虚假新闻', value: 0 }
        ];
      }
      
      // 设置图表配置
      const option = {
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b}: {c} ({d}%)'
        },
        legend: {
          orient: 'vertical',
          left: 10,
          data: data.map(item => item.name)
        },
        series: [
          {
            name: '检测结果',
            type: 'pie',
            radius: ['50%', '70%'],
            avoidLabelOverlap: false,
            label: {
              show: false,
              position: 'center'
            },
            emphasis: {
              label: {
                show: true,
                fontSize: '16',
                fontWeight: 'bold'
              }
            },
            labelLine: {
              show: false
            },
            data: [
              { value: data[0].value, name: '真实新闻', itemStyle: { color: '#67C23A' } },
              { value: data[1].value, name: '虚假新闻', itemStyle: { color: '#F56C6C' } }
            ]
          }
        ]
      };
      
      this.charts.resultDistribution.setOption(option);
    },
    
    // 调整图表大小
    resizeCharts() {
      this.charts.weeklyTrend.resize();
      this.charts.resultDistribution.resize();
    },
    
    // 查看所有检测
    viewAllDetections() {
      this.$router.push('/admin/detection/list');
    },
    
    // 查看检测详情
    viewDetail(row) {
      this.$router.push(`/admin/detection/detail/${row.id}`);
    }
  },
  beforeDestroy() {
    // 移除窗口大小变化监听器
    window.removeEventListener('resize', this.resizeCharts);
    
    // 销毁图表实例
    if (this.charts.weeklyTrend) {
      this.charts.weeklyTrend.dispose();
    }
    if (this.charts.resultDistribution) {
      this.charts.resultDistribution.dispose();
    }
  }
}
</script>

<style scoped>
.admin-dashboard {
  padding: 20px;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  margin: 0;
}

.data-overview {
  margin-bottom: 30px;
}

.data-card {
  position: relative;
  height: 170px;
  overflow: hidden;
  margin-bottom: 15px;
  transition: all 0.3s;
}

.data-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.card-body {
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 70px;
  padding: 0 15px;
}

.card-content {
  flex: 1;
  max-width: 70%;
  padding: 5px 0;
}

.card-value {
  font-size: 30px;
  font-weight: bold;
  margin-top: 5px;
  color: #303133;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.card-icon {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  margin-left: 10px;
  background-color: rgba(64, 158, 255, 0.1);
}

.card-icon i {
  font-size: 24px;
  color: #409EFF;
}

.el-col:nth-child(1) .card-icon {
  background-color: rgba(103, 194, 58, 0.1);
}

.el-col:nth-child(1) .card-icon i {
  color: #67C23A;
}

.el-col:nth-child(2) .card-icon {
  background-color: rgba(64, 158, 255, 0.1);
}

.el-col:nth-child(2) .card-icon i {
  color: #409EFF;
}

.el-col:nth-child(3) .card-icon {
  background-color: rgba(245, 108, 108, 0.1);
}

.el-col:nth-child(3) .card-icon i {
  color: #F56C6C;
}

.el-col:nth-child(4) .card-icon {
  background-color: rgba(230, 162, 60, 0.1);
}

.el-col:nth-child(4) .card-icon i {
  color: #E6A23C;
}

.charts-row {
  margin-bottom: 30px;
}

.chart-card {
  margin-bottom: 20px;
  transition: all 0.3s;
}

.chart-card:hover {
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.chart-container {
  height: 300px;
}

.recent-detections {
  margin-bottom: 20px;
  transition: all 0.3s;
}

.recent-detections:hover {
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.pagination-container {
  text-align: right;
  margin-top: 20px;
}

/* 适配移动端 */
@media (max-width: 768px) {
  .card-value {
    font-size: 24px;
  }
  
  .card-icon i {
    font-size: 24px;
  }
  
  .chart-container {
    height: 250px;
  }

  .data-card {
    height: 120px;
  }
  
  .card-body {
    height: 60px;
  }
}
</style> 

================================================================================
文件路径: src\views\admin\DataAnalysis.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\DataAnalysis.vue
================================================================================

<template>
  <div class="data-analysis">
    <div class="page-header">
      <h1 class="page-title">数据分析</h1>
      <div class="time-filter">
        <el-radio-group v-model="timeRange" size="small" @change="handleTimeRangeChange">
          <el-radio-button label="today">今日</el-radio-button>
          <el-radio-button label="week">本周</el-radio-button>
          <el-radio-button label="month">本月</el-radio-button>
          <el-radio-button label="year">本年</el-radio-button>
        </el-radio-group>
        <el-date-picker
          v-model="customDateRange"
          type="daterange"
          size="small"
          range-separator="至"
          start-placeholder="开始日期"
          end-placeholder="结束日期"
          format="yyyy-MM-dd"
          value-format="yyyy-MM-dd"
          @change="handleCustomDateChange">
        </el-date-picker>
      </div>
    </div>
    
    <!-- 数据概览卡片 -->
    <el-row :gutter="20" class="data-overview">
      <el-col :span="6">
        <el-card shadow="hover" class="overview-card">
          <div class="overview-icon" style="background-color: #409EFF">
            <i class="el-icon-s-data"></i>
          </div>
          <div class="overview-content">
            <div class="overview-title">总检测次数</div>
            <div class="overview-value">{{ statistics.totalDetections }}</div>
            <div class="overview-change" :class="{'up': statistics.detectionChange > 0, 'down': statistics.detectionChange < 0}">
              <i :class="statistics.detectionChange >= 0 ? 'el-icon-top' : 'el-icon-bottom'"></i>
              {{ Math.abs(statistics.detectionChange) }}%
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :span="6">
        <el-card shadow="hover" class="overview-card">
          <div class="overview-icon" style="background-color: #67C23A">
            <i class="el-icon-user"></i>
          </div>
          <div class="overview-content">
            <div class="overview-title">活跃用户数</div>
            <div class="overview-value">{{ statistics.activeUsers }}</div>
            <div class="overview-change" :class="{'up': statistics.userChange > 0, 'down': statistics.userChange < 0}">
              <i :class="statistics.userChange >= 0 ? 'el-icon-top' : 'el-icon-bottom'"></i>
              {{ Math.abs(statistics.userChange) }}%
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :span="6">
        <el-card shadow="hover" class="overview-card">
          <div class="overview-icon" style="background-color: #E6A23C">
            <i class="el-icon-warning"></i>
          </div>
          <div class="overview-content">
            <div class="overview-title">假新闻检出率</div>
            <div class="overview-value">{{ statistics.fakeNewsRate }}%</div>
            <div class="overview-change" :class="{'up': statistics.fakeNewsChange > 0, 'down': statistics.fakeNewsChange < 0}">
              <i :class="statistics.fakeNewsChange >= 0 ? 'el-icon-top' : 'el-icon-bottom'"></i>
              {{ Math.abs(statistics.fakeNewsChange) }}%
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :span="6">
        <el-card shadow="hover" class="overview-card">
          <div class="overview-icon" style="background-color: #F56C6C">
            <i class="el-icon-pie-chart"></i>
          </div>
          <div class="overview-content">
            <div class="overview-title">平均置信度</div>
            <div class="overview-value">{{ statistics.avgConfidence }}%</div>
            <div class="overview-change" :class="{'up': statistics.confidenceChange > 0, 'down': statistics.confidenceChange < 0}">
              <i :class="statistics.confidenceChange >= 0 ? 'el-icon-top' : 'el-icon-bottom'"></i>
              {{ Math.abs(statistics.confidenceChange) }}%
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>
    
    <!-- 图表区域 -->
    <el-row :gutter="20" class="chart-container">
      <el-col :span="16">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测趋势</span>
            <el-radio-group v-model="trendChartType" size="mini" style="float: right">
              <el-radio-button label="day">日</el-radio-button>
              <el-radio-button label="week">周</el-radio-button>
              <el-radio-button label="month">月</el-radio-button>
            </el-radio-group>
          </div>
          <div class="chart" ref="trendChart"></div>
        </el-card>
      </el-col>
      
      <el-col :span="8">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测结果分布</span>
          </div>
          <div class="chart" ref="pieChart"></div>
        </el-card>
      </el-col>
    </el-row>
    
    <el-row :gutter="20" class="chart-container">
      <el-col :span="12">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>用户活跃度排行</span>
          </div>
          <div class="chart" ref="userRankChart"></div>
        </el-card>
      </el-col>
      
      <el-col :span="12">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测内容分类统计</span>
          </div>
          <div class="chart" ref="categoryChart"></div>
        </el-card>
      </el-col>
    </el-row>
    
    <!-- 热门检测内容列表 -->
    <el-card shadow="hover" class="list-card">
      <div slot="header" class="clearfix">
        <span>热门检测内容</span>
        <el-button style="float: right; padding: 3px 0" type="text" @click="viewAllDetections">查看全部</el-button>
      </div>
      
      <el-table :data="hotDetections" style="width: 100%">
        <el-table-column prop="content" label="检测内容" min-width="300">
          <template slot-scope="scope">
            <div class="content-ellipsis">{{ scope.row.content }}</div>
          </template>
        </el-table-column>
        <el-table-column prop="user" label="用户" width="120"></el-table-column>
        <el-table-column prop="time" label="检测时间" width="180"></el-table-column>
        <el-table-column prop="result" label="检测结果" width="100">
          <template slot-scope="scope">
            <el-tag :type="scope.row.result === '真实' ? 'success' : 'danger'">
              {{ scope.row.result }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="confidence" label="置信度" width="100">
          <template slot-scope="scope">
            <el-progress :percentage="scope.row.confidence" :color="getConfidenceColor(scope.row.confidence)"></el-progress>
          </template>
        </el-table-column>
        <el-table-column prop="count" label="检测次数" width="100" sortable></el-table-column>
      </el-table>
    </el-card>
  </div>
</template>

<script>
// 引入echarts
import * as echarts from 'echarts';

export default {
  name: 'DataAnalysis',
  data() {
    return {
      // 时间筛选
      timeRange: 'month',
      customDateRange: [],
      
      // 图表类型
      trendChartType: 'day',
      
      // 统计数据
      statistics: {
        totalDetections: 8526,
        detectionChange: 13.5,
        activeUsers: 742,
        userChange: 8.2,
        fakeNewsRate: 37.8,
        fakeNewsChange: -2.3,
        avgConfidence: 82.6,
        confidenceChange: 1.4
      },
      
      // 图表实例
      trendChart: null,
      pieChart: null,
      userRankChart: null,
      categoryChart: null,
      
      // 热门检测内容
      hotDetections: []
    };
  },
  mounted() {
    this.initCharts();
    this.generateMockData();
  },
  methods: {
    // 初始化所有图表
    initCharts() {
      this.$nextTick(() => {
        // 检测趋势图
        this.trendChart = echarts.init(this.$refs.trendChart);
        
        // 检测结果饼图
        this.pieChart = echarts.init(this.$refs.pieChart);
        
        // 用户活跃度排行图
        this.userRankChart = echarts.init(this.$refs.userRankChart);
        
        // 检测内容分类统计图
        this.categoryChart = echarts.init(this.$refs.categoryChart);
        
        // 设置响应式
        window.addEventListener('resize', this.resizeCharts);
        
        // 初始化图表数据
        this.updateCharts();
      });
    },
    
    // 更新所有图表
    updateCharts() {
      this.updateTrendChart();
      this.updatePieChart();
      this.updateUserRankChart();
      this.updateCategoryChart();
    },
    
    // 更新趋势图
    updateTrendChart() {
      // 生成日期数据
      const days = 30;
      const dateList = [];
      const realData = [];
      const fakeData = [];
      
      for (let i = 0; i < days; i++) {
        const date = new Date();
        date.setDate(date.getDate() - (days - i - 1));
        const dateStr = `${date.getMonth() + 1}/${date.getDate()}`;
        dateList.push(dateStr);
        
        // 生成随机数据
        const realCount = Math.floor(Math.random() * 100) + 50;
        const fakeCount = Math.floor(Math.random() * 80) + 20;
        
        realData.push(realCount);
        fakeData.push(fakeCount);
      }
      
      const option = {
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'shadow'
          }
        },
        legend: {
          data: ['真实新闻', '虚假新闻'],
          right: 10,
          top: 10
        },
        grid: {
          left: '3%',
          right: '4%',
          bottom: '3%',
          containLabel: true
        },
        xAxis: {
          type: 'category',
          data: dateList,
          axisTick: {
            alignWithLabel: true
          }
        },
        yAxis: {
          type: 'value'
        },
        series: [
          {
            name: '真实新闻',
            type: 'line',
            smooth: true,
            data: realData,
            itemStyle: {
              color: '#67C23A'
            },
            areaStyle: {
              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                { offset: 0, color: 'rgba(103, 194, 58, 0.5)' },
                { offset: 1, color: 'rgba(103, 194, 58, 0.1)' }
              ])
            }
          },
          {
            name: '虚假新闻',
            type: 'line',
            smooth: true,
            data: fakeData,
            itemStyle: {
              color: '#F56C6C'
            },
            areaStyle: {
              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                { offset: 0, color: 'rgba(245, 108, 108, 0.5)' },
                { offset: 1, color: 'rgba(245, 108, 108, 0.1)' }
              ])
            }
          }
        ]
      };
      
      this.trendChart.setOption(option);
    },
    
    // 更新饼图
    updatePieChart() {
      const option = {
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b} : {c} ({d}%)'
        },
        legend: {
          orient: 'vertical',
          left: 'left',
          data: ['真实新闻', '虚假新闻', '可疑内容', '无法判断']
        },
        series: [
          {
            name: '检测结果',
            type: 'pie',
            radius: '60%',
            center: ['60%', '50%'],
            data: [
              { value: 62, name: '真实新闻', itemStyle: { color: '#67C23A' } },
              { value: 25, name: '虚假新闻', itemStyle: { color: '#F56C6C' } },
              { value: 10, name: '可疑内容', itemStyle: { color: '#E6A23C' } },
              { value: 3, name: '无法判断', itemStyle: { color: '#909399' } }
            ],
            emphasis: {
              itemStyle: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: 'rgba(0, 0, 0, 0.5)'
              }
            },
            label: {
              formatter: '{b}: {d}%'
            }
          }
        ]
      };
      
      this.pieChart.setOption(option);
    },
    
    // 更新用户排行图
    updateUserRankChart() {
      const userNames = ['张三', '李四', '王五', '赵六', '钱七', '孙八', '周九', '吴十'];
      const userValues = [98, 89, 76, 72, 63, 58, 45, 32];
      
      const option = {
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'shadow'
          }
        },
        grid: {
          left: '3%',
          right: '4%',
          bottom: '3%',
          containLabel: true
        },
        xAxis: {
          type: 'value',
          boundaryGap: [0, 0.01]
        },
        yAxis: {
          type: 'category',
          data: userNames.reverse(),
          axisLabel: {
            interval: 0
          }
        },
        series: [
          {
            name: '检测次数',
            type: 'bar',
            data: userValues.reverse(),
            itemStyle: {
              color: function(params) {
                const colorList = ['#409EFF', '#53a8ff', '#66b1ff', '#79bbff', '#8cc5ff', '#a0cfff', '#b3d8ff', '#c6e2ff'];
                return colorList[params.dataIndex];
              }
            }
          }
        ]
      };
      
      this.userRankChart.setOption(option);
    },
    
    // 更新内容分类图
    updateCategoryChart() {
      const option = {
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b} : {c}'
        },
        radar: {
          radius: '60%',
          center: ['50%', '50%'],
          name: {
            textStyle: {
              color: '#333',
              backgroundColor: '#fff',
              borderRadius: 3,
              padding: [3, 5]
            }
          },
          indicator: [
            { name: '政治新闻', max: 100 },
            { name: '社会新闻', max: 100 },
            { name: '经济新闻', max: 100 },
            { name: '体育新闻', max: 100 },
            { name: '娱乐新闻', max: 100 },
            { name: '科技新闻', max: 100 }
          ]
        },
        series: [
          {
            name: '检测分类',
            type: 'radar',
            areaStyle: {
              color: new echarts.graphic.RadialGradient(0.5, 0.5, 1, [
                { offset: 0, color: 'rgba(64, 158, 255, 0.7)' },
                { offset: 1, color: 'rgba(64, 158, 255, 0.1)' }
              ])
            },
            data: [
              {
                value: [85, 76, 62, 48, 92, 70],
                name: '检测数量',
                itemStyle: {
                  color: '#409EFF'
                },
                lineStyle: {
                  color: '#409EFF'
                }
              }
            ]
          }
        ]
      };
      
      this.categoryChart.setOption(option);
    },
    
    // 响应式调整图表大小
    resizeCharts() {
      this.trendChart && this.trendChart.resize();
      this.pieChart && this.pieChart.resize();
      this.userRankChart && this.userRankChart.resize();
      this.categoryChart && this.categoryChart.resize();
    },
    
    // 生成模拟数据
    generateMockData() {
      // 生成热门检测内容
      const contentList = [
        '研究显示喝咖啡有助于延长寿命',
        '某国科学家发现可再生能源新突破',
        '国家将出台新政策支持人工智能发展',
        '新冠病毒变种可能在冬季再次爆发',
        '世界杯小组赛爆出冷门，前冠军被淘汰',
        '研究发现常见食品添加剂可能致癌',
        '科学家在火星发现疑似生命痕迹',
        '某公司CEO涉嫌财务造假被调查',
        '政府宣布将投入100亿建设智慧城市',
        '气象部门预测今年将有极端天气事件增多'
      ];
      
      const users = ['张三', '李四', '王五', '赵六', '钱七'];
      const results = ['真实', '虚假'];
      
      this.hotDetections = contentList.map((content, index) => {
        const now = new Date();
        const randomDays = Math.floor(Math.random() * 30);
        const randomHours = Math.floor(Math.random() * 24);
        const randomMinutes = Math.floor(Math.random() * 60);
        
        now.setDate(now.getDate() - randomDays);
        now.setHours(now.getHours() - randomHours);
        now.setMinutes(now.getMinutes() - randomMinutes);
        
        const timeStr = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
        
        const result = results[Math.floor(Math.random() * results.length)];
        const confidence = Math.floor(Math.random() * 30) + 70;
        
        return {
          id: index + 1,
          content,
          user: users[Math.floor(Math.random() * users.length)],
          time: timeStr,
          result,
          confidence,
          count: Math.floor(Math.random() * 50) + 10
        };
      });
      
      // 按检测次数排序
      this.hotDetections.sort((a, b) => b.count - a.count);
    },
    
    // 处理时间范围变化
    handleTimeRangeChange() {
      // 清空自定义日期范围
      this.customDateRange = [];
      this.updateCharts();
    },
    
    // 处理自定义日期变化
    handleCustomDateChange() {
      if (this.customDateRange && this.customDateRange.length === 2) {
        this.timeRange = 'custom';
        this.updateCharts();
      }
    },
    
    // 获取置信度颜色
    getConfidenceColor(confidence) {
      if (confidence < 60) return '#F56C6C';
      if (confidence < 75) return '#E6A23C';
      if (confidence < 90) return '#67C23A';
      return '#409EFF';
    },
    
    // 查看所有检测
    viewAllDetections() {
      this.$message.info('跳转到所有检测记录页面');
      // 实际开发中这里应该是路由跳转
      // this.$router.push('/admin/detection-records');
    }
  },
  beforeDestroy() {
    // 移除窗口大小改变事件
    window.removeEventListener('resize', this.resizeCharts);
    
    // 销毁图表实例
    this.trendChart && this.trendChart.dispose();
    this.pieChart && this.pieChart.dispose();
    this.userRankChart && this.userRankChart.dispose();
    this.categoryChart && this.categoryChart.dispose();
  }
};
</script>

<style lang="scss" scoped>
.data-analysis {
  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    
    .page-title {
      margin: 0;
      font-size: 24px;
      font-weight: bold;
    }
    
    .time-filter {
      display: flex;
      align-items: center;
      gap: 15px;
    }
  }
  
  .data-overview {
    margin-bottom: 20px;
    
    .overview-card {
      height: 120px;
      display: flex;
      align-items: center;
      padding: 20px;
      
      .overview-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 15px;
        
        i {
          font-size: 28px;
          color: #fff;
        }
      }
      
      .overview-content {
        flex: 1;
        
        .overview-title {
          font-size: 14px;
          color: #909399;
          margin-bottom: 8px;
        }
        
        .overview-value {
          font-size: 24px;
          font-weight: bold;
          color: #303133;
          margin-bottom: 8px;
        }
        
        .overview-change {
          font-size: 12px;
          
          &.up {
            color: #67C23A;
          }
          
          &.down {
            color: #F56C6C;
          }
          
          i {
            margin-right: 2px;
          }
        }
      }
    }
  }
  
  .chart-container {
    margin-bottom: 20px;
    
    .chart-card {
      .chart {
        height: 350px;
      }
    }
  }
  
  .list-card {
    margin-bottom: 20px;
    
    .content-ellipsis {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 300px;
    }
  }
}
</style> 

================================================================================
文件路径: src\views\admin\DetectionStatistics.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\DetectionStatistics.vue
================================================================================

<template>
  <div class="detection-statistics">
    <div class="page-header">
      <h1 class="page-title">检测统计</h1>
      <div class="page-actions">
        <el-date-picker
          v-model="dateRange"
          type="daterange"
          range-separator="至"
          start-placeholder="开始日期"
          end-placeholder="结束日期"
          @change="handleDateRangeChange"
          :picker-options="pickerOptions">
        </el-date-picker>
        <el-button type="primary" icon="el-icon-refresh" @click="loadStatistics">刷新数据</el-button>
      </div>
    </div>
    
    <!-- 统计卡片 -->
    <el-row :gutter="20" class="data-overview">
      <el-col :span="6">
        <el-card shadow="hover" class="data-card total-card">
          <div class="data-card-header">
            <div class="card-title">总检测量</div>
            <i class="el-icon-s-data icon"></i>
          </div>
          <div class="data-card-body">
            <div class="card-value">{{ statistics.total_count || 0 }}</div>
            <div class="card-trend">
              <span class="trend-text">完成率</span>
              <span class="trend-value">{{ calculateCompletionRate }}%</span>
            </div>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="data-card true-card">
          <div class="data-card-header">
            <div class="card-title">真新闻量</div>
            <i class="el-icon-circle-check icon"></i>
          </div>
          <div class="data-card-body">
            <div class="card-value">{{ statistics.real_count || 0 }}</div>
            <div class="card-trend">
              <span class="trend-text">占比</span>
              <span class="trend-value">{{ statistics.real_percentage ? statistics.real_percentage.toFixed(1) : '0.0' }}%</span>
            </div>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="data-card fake-card">
          <div class="data-card-header">
            <div class="card-title">假新闻量</div>
            <i class="el-icon-circle-close icon"></i>
          </div>
          <div class="data-card-body">
            <div class="card-value">{{ statistics.fake_count || 0 }}</div>
            <div class="card-trend">
              <span class="trend-text">占比</span>
              <span class="trend-value">{{ statistics.fake_percentage ? statistics.fake_percentage.toFixed(1) : '0.0' }}%</span>
            </div>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="data-card task-card">
          <div class="data-card-header">
            <div class="card-title">平均置信度</div>
            <i class="el-icon-view icon"></i>
          </div>
          <div class="data-card-body">
            <div class="card-value">{{ (statistics.average_confidence ? (statistics.average_confidence * 100).toFixed(1) : '0.0') }}%</div>
            <div class="card-trend">
              <span class="trend-text">基于</span>
              <span class="trend-value">{{ statistics.completed_count || 0 }}个完成任务</span>
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>
    
    <!-- 图表区域 -->
    <el-row :gutter="20" class="chart-row">
      <el-col :span="12">
        <el-card class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测结果分布</span>
          </div>
          <div class="chart-container" v-loading="loading">
            <div ref="pieChart" style="width:100%; height:300px"></div>
          </div>
        </el-card>
      </el-col>
      <el-col :span="12">
        <el-card class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测状态分布</span>
          </div>
          <div class="chart-container" v-loading="loading">
            <div ref="statusChart" style="width:100%; height:300px"></div>
          </div>
        </el-card>
      </el-col>
    </el-row>
    
    <!-- 最近检测列表 -->
    <el-card class="recent-detection-card">
      <div slot="header" class="clearfix">
        <span>最近检测记录</span>
        <el-button style="float: right; padding: 3px 0" type="text" @click="viewAllDetections">查看全部</el-button>
      </div>
      <div v-loading="loadingDetections">
        <el-table :data="recentDetections" style="width: 100%" :row-class-name="getRowClassName">
          <el-table-column prop="id" label="ID" width="80"></el-table-column>
          <el-table-column prop="content" label="检测内容">
            <template slot-scope="scope">
              <div class="content-cell">
                <el-tooltip :content="scope.row.content" placement="top" :disabled="scope.row.content.length < 50">
                  <span>{{ truncateText(scope.row.content, 50) }}</span>
                </el-tooltip>
              </div>
            </template>
          </el-table-column>
          <el-table-column prop="user" label="用户" width="120"></el-table-column>
          <el-table-column prop="status" label="状态" width="100">
            <template slot-scope="scope">
              <el-tag :type="getStatusType(scope.row.status)">
                {{ getStatusLabel(scope.row.status) }}
              </el-tag>
            </template>
          </el-table-column>
          <el-table-column prop="result" label="检测结果" width="100">
            <template slot-scope="scope">
              <el-tag v-if="scope.row.status === 'completed'" :type="scope.row.result === 'real' ? 'success' : 'danger'">
                {{ scope.row.result === 'real' ? '真实' : '虚假' }}
              </el-tag>
              <span v-else>-</span>
            </template>
          </el-table-column>
          <el-table-column prop="confidence_score" label="置信度" width="180">
            <template slot-scope="scope">
              <el-progress 
                v-if="scope.row.status === 'completed'"
                :percentage="parseFloat((scope.row.confidence_score * 100).toFixed(2))" 
                :color="getConfidenceColor(scope.row.confidence_score)">
              </el-progress>
              <span v-else>-</span>
            </template>
          </el-table-column>
          <el-table-column prop="created_at" label="检测时间" width="180">
            <template slot-scope="scope">
              {{ formatDateTime(scope.row.created_at) }}
            </template>
          </el-table-column>
        </el-table>
      </div>
    </el-card>
  </div>
</template>

<script>
import * as echarts from 'echarts/core';
import { GridComponent, TooltipComponent, TitleComponent, LegendComponent } from 'echarts/components';
import { PieChart } from 'echarts/charts';
import { CanvasRenderer } from 'echarts/renderers';
import axios from 'axios';

echarts.use([GridComponent, TooltipComponent, TitleComponent, LegendComponent, PieChart, CanvasRenderer]);

export default {
  name: 'DetectionStatistics',
  data() {
    return {
      loading: false,
      loadingDetections: false,
      dateRange: [new Date(new Date().getTime() - 30 * 24 * 60 * 60 * 1000), new Date()],
      pickerOptions: {
        shortcuts: [{
          text: '最近一周',
          onClick(picker) {
            const end = new Date();
            const start = new Date();
            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);
            picker.$emit('pick', [start, end]);
          }
        }, {
          text: '最近一个月',
          onClick(picker) {
            const end = new Date();
            const start = new Date();
            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);
            picker.$emit('pick', [start, end]);
          }
        }, {
          text: '最近三个月',
          onClick(picker) {
            const end = new Date();
            const start = new Date();
            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);
            picker.$emit('pick', [start, end]);
          }
        }]
      },
      // 统计数据
      statistics: {
        total_count: 0,
        fake_count: 0,
        real_count: 0,
        pending_count: 0,
        completed_count: 0,
        failed_count: 0,
        fake_percentage: 0,
        real_percentage: 0,
        average_confidence: 0
      },
      // 最近检测记录
      recentDetections: [],
      // 图表实例
      pieChart: null,
      statusChart: null
    }
  },
  computed: {
    calculateCompletionRate() {
      return this.statistics.total_count > 0
        ? ((this.statistics.completed_count / this.statistics.total_count) * 100).toFixed(1)
        : '0.0'
    }
  },
  created() {
    this.loadStatistics()
    this.loadRecentDetections()
  },
  mounted() {
    this.initCharts()
    // 监听窗口大小变化，调整图表大小
    window.addEventListener('resize', this.resizeCharts)
  },
  beforeDestroy() {
    // 移除事件监听
    window.removeEventListener('resize', this.resizeCharts)
    // 销毁图表实例
    if (this.pieChart) {
      this.pieChart.dispose()
    }
    if (this.statusChart) {
      this.statusChart.dispose()
    }
  },
  methods: {
    // 加载统计数据
    loadStatistics() {
      this.loading = true
      
      // 构建API参数
      const params = {}
      params.all = 'true' // 管理员查看所有数据
      
      if (this.dateRange && this.dateRange.length === 2) {
        params.start_date = this.formatDate(this.dateRange[0])
        params.end_date = this.formatDate(this.dateRange[1])
      }
      
      axios.get('/detection/detections/get_stats/', { params })
        .then(response => {
          this.statistics = response.data
          this.updateCharts()
          this.loading = false
        })
        .catch(error => {
          console.error('获取统计数据失败:', error)
          this.$message.error('获取统计数据失败，请重试')
          this.loading = false
        })
    },
    
    // 加载最近检测记录
    loadRecentDetections() {
      this.loadingDetections = true
      
      axios.get('/detection/detections/', {
        params: { page: 1, page_size: 10 } // 只获取最近10条
      })
        .then(response => {
          this.recentDetections = response.data.results || []
          this.loadingDetections = false
        })
        .catch(error => {
          console.error('获取检测记录失败:', error)
          this.$message.error('获取检测记录失败，请重试')
          this.loadingDetections = false
        })
    },
    
    // 初始化图表
    initCharts() {
      // 初始化饼图
      this.pieChart = echarts.init(this.$refs.pieChart)
      
      // 初始化状态图
      this.statusChart = echarts.init(this.$refs.statusChart)
      
      // 更新图表数据
      this.updateCharts()
    },
    
    // 更新图表数据
    updateCharts() {
      if (!this.pieChart || !this.statusChart) return
      
      // 更新检测结果饼图
      const pieOption = {
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b}: {c} ({d}%)'
        },
        legend: {
          orient: 'vertical',
          right: 10,
          top: 'center',
          data: ['真实新闻', '虚假新闻']
        },
        series: [
          {
            name: '检测结果',
            type: 'pie',
            radius: ['50%', '70%'],
            avoidLabelOverlap: false,
            label: {
              show: false,
              position: 'center'
            },
            emphasis: {
              label: {
                show: true,
                fontSize: '18',
                fontWeight: 'bold'
              }
            },
            labelLine: {
              show: false
            },
            data: [
              { value: this.statistics.real_count || 0, name: '真实新闻', itemStyle: { color: '#67C23A' } },
              { value: this.statistics.fake_count || 0, name: '虚假新闻', itemStyle: { color: '#F56C6C' } }
            ]
          }
        ]
      }
      
      // 更新检测状态饼图
      const statusOption = {
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b}: {c} ({d}%)'
        },
        legend: {
          orient: 'vertical',
          right: 10,
          top: 'center',
          data: ['已完成', '进行中', '失败']
        },
        series: [
          {
            name: '检测状态',
            type: 'pie',
            radius: ['50%', '70%'],
            avoidLabelOverlap: false,
            label: {
              show: false,
              position: 'center'
            },
            emphasis: {
              label: {
                show: true,
                fontSize: '18',
                fontWeight: 'bold'
              }
            },
            labelLine: {
              show: false
            },
            data: [
              { value: this.statistics.completed_count || 0, name: '已完成', itemStyle: { color: '#67C23A' } },
              { value: this.statistics.pending_count || 0, name: '进行中', itemStyle: { color: '#E6A23C' } },
              { value: this.statistics.failed_count || 0, name: '失败', itemStyle: { color: '#F56C6C' } }
            ]
          }
        ]
      }
      
      this.pieChart.setOption(pieOption)
      this.statusChart.setOption(statusOption)
    },
    
    // 调整图表大小
    resizeCharts() {
      if (this.pieChart) this.pieChart.resize()
      if (this.statusChart) this.statusChart.resize()
    },
    
    // 日期范围变化处理
    handleDateRangeChange() {
      this.loadStatistics()
    },
    
    // 查看所有检测
    viewAllDetections() {
      this.$router.push('/admin/detection/list')
    },
    
    // 获取行类名
    getRowClassName({ row }) {
      return row.status === 'failed' ? 'error-row' : ''
    },
    
    // 获取状态标签类型
    getStatusType(status) {
      switch (status) {
        case 'completed': return 'success'
        case 'pending': return 'warning'
        case 'failed': return 'danger'
        default: return 'info'
      }
    },
    
    // 获取状态标签文本
    getStatusLabel(status) {
      switch (status) {
        case 'completed': return '已完成'
        case 'pending': return '进行中'
        case 'failed': return '失败'
        default: return '未知'
      }
    },
    
    // 获取置信度颜色
    getConfidenceColor(confidence) {
      if (confidence >= 0.8) return '#67C23A'
      if (confidence >= 0.6) return '#E6A23C'
      return '#F56C6C'
    },
    
    // 日期格式化
    formatDate(date) {
      const d = new Date(date)
      const year = d.getFullYear()
      const month = ('0' + (d.getMonth() + 1)).slice(-2)
      const day = ('0' + d.getDate()).slice(-2)
      return `${year}-${month}-${day}`
    },
    
    // 文本截断
    truncateText(text, length) {
      if (!text) return ''
      return text.length > length ? text.substring(0, length) + '...' : text
    },
    
    // Added datetime formatting function
    formatDateTime(dateString) {
      if (!dateString) return '-';
      const date = new Date(dateString);
      const year = date.getFullYear();
      const month = ('0' + (date.getMonth() + 1)).slice(-2);
      const day = ('0' + date.getDate()).slice(-2);
      const hours = ('0' + date.getHours()).slice(-2);
      const minutes = ('0' + date.getMinutes()).slice(-2);
      const seconds = ('0' + date.getSeconds()).slice(-2);
      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
    }
  }
}
</script>

<style>
.detection-statistics {
  padding: 20px;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  margin: 0;
}

.data-overview {
  margin-bottom: 20px;
}

.data-card {
  height: 170px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.data-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.card-title {
  font-size: 16px;
  font-weight: 500;
}

.data-card-body {
  display: flex;
  flex-direction: column;
}

.card-value {
  font-size: 30px;
  font-weight: bold;
  margin-bottom: 5px;
}

.card-trend {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 14px;
}

.total-card .icon {
  color: #409EFF;
  font-size: 24px;
}

.true-card .icon {
  color: #67C23A;
  font-size: 24px;
}

.fake-card .icon {
  color: #F56C6C;
  font-size: 24px;
}

.task-card .icon {
  color: #E6A23C;
  font-size: 24px;
}

.trend-value {
  font-weight: 500;
}

.trend-value.positive {
  color: #67C23A;
}

.trend-value.negative {
  color: #F56C6C;
}

.chart-row {
  margin-bottom: 20px;
}

.chart-card {
  margin-bottom: 20px;
}

.chart-container {
  height: 300px;
}

.content-cell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 300px;
}

.error-row {
  background-color: #fef0f0;
}

// Add style to align progress text
.recent-detection-card .el-progress__text {
  text-align: right;
  display: inline-block;
  width: 40px;
  margin-left: 5px;
}

.recent-detection-card .el-progress-bar {
  width: 100px;
  display: inline-block;
}

.recent-detection-card .el-progress-bar__outer {
  height: 12px !important;
}
</style> 

================================================================================
文件路径: src\views\admin\Settings.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\Settings.vue
================================================================================

<template>
  <div class="admin-settings">
    <div class="page-header">
      <h1 class="page-title">系统参数设置</h1>
      <div class="page-actions">
        <el-button type="primary" icon="el-icon-refresh" @click="loadSettings">刷新</el-button>
      </div>
    </div>
    
    <el-card shadow="hover" class="setting-card">
      <div slot="header" class="clearfix">
        <span>模型权重配置</span>
        <el-tooltip content="模型权重用于融合本地模型和LLM模型的预测结果" placement="top">
          <i class="el-icon-question"></i>
        </el-tooltip>
      </div>
      
      <div v-loading="loading">
        <el-form :model="weightForm" ref="weightForm" label-width="150px" :rules="rules">
          <el-form-item label="本地模型权重" prop="localModelWeight">
            <el-slider
              v-model="weightForm.localModelWeight"
              :format-tooltip="formatTooltip"
              :min="0"
              :max="1"
              :step="0.05"
              show-stops
            ></el-slider>
            <span class="weight-value">{{ formatTooltip(weightForm.localModelWeight) }}</span>
          </el-form-item>
          
          <el-form-item label="LLM模型权重" prop="llmWeight">
            <el-slider
              v-model="weightForm.llmWeight"
              :format-tooltip="formatTooltip"
              :min="0"
              :max="1"
              :step="0.05"
              show-stops
              :disabled="true"
            ></el-slider>
            <span class="weight-value">{{ formatTooltip(weightForm.llmWeight) }}</span>
          </el-form-item>
          
          <el-divider content-position="center">模型融合阈值设置</el-divider>
          
          <el-form-item label="虚假新闻阈值" prop="fakeThreshold">
            <el-slider
              v-model="weightForm.fakeThreshold"
              :format-tooltip="formatTooltip"
              :min="0.5"
              :max="0.9"
              :step="0.05"
              show-stops
            ></el-slider>
            <el-tooltip content="得分高于此阈值的新闻将被判定为虚假新闻" placement="top">
              <i class="el-icon-question"></i>
            </el-tooltip>
            <span class="weight-value">{{ formatTooltip(weightForm.fakeThreshold) }}</span>
          </el-form-item>
          
          <el-form-item label="真实新闻阈值" prop="realThreshold">
            <el-slider
              v-model="weightForm.realThreshold"
              :format-tooltip="formatTooltip"
              :min="0.1"
              :max="0.5"
              :step="0.05"
              show-stops
            ></el-slider>
            <el-tooltip content="得分低于此阈值的新闻将被判定为真实新闻" placement="top">
              <i class="el-icon-question"></i>
            </el-tooltip>
            <span class="weight-value">{{ formatTooltip(weightForm.realThreshold) }}</span>
          </el-form-item>
          
          <el-form-item>
            <el-button type="primary" @click="saveSettings" :loading="saving">保存设置</el-button>
            <el-button @click="resetForm">重置</el-button>
          </el-form-item>
        </el-form>
      </div>
    </el-card>
    
    <el-card shadow="hover" class="setting-card">
      <div slot="header" class="clearfix">
        <span>API配置</span>
      </div>
      
      <div v-loading="loading">
        <el-form :model="apiForm" ref="apiForm" label-width="150px" :rules="apiRules">
          <el-form-item label="OpenRouter API密钥" prop="openrouterApiKey">
            <el-input 
              v-model="apiForm.openrouterApiKey" 
              placeholder="sk-or-v1-..." 
              show-password
              clearable
            ></el-input>
            <div class="form-help-text">
              <i class="el-icon-info"></i>
              用于LLM交叉验证的OpenRouter API密钥
            </div>
          </el-form-item>
          
          <el-form-item label="GPU加速" prop="useGpu">
            <el-switch
              v-model="apiForm.useGpu"
              active-text="启用"
              inactive-text="禁用"
            ></el-switch>
            <div class="form-help-text">
              <i class="el-icon-info"></i>
              启用GPU加速可以提高检测速度，但需要服务器支持CUDA
            </div>
          </el-form-item>
          
          <el-form-item>
            <el-button type="primary" @click="saveApiSettings" :loading="saving">保存API设置</el-button>
            <el-button @click="resetApiForm">重置</el-button>
          </el-form-item>
        </el-form>
      </div>
    </el-card>
  </div>
</template>

<script>
import axios from 'axios'

export default {
  name: 'AdminSettings',
  data() {
    return {
      loading: false,
      saving: false,
      
      // 模型权重表单
      weightForm: {
        localModelWeight: 0.4,
        llmWeight: 0.6,
        fakeThreshold: 0.65,
        realThreshold: 0.35
      },
      
      // API设置表单
      apiForm: {
        openrouterApiKey: '',
        useGpu: false
      },
      
      // 表单验证规则
      rules: {
        localModelWeight: [
          { required: true, message: '请设置本地模型权重', trigger: 'change' }
        ],
        fakeThreshold: [
          { required: true, message: '请设置虚假新闻阈值', trigger: 'change' }
        ],
        realThreshold: [
          { required: true, message: '请设置真实新闻阈值', trigger: 'change' }
        ]
      },
      
      // API设置表单验证规则
      apiRules: {
        openrouterApiKey: [
          { pattern: /^sk-or-v1-[a-zA-Z0-9]+$/, message: '无效的API密钥格式', trigger: 'blur' }
        ]
      }
    }
  },
  watch: {
    'weightForm.localModelWeight': function(val) {
      this.weightForm.llmWeight = parseFloat((1 - val).toFixed(2))
    }
  },
  created() {
    this.loadSettings()
  },
  methods: {
    // 格式化滑块提示
    formatTooltip(val) {
      return parseFloat(val).toFixed(2)
    },
    
    // 加载设置
    loadSettings() {
      this.loading = true
      
      // 由于后端没有实现list方法，我们需要使用model_weights action来获取数据
      axios.get('/settings/model_weights/')
        .then(response => {
          const data = response.data
          this.weightForm = {
            localModelWeight: data.local_model_weight,
            llmWeight: data.llm_weight,
            fakeThreshold: data.fake_threshold,
            realThreshold: data.real_threshold
          }
          
          this.apiForm = {
            openrouterApiKey: data.openrouter_api_key || '',
            useGpu: data.use_gpu || false
          }
          
          this.loading = false
        })
        .catch(error => {
          console.error('加载设置失败:', error)
          this.$message.error('加载设置失败，请重试')
          this.loading = false
        })
    },
    
    // 保存模型权重设置
    saveSettings() {
      this.$refs.weightForm.validate(valid => {
        if (valid) {
          this.saving = true
          
          // 使用model_weights action的POST方法保存设置
          axios.post('/settings/model_weights/', {
            local_model_weight: this.weightForm.localModelWeight,
            llm_weight: this.weightForm.llmWeight,
            fake_threshold: this.weightForm.fakeThreshold,
            real_threshold: this.weightForm.realThreshold
          })
            .then(() => {
              this.$message.success('模型权重设置已保存')
              this.saving = false
            })
            .catch(error => {
              console.error('保存设置失败:', error)
              this.$message.error('保存设置失败，请重试')
              this.saving = false
            })
        }
      })
    },
    
    // 保存API设置
    saveApiSettings() {
      this.$refs.apiForm.validate(valid => {
        if (valid) {
          this.saving = true
          
          // 使用api_config action的POST方法保存API设置
          axios.post('/settings/api_config/', {
            openrouter_api_key: this.apiForm.openrouterApiKey,
            use_gpu: this.apiForm.useGpu
          })
            .then(() => {
              this.$message.success('API设置已保存')
              this.saving = false
            })
            .catch(error => {
              console.error('保存API设置失败:', error)
              this.$message.error('保存API设置失败，请重试')
              this.saving = false
            })
        }
      })
    },
    
    // 重置表单
    resetForm() {
      this.$refs.weightForm.resetFields()
      this.loadSettings()
    },
    
    // 重置API表单
    resetApiForm() {
      this.$refs.apiForm.resetFields()
      this.loadSettings()
    }
  }
}
</script>

<style scoped>
.admin-settings {
  padding: 20px;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  margin: 0;
}

.setting-card {
  margin-bottom: 20px;
}

.weight-value {
  margin-left: 10px;
  color: #409EFF;
  font-weight: bold;
}

.form-help-text {
  color: #909399;
  font-size: 12px;
  margin-top: 5px;
}
</style> 

================================================================================
文件路径: src\views\admin\SystemLogs.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\SystemLogs.vue
================================================================================

<template>
  <div class="admin-logs">
    <div class="page-header">
      <h1 class="page-title">系统日志</h1>
      <div class="page-actions">
        <el-button type="primary" icon="el-icon-refresh" @click="loadLogs">刷新</el-button>
      </div>
    </div>
    
    <el-card shadow="hover">
      <div slot="header" class="clearfix">
        <span>系统日志查看</span>
      </div>
      
      <div class="description">
        <p>该页面显示系统运行日志文件的内容，帮助管理员排查系统运行问题。</p>
      </div>
      
      <div v-loading="loading">
        <el-table
          :data="logs"
          style="width: 100%"
          border
          stripe
          :max-height="600"
        >
          <el-table-column
            prop="timestamp"
            label="时间"
            width="240">
          </el-table-column>
          <el-table-column
            prop="level"
            label="级别"
            width="100">
            <template slot-scope="scope">
              <el-tag 
                :type="getLogLevelType(scope.row.level)"
                size="small">
                {{ scope.row.level }}
              </el-tag>
            </template>
          </el-table-column>
          <el-table-column
            prop="message"
            label="内容">
          </el-table-column>
        </el-table>
      </div>
    </el-card>
  </div>
</template>

<script>
import axios from 'axios'

export default {
  name: 'SystemLogs',
  data() {
    return {
      loading: false,
      logs: []
    }
  },
  created() {
    this.loadLogs()
  },
  methods: {
    // 加载日志
    loadLogs() {
      this.loading = true
      
      // 读取系统日志文件
      axios.get('/settings/logs/')
        .then(response => {
          this.logs = this.parseLogData(response.data)
          this.loading = false
        })
        .catch(error => {
          console.error('获取日志失败:', error)
          this.$message.error('获取日志失败，请重试')
          this.loading = false
          
          // 开发环境下使用模拟数据
          if (process.env.NODE_ENV === 'development') {
            this.loadMockData()
          }
        })
    },
    
    // 解析日志数据
    parseLogData(data) {
      if (!data || !data.logs || !Array.isArray(data.logs)) {
        return []
      }
      
      return data.logs.map((log, index) => ({
        id: index + 1,
        timestamp: log.timestamp || '',
        level: log.level || 'INFO',
        logger: log.logger || '',
        message: log.message || ''
      }))
    },
    
    // 加载模拟数据（开发阶段使用）
    loadMockData() {
      const mockLogs = []
      const levels = ['INFO', 'WARNING', 'ERROR', 'DEBUG']
      const loggers = ['django.server', 'django.request', 'detection.views', 'users.views', 'settings.views']
      const messages = [
        '用户登录成功',
        '检测任务创建成功',
        '检测任务完成',
        '模型权重更新',
        '系统启动',
        '数据库连接错误',
        'API请求超时',
        '用户权限验证失败',
        '文件上传失败',
        '非法请求被拦截'
      ]
      
      // 生成50条模拟日志
      for (let i = 0; i < 50; i++) {
        const date = new Date()
        date.setMinutes(date.getMinutes() - i * 30)
        
        mockLogs.push({
          id: i + 1,
          timestamp: date.toISOString().replace('T', ' ').substring(0, 19),
          level: levels[Math.floor(Math.random() * levels.length)],
          logger: loggers[Math.floor(Math.random() * loggers.length)],
          message: messages[Math.floor(Math.random() * messages.length)]
        })
      }
      
      this.logs = mockLogs
    },
    
    // 获取日志级别标签类型
    getLogLevelType(level) {
      switch (level) {
        case 'ERROR': return 'danger'
        case 'WARNING': return 'warning'
        case 'INFO': return 'success'
        case 'DEBUG': return 'info'
        default: return ''
      }
    }
  }
}
</script>

<style scoped>
.admin-logs {
  padding: 20px;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  margin: 0;
}

.description {
  margin-bottom: 20px;
  color: #606266;
}
</style> 

================================================================================
文件路径: src\views\admin\UserManagement.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\UserManagement.vue
================================================================================

<template>
  <div class="user-management">
    <div class="page-header">
      <h1 class="page-title">用户管理</h1>
      <el-button type="primary" @click="showAddUserDialog">添加用户</el-button>
    </div>
    
    <!-- 搜索和筛选 -->
    <el-card shadow="hover" class="filter-container">
      <el-form :inline="true" :model="searchForm" class="search-form">
        <el-form-item label="用户名">
          <el-input v-model="searchForm.username" placeholder="请输入用户名" clearable></el-input>
        </el-form-item>
        <el-form-item label="邮箱">
          <el-input v-model="searchForm.email" placeholder="请输入邮箱" clearable></el-input>
        </el-form-item>
        <el-form-item label="状态">
          <el-select v-model="searchForm.status" placeholder="请选择状态" clearable>
            <el-option label="启用" value="active"></el-option>
            <el-option label="禁用" value="inactive"></el-option>
          </el-select>
        </el-form-item>
        <el-form-item label="角色">
          <el-select v-model="searchForm.role" placeholder="请选择角色" clearable>
            <el-option label="普通用户" value="user"></el-option>
            <el-option label="管理员" value="admin"></el-option>
          </el-select>
        </el-form-item>
        <el-form-item>
          <el-button type="primary" icon="el-icon-search" @click="handleSearch">搜索</el-button>
          <el-button icon="el-icon-refresh" @click="resetSearch">重置</el-button>
        </el-form-item>
      </el-form>
    </el-card>
    
    <!-- 用户列表 -->
    <el-card shadow="hover" class="list-container">
      <div slot="header" class="clearfix">
        <span>用户列表</span>
        <el-button style="float: right; padding: 3px 0" type="text" @click="refreshUserList">刷新列表</el-button>
      </div>
      
      <el-table
        :data="userList"
        border
        style="width: 100%"
        v-loading="loading"
        @selection-change="handleSelectionChange">
        <el-table-column type="selection" width="55"></el-table-column>
        <el-table-column type="index" width="50" label="序号"></el-table-column>
        <el-table-column prop="avatar" label="头像" width="80">
          <template slot-scope="scope">
            <el-avatar :size="40" :src="scope.row.avatar">
              {{ scope.row.username.charAt(0).toUpperCase() }}
            </el-avatar>
          </template>
        </el-table-column>
        <el-table-column prop="username" label="用户名" width="120"></el-table-column>
        <el-table-column prop="email" label="邮箱" min-width="200"></el-table-column>
        <el-table-column prop="role" label="角色" width="100">
          <template slot-scope="scope">
            <el-tag :type="scope.row.role === 'admin' ? 'danger' : 'primary'">
              {{ scope.row.role === 'admin' ? '管理员' : '普通用户' }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="status" label="状态" width="100">
          <template slot-scope="scope">
            <el-tag :type="scope.row.status === 'active' ? 'success' : 'info'">
              {{ scope.row.status === 'active' ? '启用' : '禁用' }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="detection_count" label="检测次数" width="100"></el-table-column>
        <el-table-column prop="register_time" label="注册时间" width="180"></el-table-column>
        <el-table-column prop="last_login" label="最后登录" width="180"></el-table-column>
        <el-table-column label="操作" width="200" fixed="right">
          <template slot-scope="scope">
            <el-button
              size="mini"
              type="primary"
              plain
              @click="handleEdit(scope.row)"
              icon="el-icon-edit"
              circle></el-button>
            <el-button
              size="mini"
              type="warning"
              plain
              @click="handleResetPassword(scope.row)"
              icon="el-icon-key"
              circle></el-button>
            <el-button
              size="mini"
              :type="scope.row.status === 'active' ? 'info' : 'success'"
              plain
              @click="handleToggleStatus(scope.row)"
              :icon="scope.row.status === 'active' ? 'el-icon-lock' : 'el-icon-unlock'"
              circle></el-button>
            <el-button
              size="mini"
              type="danger"
              plain
              @click="handleDelete(scope.row)"
              icon="el-icon-delete"
              circle></el-button>
          </template>
        </el-table-column>
      </el-table>
      
      <!-- 批量操作 -->
      <div class="batch-operation">
        <el-button
          :disabled="selectedUsers.length === 0"
          size="small"
          @click="batchEnable">批量启用</el-button>
        <el-button
          :disabled="selectedUsers.length === 0"
          size="small"
          @click="batchDisable">批量禁用</el-button>
        <el-button
          :disabled="selectedUsers.length === 0"
          size="small"
          type="danger"
          @click="batchDelete">批量删除</el-button>
      </div>
      
      <!-- 分页 -->
      <div class="pagination-container">
        <el-pagination
          @size-change="handleSizeChange"
          @current-change="handleCurrentChange"
          :current-page="pagination.currentPage"
          :page-sizes="[10, 20, 50, 100]"
          :page-size="pagination.pageSize"
          layout="total, sizes, prev, pager, next, jumper"
          :total="pagination.total">
        </el-pagination>
      </div>
    </el-card>
    
    <!-- 添加/编辑用户对话框 -->
    <el-dialog
      :title="dialogType === 'add' ? '添加用户' : '编辑用户'"
      :visible.sync="userFormVisible"
      width="500px">
      <el-form :model="userForm" :rules="userFormRules" ref="userForm" label-width="100px">
        <el-form-item label="用户名" prop="username">
          <el-input v-model="userForm.username" :disabled="dialogType === 'edit'"></el-input>
        </el-form-item>
        <el-form-item label="邮箱" prop="email">
          <el-input v-model="userForm.email"></el-input>
        </el-form-item>
        <el-form-item label="密码" prop="password" v-if="dialogType === 'add'">
          <el-input v-model="userForm.password" type="password" show-password></el-input>
        </el-form-item>
        <el-form-item label="确认密码" prop="confirmPassword" v-if="dialogType === 'add'">
          <el-input v-model="userForm.confirmPassword" type="password" show-password></el-input>
        </el-form-item>
        <el-form-item label="角色" prop="role">
          <el-select v-model="userForm.role" placeholder="请选择角色">
            <el-option label="普通用户" value="user"></el-option>
            <el-option label="管理员" value="admin"></el-option>
          </el-select>
        </el-form-item>
        <el-form-item label="状态" prop="status">
          <el-radio-group v-model="userForm.status">
            <el-radio label="active">启用</el-radio>
            <el-radio label="inactive">禁用</el-radio>
          </el-radio-group>
        </el-form-item>
      </el-form>
      <div slot="footer" class="dialog-footer">
        <el-button @click="userFormVisible = false">取 消</el-button>
        <el-button type="primary" @click="submitUserForm" :loading="formSubmitting">确 定</el-button>
      </div>
    </el-dialog>
    
    <!-- 重置密码对话框 -->
    <el-dialog
      title="重置密码"
      :visible.sync="resetPasswordVisible"
      width="400px">
      <el-form :model="resetPasswordForm" :rules="resetPasswordRules" ref="resetPasswordForm" label-width="100px">
        <el-form-item label="新密码" prop="newPassword">
          <el-input v-model="resetPasswordForm.newPassword" type="password" show-password></el-input>
        </el-form-item>
        <el-form-item label="确认密码" prop="confirmPassword">
          <el-input v-model="resetPasswordForm.confirmPassword" type="password" show-password></el-input>
        </el-form-item>
      </el-form>
      <div slot="footer" class="dialog-footer">
        <el-button @click="resetPasswordVisible = false">取 消</el-button>
        <el-button type="primary" @click="submitResetPassword" :loading="resetPasswordSubmitting">确 定</el-button>
      </div>
    </el-dialog>
  </div>
</template>

<script>
export default {
  name: 'UserManagement',
  data() {
    // 校验邮箱
    const validateEmail = (rule, value, callback) => {
      const emailRegex = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;
      if (!value) {
        callback(new Error('请输入邮箱地址'));
      } else if (!emailRegex.test(value)) {
        callback(new Error('请输入正确的邮箱地址'));
      } else {
        callback();
      }
    };
    
    // 校验确认密码
    const validateConfirmPassword = (rule, value, callback) => {
      if (value !== this.userForm.password) {
        callback(new Error('两次输入密码不一致'));
      } else {
        callback();
      }
    };
    
    // 校验重置密码
    const validateResetConfirmPassword = (rule, value, callback) => {
      if (value !== this.resetPasswordForm.newPassword) {
        callback(new Error('两次输入密码不一致'));
      } else {
        callback();
      }
    };
    
    return {
      // 搜索表单
      searchForm: {
        username: '',
        email: '',
        status: '',
        role: ''
      },
      
      // 用户列表
      userList: [],
      loading: true,
      selectedUsers: [],
      
      // 分页配置
      pagination: {
        currentPage: 1,
        pageSize: 10,
        total: 0
      },
      
      // 用户表单
      userFormVisible: false,
      dialogType: 'add', // 'add' 或 'edit'
      formSubmitting: false,
      userForm: {
        username: '',
        email: '',
        password: '',
        confirmPassword: '',
        role: 'user',
        status: 'active'
      },
      userFormRules: {
        username: [
          { required: true, message: '请输入用户名', trigger: 'blur' },
          { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' }
        ],
        email: [
          { required: true, message: '请输入邮箱地址', trigger: 'blur' },
          { validator: validateEmail, trigger: 'blur' }
        ],
        password: [
          { required: true, message: '请输入密码', trigger: 'blur' },
          { min: 6, message: '密码长度不能少于6个字符', trigger: 'blur' }
        ],
        confirmPassword: [
          { required: true, message: '请再次输入密码', trigger: 'blur' },
          { validator: validateConfirmPassword, trigger: 'blur' }
        ],
        role: [
          { required: true, message: '请选择角色', trigger: 'change' }
        ],
        status: [
          { required: true, message: '请选择状态', trigger: 'change' }
        ]
      },
      
      // 重置密码
      resetPasswordVisible: false,
      resetPasswordSubmitting: false,
      currentUser: null,
      resetPasswordForm: {
        newPassword: '',
        confirmPassword: ''
      },
      resetPasswordRules: {
        newPassword: [
          { required: true, message: '请输入新密码', trigger: 'blur' },
          { min: 6, message: '密码长度不能少于6个字符', trigger: 'blur' }
        ],
        confirmPassword: [
          { required: true, message: '请再次输入密码', trigger: 'blur' },
          { validator: validateResetConfirmPassword, trigger: 'blur' }
        ]
      }
    };
  },
  created() {
    this.getUserList();
  },
  methods: {
    // 获取用户列表
    getUserList() {
      this.loading = true;
      
      // 这里应该是实际的API调用
      // this.$http.get('/api/users', {
      //   params: {
      //     page: this.pagination.currentPage,
      //     limit: this.pagination.pageSize,
      //     ...this.searchForm
      //   }
      // }).then(response => {
      //   this.userList = response.data.users;
      //   this.pagination.total = response.data.total;
      //   this.loading = false;
      // }).catch(error => {
      //   console.error('获取用户列表失败:', error);
      //   this.loading = false;
      //   this.$message.error('获取用户列表失败');
      // });
      
      // 模拟数据
      setTimeout(() => {
        const mockUsers = [];
        const total = 126;
        const startIndex = (this.pagination.currentPage - 1) * this.pagination.pageSize + 1;
        const endIndex = Math.min(startIndex + this.pagination.pageSize - 1, total);
        
        for (let i = startIndex; i <= endIndex; i++) {
          const isAdmin = i === 1; // 第一个用户是管理员
          mockUsers.push({
            id: i,
            username: i === 1 ? 'admin' : `user${i}`,
            email: i === 1 ? 'admin@example.com' : `user${i}@example.com`,
            role: isAdmin ? 'admin' : 'user',
            status: Math.random() > 0.2 ? 'active' : 'inactive',
            avatar: '',
            detection_count: Math.floor(Math.random() * 100),
            register_time: '2023-' + Math.floor(Math.random() * 12 + 1).toString().padStart(2, '0') + '-' +
                          Math.floor(Math.random() * 28 + 1).toString().padStart(2, '0') + ' ' +
                          Math.floor(Math.random() * 24).toString().padStart(2, '0') + ':' +
                          Math.floor(Math.random() * 60).toString().padStart(2, '0') + ':' +
                          Math.floor(Math.random() * 60).toString().padStart(2, '0'),
            last_login: '2023-' + Math.floor(Math.random() * 12 + 1).toString().padStart(2, '0') + '-' +
                        Math.floor(Math.random() * 28 + 1).toString().padStart(2, '0') + ' ' +
                        Math.floor(Math.random() * 24).toString().padStart(2, '0') + ':' +
                        Math.floor(Math.random() * 60).toString().padStart(2, '0') + ':' +
                        Math.floor(Math.random() * 60).toString().padStart(2, '0')
          });
        }
        
        // 根据搜索条件筛选
        if (this.searchForm.username) {
          mockUsers = mockUsers.filter(user => user.username.includes(this.searchForm.username));
        }
        if (this.searchForm.email) {
          mockUsers = mockUsers.filter(user => user.email.includes(this.searchForm.email));
        }
        if (this.searchForm.status) {
          mockUsers = mockUsers.filter(user => user.status === this.searchForm.status);
        }
        if (this.searchForm.role) {
          mockUsers = mockUsers.filter(user => user.role === this.searchForm.role);
        }
        
        this.userList = mockUsers;
        this.pagination.total = total;
        this.loading = false;
      }, 500);
    },
    
    // 搜索
    handleSearch() {
      this.pagination.currentPage = 1;
      this.getUserList();
    },
    
    // 重置搜索
    resetSearch() {
      this.searchForm = {
        username: '',
        email: '',
        status: '',
        role: ''
      };
      this.handleSearch();
    },
    
    // 刷新用户列表
    refreshUserList() {
      this.getUserList();
    },
    
    // 处理页码变化
    handleCurrentChange(page) {
      this.pagination.currentPage = page;
      this.getUserList();
    },
    
    // 处理每页显示数量变化
    handleSizeChange(size) {
      this.pagination.pageSize = size;
      this.pagination.currentPage = 1;
      this.getUserList();
    },
    
    // 多选变化
    handleSelectionChange(selection) {
      this.selectedUsers = selection;
    },
    
    // 显示添加用户对话框
    showAddUserDialog() {
      this.dialogType = 'add';
      this.userForm = {
        username: '',
        email: '',
        password: '',
        confirmPassword: '',
        role: 'user',
        status: 'active'
      };
      this.userFormVisible = true;
      this.$nextTick(() => {
        this.$refs.userForm && this.$refs.userForm.clearValidate();
      });
    },
    
    // 编辑用户
    handleEdit(row) {
      this.dialogType = 'edit';
      this.userForm = {
        id: row.id,
        username: row.username,
        email: row.email,
        role: row.role,
        status: row.status
      };
      this.userFormVisible = true;
      this.$nextTick(() => {
        this.$refs.userForm && this.$refs.userForm.clearValidate();
      });
    },
    
    // 提交用户表单
    submitUserForm() {
      this.$refs.userForm.validate(valid => {
        if (valid) {
          this.formSubmitting = true;
          
          // 这里应该是实际的API调用
          // const apiMethod = this.dialogType === 'add' ? 'post' : 'put';
          // const apiUrl = this.dialogType === 'add' ? '/api/users' : `/api/users/${this.userForm.id}`;
          // this.$http[apiMethod](apiUrl, this.userForm)
          //   .then(response => {
          //     this.formSubmitting = false;
          //     this.userFormVisible = false;
          //     this.$message.success(this.dialogType === 'add' ? '添加用户成功' : '编辑用户成功');
          //     this.getUserList();
          //   })
          //   .catch(error => {
          //     console.error(this.dialogType === 'add' ? '添加用户失败:' : '编辑用户失败:', error);
          //     this.formSubmitting = false;
          //     this.$message.error(this.dialogType === 'add' ? '添加用户失败' : '编辑用户失败');
          //   });
          
          // 模拟API调用
          setTimeout(() => {
            this.formSubmitting = false;
            this.userFormVisible = false;
            this.$message.success(this.dialogType === 'add' ? '添加用户成功' : '编辑用户成功');
            this.getUserList();
          }, 1000);
        }
      });
    },
    
    // 重置密码
    handleResetPassword(row) {
      this.currentUser = row;
      this.resetPasswordForm = {
        newPassword: '',
        confirmPassword: ''
      };
      this.resetPasswordVisible = true;
      this.$nextTick(() => {
        this.$refs.resetPasswordForm && this.$refs.resetPasswordForm.clearValidate();
      });
    },
    
    // 提交重置密码
    submitResetPassword() {
      this.$refs.resetPasswordForm.validate(valid => {
        if (valid) {
          this.resetPasswordSubmitting = true;
          
          // 这里应该是实际的API调用
          // this.$http.post(`/api/users/${this.currentUser.id}/reset-password`, {
          //   newPassword: this.resetPasswordForm.newPassword
          // })
          //   .then(response => {
          //     this.resetPasswordSubmitting = false;
          //     this.resetPasswordVisible = false;
          //     this.$message.success('密码重置成功');
          //   })
          //   .catch(error => {
          //     console.error('密码重置失败:', error);
          //     this.resetPasswordSubmitting = false;
          //     this.$message.error('密码重置失败');
          //   });
          
          // 模拟API调用
          setTimeout(() => {
            this.resetPasswordSubmitting = false;
            this.resetPasswordVisible = false;
            this.$message.success('密码重置成功');
          }, 1000);
        }
      });
    },
    
    // 切换用户状态
    handleToggleStatus(row) {
      const action = row.status === 'active' ? '禁用' : '启用';
      
      this.$confirm(`确定要${action}用户 "${row.username}" 吗?`, '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(() => {
        // 这里应该是实际的API调用
        // this.$http.put(`/api/users/${row.id}/toggle-status`, {
        //   status: row.status === 'active' ? 'inactive' : 'active'
        // })
        //   .then(response => {
        //     this.$message.success(`${action}用户成功`);
        //     // 更新本地数据
        //     row.status = row.status === 'active' ? 'inactive' : 'active';
        //   })
        //   .catch(error => {
        //     console.error(`${action}用户失败:`, error);
        //     this.$message.error(`${action}用户失败`);
        //   });
        
        // 模拟API调用
        setTimeout(() => {
          this.$message.success(`${action}用户成功`);
          // 更新本地数据
          row.status = row.status === 'active' ? 'inactive' : 'active';
        }, 300);
      }).catch(() => {
        // 取消操作
      });
    },
    
    // 删除用户
    handleDelete(row) {
      this.$confirm(`确定要删除用户 "${row.username}" 吗?`, '警告', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'error'
      }).then(() => {
        // 这里应该是实际的API调用
        // this.$http.delete(`/api/users/${row.id}`)
        //   .then(response => {
        //     this.$message.success('删除用户成功');
        //     this.getUserList();
        //   })
        //   .catch(error => {
        //     console.error('删除用户失败:', error);
        //     this.$message.error('删除用户失败');
        //   });
        
        // 模拟API调用
        setTimeout(() => {
          this.$message.success('删除用户成功');
          this.getUserList();
        }, 300);
      }).catch(() => {
        // 取消操作
      });
    },
    
    // 批量启用
    batchEnable() {
      if (this.selectedUsers.length === 0) return;
      
      const usernames = this.selectedUsers.map(user => user.username).join('、');
      this.$confirm(`确定要启用选中的 ${this.selectedUsers.length} 个用户吗?`, '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(() => {
        // 实际API调用
        // const userIds = this.selectedUsers.map(user => user.id);
        // this.$http.post('/api/users/batch-enable', { userIds })
        //   .then(response => {
        //     this.$message.success('批量启用成功');
        //     this.getUserList();
        //   })
        //   .catch(error => {
        //     console.error('批量启用失败:', error);
        //     this.$message.error('批量启用失败');
        //   });
        
        // 模拟API调用
        setTimeout(() => {
          this.$message.success('批量启用成功');
          this.getUserList();
        }, 300);
      }).catch(() => {
        // 取消操作
      });
    },
    
    // 批量禁用
    batchDisable() {
      if (this.selectedUsers.length === 0) return;
      
      const usernames = this.selectedUsers.map(user => user.username).join('、');
      this.$confirm(`确定要禁用选中的 ${this.selectedUsers.length} 个用户吗?`, '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(() => {
        // 实际API调用
        // const userIds = this.selectedUsers.map(user => user.id);
        // this.$http.post('/api/users/batch-disable', { userIds })
        //   .then(response => {
        //     this.$message.success('批量禁用成功');
        //     this.getUserList();
        //   })
        //   .catch(error => {
        //     console.error('批量禁用失败:', error);
        //     this.$message.error('批量禁用失败');
        //   });
        
        // 模拟API调用
        setTimeout(() => {
          this.$message.success('批量禁用成功');
          this.getUserList();
        }, 300);
      }).catch(() => {
        // 取消操作
      });
    },
    
    // 批量删除
    batchDelete() {
      if (this.selectedUsers.length === 0) return;
      
      this.$confirm(`确定要删除选中的 ${this.selectedUsers.length} 个用户吗?`, '警告', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'error'
      }).then(() => {
        // 实际API调用
        // const userIds = this.selectedUsers.map(user => user.id);
        // this.$http.post('/api/users/batch-delete', { userIds })
        //   .then(response => {
        //     this.$message.success('批量删除成功');
        //     this.getUserList();
        //   })
        //   .catch(error => {
        //     console.error('批量删除失败:', error);
        //     this.$message.error('批量删除失败');
        //   });
        
        // 模拟API调用
        setTimeout(() => {
          this.$message.success('批量删除成功');
          this.getUserList();
        }, 300);
      }).catch(() => {
        // 取消操作
      });
    }
  }
};
</script>

<style lang="scss" scoped>
.user-management {
  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    
    .page-title {
      margin: 0;
      font-size: 24px;
      font-weight: bold;
    }
  }
  
  .filter-container {
    margin-bottom: 20px;
    
    .search-form {
      display: flex;
      flex-wrap: wrap;
    }
  }
  
  .list-container {
    margin-bottom: 20px;
  }
  
  .batch-operation {
    margin-top: 15px;
    margin-bottom: 15px;
  }
  
  .pagination-container {
    margin-top: 15px;
    display: flex;
    justify-content: flex-end;
  }
}
</style> 

================================================================================
文件路径: src\views\admin\Users.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\admin\Users.vue
================================================================================

<template>
  <div class="admin-users">
    <div class="page-header">
      <h1 class="page-title">用户管理</h1>
      <el-button type="primary" icon="el-icon-plus" @click="handleCreate">添加用户</el-button>
    </div>
    
    <!-- 搜索过滤 -->
    <el-card shadow="hover" class="filter-container">
      <el-form :inline="true" :model="filterForm" class="demo-form-inline">
        <el-form-item label="用户名">
          <el-input v-model="filterForm.username" placeholder="用户名" clearable></el-input>
        </el-form-item>
        <el-form-item label="邮箱">
          <el-input v-model="filterForm.email" placeholder="邮箱" clearable></el-input>
        </el-form-item>
        <el-form-item label="状态">
          <el-select v-model="filterForm.active" placeholder="状态" clearable>
            <el-option label="激活" :value="true"></el-option>
            <el-option label="禁用" :value="false"></el-option>
          </el-select>
        </el-form-item>
        <el-form-item>
          <el-button type="primary" @click="handleFilter">查询</el-button>
          <el-button @click="resetFilter">重置</el-button>
        </el-form-item>
      </el-form>
    </el-card>
    
    <!-- 用户列表 -->
    <el-card shadow="hover" class="user-list">
      <div slot="header" class="clearfix">
        <span>用户列表</span>
        <el-button style="float: right;" icon="el-icon-refresh" circle @click="fetchUsers"></el-button>
      </div>
      
      <el-table
        :data="tableData"
        style="width: 100%"
        border
        v-loading="loading"
        fit
      >
        <el-table-column
          prop="username"
          label="用户名"
          min-width="120">
        </el-table-column>
        <el-table-column
          prop="email"
          label="邮箱"
          min-width="200">
        </el-table-column>
        <el-table-column
          prop="date_joined"
          label="注册时间"
          min-width="180"
          sortable>
          <template slot-scope="scope">
            {{ formatDateTime(scope.row.date_joined) }}
          </template>
        </el-table-column>
        <el-table-column
          prop="total_detections"
          label="检测次数"
          min-width="100">
        </el-table-column>
        <el-table-column
          prop="is_active"
          label="状态"
          min-width="100">
          <template slot-scope="scope">
            <el-tag :type="scope.row.is_active ? 'success' : 'danger'">
              {{ scope.row.is_active ? '激活' : '禁用' }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column
          prop="is_staff"
          label="管理员"
          min-width="100">
          <template slot-scope="scope">
            <el-tag v-if="scope.row.is_staff" type="warning">是</el-tag>
            <el-tag v-else type="info">否</el-tag>
          </template>
        </el-table-column>
        <el-table-column
          fixed="right"
          label="操作"
          min-width="220">
          <template slot-scope="scope">
            <el-button
              size="mini"
              @click="handleEdit(scope.row)">编辑</el-button>
            <el-button
              v-if="scope.row.is_active"
              size="mini"
              type="danger"
              @click="handleDeactivate(scope.row)">禁用</el-button>
            <el-button
              v-else
              size="mini"
              type="success"
              @click="handleActivate(scope.row)">激活</el-button>
          </template>
        </el-table-column>
      </el-table>
      
      <div class="pagination-container">
        <el-pagination
          background
          @size-change="handleSizeChange"
          @current-change="handleCurrentChange"
          :current-page="currentPage"
          :page-sizes="[10, 20, 30, 50]"
          :page-size="pageSize"
          layout="total, sizes, prev, pager, next, jumper"
          :total="total">
        </el-pagination>
      </div>
    </el-card>
    
    <!-- 用户编辑/创建对话框 -->
    <el-dialog
      :title="dialogType === 'create' ? '添加用户' : '编辑用户'"
      :visible.sync="dialogVisible"
      width="500px">
      <el-form :model="userForm" :rules="rules" ref="userForm" label-width="100px">
        <el-form-item label="用户名" prop="username">
          <el-input v-model="userForm.username" :disabled="dialogType === 'edit'"></el-input>
        </el-form-item>
        <el-form-item label="邮箱" prop="email">
          <el-input v-model="userForm.email"></el-input>
        </el-form-item>
        <el-form-item label="密码" prop="password" v-if="dialogType === 'create'">
          <el-input v-model="userForm.password" type="password" show-password></el-input>
        </el-form-item>
        <el-form-item label="确认密码" prop="confirmPassword" v-if="dialogType === 'create'">
          <el-input v-model="userForm.confirmPassword" type="password" show-password></el-input>
        </el-form-item>
        <el-form-item label="名" prop="first_name">
          <el-input v-model="userForm.first_name"></el-input>
        </el-form-item>
        <el-form-item label="姓" prop="last_name">
          <el-input v-model="userForm.last_name"></el-input>
        </el-form-item>
        <el-form-item label="状态">
          <el-switch
            v-model="userForm.is_active"
            active-text="激活"
            inactive-text="禁用">
          </el-switch>
        </el-form-item>
        <el-form-item label="管理员权限">
          <el-switch
            v-model="userForm.is_staff"
            active-text="启用"
            inactive-text="禁用">
          </el-switch>
        </el-form-item>
      </el-form>
      <div slot="footer" class="dialog-footer">
        <el-button @click="dialogVisible = false">取消</el-button>
        <el-button type="primary" @click="submitForm" :loading="submitting">确定</el-button>
      </div>
    </el-dialog>
  </div>
</template>

<script>
import axios from 'axios'

export default {
  name: 'AdminUsers',
  data() {
    // 自定义验证规则
    const validatePassword = (rule, value, callback) => {
      if (value === '') {
        callback(new Error('请输入密码'));
      } else if (value.length < 6) {
        callback(new Error('密码不能少于6个字符'));
      } else {
        if (this.userForm.confirmPassword !== '') {
          this.$refs.userForm.validateField('confirmPassword');
        }
        callback();
      }
    };
    const validateConfirmPassword = (rule, value, callback) => {
      if (value === '') {
        callback(new Error('请再次输入密码'));
      } else if (value !== this.userForm.password) {
        callback(new Error('两次输入密码不一致!'));
      } else {
        callback();
      }
    };
    
    return {
      loading: false,
      submitting: false,
      filterForm: {
        username: '',
        email: '',
        active: ''
      },
      tableData: [],
      currentPage: 1,
      pageSize: 10,
      total: 0,
      dialogVisible: false,
      dialogType: 'create', // create or edit
      userForm: {
        id: null,
        username: '',
        email: '',
        password: '',
        confirmPassword: '',
        first_name: '',
        last_name: '',
        is_active: true,
        is_staff: false
      },
      rules: {
        username: [
          { required: true, message: '请输入用户名', trigger: 'blur' },
          { min: 3, max: 50, message: '长度在 3 到 50 个字符', trigger: 'blur' }
        ],
        email: [
          { required: true, message: '请输入邮箱地址', trigger: 'blur' },
          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }
        ],
        password: [
          { required: true, validator: validatePassword, trigger: 'blur' }
        ],
        confirmPassword: [
          { required: true, validator: validateConfirmPassword, trigger: 'blur' }
        ],
        first_name: [
          { required: true, message: '请输入名', trigger: 'blur' }
        ],
        last_name: [
          { required: true, message: '请输入姓', trigger: 'blur' }
        ]
      }
    }
  },
  created() {
    this.fetchUsers();
  },
  methods: {
    // 格式化日期时间
    formatDateTime(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleString();
    },
    
    // 获取用户列表
    fetchUsers() {
      this.loading = true;
      
      // 构建查询参数
      const params = {
        page: this.currentPage,
        page_size: this.pageSize
      };
      
      if (this.filterForm.username) {
        params.username = this.filterForm.username;
      }
      
      if (this.filterForm.email) {
        params.email = this.filterForm.email;
      }
      
      if (this.filterForm.active !== '') {
        params.is_active = this.filterForm.active;
      }
      
      axios.get('/users/', { params })
        .then(response => {
          this.tableData = response.data.results;
          this.total = response.data.count;
          this.loading = false;
        })
        .catch(error => {
          console.error('获取用户列表失败:', error);
          this.$message.error('获取用户列表失败');
          this.loading = false;
        });
    },
    
    // 处理筛选
    handleFilter() {
      this.currentPage = 1;
      this.fetchUsers();
    },
    
    // 重置筛选
    resetFilter() {
      this.filterForm = {
        username: '',
        email: '',
        active: ''
      };
      this.currentPage = 1;
      this.fetchUsers();
    },
    
    // 处理页码变化
    handleCurrentChange(val) {
      this.currentPage = val;
      this.fetchUsers();
    },
    
    // 处理每页条数变化
    handleSizeChange(val) {
      this.pageSize = val;
      this.currentPage = 1;
      this.fetchUsers();
    },
    
    // 打开创建用户对话框
    handleCreate() {
      this.dialogType = 'create';
      this.userForm = {
        id: null,
        username: '',
        email: '',
        password: '',
        confirmPassword: '',
        first_name: '',
        last_name: '',
        is_active: true,
        is_staff: false
      };
      this.dialogVisible = true;
      this.$nextTick(() => {
        this.$refs.userForm.clearValidate();
      });
    },
    
    // 打开编辑用户对话框
    handleEdit(row) {
      this.dialogType = 'edit';
      this.userForm = {
        id: row.id,
        username: row.username,
        email: row.email,
        password: '',
        confirmPassword: '',
        first_name: row.first_name || '',
        last_name: row.last_name || '',
        is_active: row.is_active,
        is_staff: row.is_staff
      };
      this.dialogVisible = true;
      this.$nextTick(() => {
        this.$refs.userForm.clearValidate();
      });
    },
    
    // 禁用用户
    handleDeactivate(row) {
      this.$confirm('确定要禁用该用户吗?', '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(() => {
        axios.patch(`/users/${row.id}/`, { is_active: false })
          .then(() => {
            this.$message.success('用户已禁用');
            this.fetchUsers();
          })
          .catch(error => {
            console.error('禁用用户失败:', error);
            this.$message.error('禁用用户失败');
          });
      }).catch(() => {});
    },
    
    // 激活用户
    handleActivate(row) {
      axios.patch(`/users/${row.id}/`, { is_active: true })
        .then(() => {
          this.$message.success('用户已激活');
          this.fetchUsers();
        })
        .catch(error => {
          console.error('激活用户失败:', error);
          this.$message.error('激活用户失败');
        });
    },
    
    // 提交表单
    submitForm() {
      this.$refs.userForm.validate(valid => {
        if (valid) {
          this.submitting = true;
          
          const formData = {
            username: this.userForm.username,
            email: this.userForm.email,
            first_name: this.userForm.first_name,
            last_name: this.userForm.last_name,
            is_active: this.userForm.is_active,
            is_staff: this.userForm.is_staff
          };
          
          if (this.dialogType === 'create') {
            formData.password = this.userForm.password;
            formData.password2 = this.userForm.confirmPassword;
            
            axios.post('/users/', formData)
              .then(() => {
                this.$message.success('用户创建成功');
                this.dialogVisible = false;
                this.fetchUsers();
                this.submitting = false;
              })
              .catch(error => {
                console.error('创建用户失败:', error.response || error);
                let errorMessage = '创建用户失败';
                if (error.response && error.response.data) {
                  const errors = error.response.data;
                  const errorDetails = [];
                  if (typeof errors === 'object' && errors !== null) {
                    for (const field in errors) {
                      if (Array.isArray(errors[field])) {
                        if (field === 'password') {
                          const processedErrors = errors[field].map(err => {
                            if (err.includes('too short')) return '密码太短 (至少8字符)';
                            if (err.includes('too common')) return '密码太常见';
                            if (err.includes('entirely numeric')) return '密码不能全是数字';
                            return err;
                          });
                          errorDetails.push(`密码: ${processedErrors.join(', ')}`);
                        } else {
                          errorDetails.push(`${field}: ${errors[field].join(', ')}`);
                        }
                      } else {
                         errorDetails.push(`${field}: ${errors[field]}`);
                      }
                    }
                    if (errorDetails.length > 0) {
                       errorMessage += ': ' + errorDetails.join('; ');
                    } else if (errors.detail) {
                       errorMessage += ': ' + errors.detail;
                    }
                  } else if (typeof errors === 'string') {
                     errorMessage += ': ' + errors;
                  }
                } else if (error.message) {
                   errorMessage += ': ' + error.message;
                }
                this.$message.error(errorMessage);
                this.submitting = false;
              });
          } else {
            axios.patch(`/users/${this.userForm.id}/`, formData)
              .then(() => {
                this.$message.success('用户更新成功');
                this.dialogVisible = false;
                this.fetchUsers();
                this.submitting = false;
              })
              .catch(error => {
                console.error('更新用户失败:', error);
                this.$message.error('更新用户失败: ' + (error.response?.data?.detail || '未知错误'));
                this.submitting = false;
              });
          }
        }
      });
    }
  }
}
</script>

<style scoped>
.admin-users {
  padding: 20px;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.page-title {
  font-size: 24px;
  margin: 0;
}

.filter-container {
  margin-bottom: 20px;
  padding: 15px;
}

.user-list {
  margin-bottom: 20px;
  width: 100%;
}

.pagination-container {
  margin-top: 20px;
  text-align: right;
}

/* 添加表格样式 */
/deep/ .el-table {
  width: 100%;
}

/deep/ .el-table__body {
  width: 100%;
}

/deep/ .el-table .cell {
  padding-left: 10px;
  padding-right: 10px;
}
</style> 

================================================================================
文件路径: src\views\dashboard\Dashboard.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\dashboard\Dashboard.vue
================================================================================

<template>
  <div class="dashboard-container">
    <div class="page-title">仪表盘</div>
    
    <el-row :gutter="20">
      <el-col :span="6">
        <el-card shadow="hover" class="dashboard-card">
          <div class="card-content">
            <div class="card-icon">
              <i class="el-icon-s-data"></i>
            </div>
            <div class="card-info">
              <div class="card-title">检测总数</div>
              <div class="card-value">{{ stats.total_count }}</div>
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :span="6">
        <el-card shadow="hover" class="dashboard-card">
          <div class="card-content">
            <div class="card-icon real">
              <i class="el-icon-check"></i>
            </div>
            <div class="card-info">
              <div class="card-title">真实新闻</div>
              <div class="card-value">{{ stats.real_count }} ({{ stats.real_percentage.toFixed(2) }}%)</div>
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :span="6">
        <el-card shadow="hover" class="dashboard-card">
          <div class="card-content">
            <div class="card-icon fake">
              <i class="el-icon-close"></i>
            </div>
            <div class="card-info">
              <div class="card-title">虚假新闻</div>
              <div class="card-value">{{ stats.fake_count }} ({{ stats.fake_percentage.toFixed(2) }}%)</div>
            </div>
          </div>
        </el-card>
      </el-col>
      
      <el-col :span="6">
        <el-card shadow="hover" class="dashboard-card">
          <div class="card-content">
            <div class="card-icon pending">
              <i class="el-icon-loading"></i>
            </div>
            <div class="card-info">
              <div class="card-title">待处理</div>
              <div class="card-value">{{ stats.pending_count }}</div>
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>
    
    <el-row :gutter="20" class="chart-row">
      <el-col :span="12">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>检测结果分布</span>
          </div>
          <div class="chart-container" ref="pieChart"></div>
        </el-card>
      </el-col>
      
      <el-col :span="12">
        <el-card shadow="hover" class="chart-card">
          <div slot="header" class="clearfix">
            <span>近期检测统计</span>
          </div>
          <div class="chart-container" ref="lineChart"></div>
        </el-card>
      </el-col>
    </el-row>
    
    <el-row :gutter="20">
      <el-col :span="24">
        <el-card shadow="hover">
          <div slot="header" class="clearfix">
            <span>最近检测</span>
            <el-button style="float: right; padding: 3px 0" type="text" @click="viewMore">查看更多</el-button>
          </div>
          
          <el-table
            :data="recentDetections"
            style="width: 100%"
            v-loading="loading"
            border
            fit
          >
            <el-table-column
              prop="title"
              label="标题"
              min-width="300"
            ></el-table-column>
            <el-table-column
              prop="created_at"
              label="检测时间"
              width="180"
            >
              <template slot-scope="scope">
                {{ formatDate(scope.row.created_at) }}
              </template>
            </el-table-column>
            <el-table-column
              prop="status"
              label="状态"
              width="100"
            >
              <template slot-scope="scope">
                <el-tag :type="getStatusType(scope.row.status)">{{ getStatusText(scope.row.status) }}</el-tag>
              </template>
            </el-table-column>
            <el-table-column
              prop="result"
              label="结果"
              width="90"
            >
              <template slot-scope="scope">
                <el-tag v-if="scope.row.status === 'completed' && scope.row.result"
                        :type="getResultTagType(scope.row.result)">
                  {{ getResultText(scope.row.result) }}
                </el-tag>
                <span v-else-if="scope.row.status === 'completed'">未知</span>
                <span v-else>-</span>
              </template>
            </el-table-column>
            <el-table-column
              prop="confidence"
              label="置信度"
              width="100"
            >
              <template slot-scope="scope">
                <div v-if="scope.row.status === 'completed' && scope.row.confidence_score != null && scope.row.result !== 'unknown'">{{ (scope.row.confidence_score * 100).toFixed(2) }}%</div>
                <span v-else>-</span>
              </template>
            </el-table-column>
            <el-table-column
              fixed="right"
              label="操作"
              width="120"
            >
              <template slot-scope="scope">
                <el-button
                  @click="viewDetail(scope.row.id)"
                  type="text"
                  size="small">
                  查看详情
                </el-button>
              </template>
            </el-table-column>
          </el-table>
        </el-card>
      </el-col>
    </el-row>
  </div>
</template>

<script>
import { mapGetters } from 'vuex'
import * as echarts from 'echarts'

export default {
  name: 'DashboardView',
  data() {
    return {
      loading: false,
      recentDetections: [],
      pieChart: null,
      lineChart: null
    }
  },
  computed: {
    ...mapGetters(['detectionStats']),
    stats() {
      const statsData = this.detectionStats || {
        total_count: 0,
        fake_count: 0,
        real_count: 0,
        pending_count: 0,
        completed_count: 0,
        failed_count: 0,
        fake_percentage: 0,
        real_percentage: 0,
        average_confidence: 0
      };
      statsData.fake_percentage = Number(statsData.fake_percentage) || 0;
      statsData.real_percentage = Number(statsData.real_percentage) || 0;
      return statsData;
    }
  },
  watch: {
    stats(newStats) {
      if (newStats) {
        this.initPieChart();
      }
    },
    recentDetections(newDetections) {
      if (newDetections && newDetections.length > 0) {
         this.initLineChart();
      }
    }
  },
  mounted() {
    this.fetchData()
    window.addEventListener('resize', this.handleResize);
  },
  beforeDestroy() {
    window.removeEventListener('resize', this.handleResize);
    if (this.pieChart) {
      this.pieChart.dispose();
      this.pieChart = null;
    }
    if (this.lineChart) {
      this.lineChart.dispose();
      this.lineChart = null;
    }
  },
  methods: {
    fetchData() {
      this.loading = true
      let statsLoaded = false;
      let historyLoaded = false;

      const checkAndInitCharts = () => {
        if (statsLoaded && historyLoaded) {
          this.$nextTick(() => {
             this.initPieChart();
             this.initLineChart();
          });
          this.loading = false;
        }
      };

      this.$store.dispatch('detection/getDetectionStats')
        .then(() => { statsLoaded = true; checkAndInitCharts(); })
        .catch(error => {
          console.error('获取统计数据失败:', error)
          this.$message.error('获取统计数据失败，请稍后重试')
          statsLoaded = true;
          checkAndInitCharts();
        });
      
      this.$store.dispatch('detection/getDetectionHistory')
        .then(detections => {
          this.recentDetections = detections.slice(0, 7);
          historyLoaded = true;
          checkAndInitCharts();
        })
        .catch(error => {
          console.error('获取检测历史失败:', error)
          this.$message.error('获取检测历史失败，请稍后重试')
          historyLoaded = true;
          checkAndInitCharts();
        });
    },
    
    initPieChart() {
      if (!this.$refs.pieChart) return;
      if (this.pieChart) {
        this.pieChart.dispose();
      }
      this.pieChart = echarts.init(this.$refs.pieChart);
      
      // 准备饼图数据
      const pieData = [];
      
      // 添加真实新闻数据
      if (this.stats.real_count > 0) {
        pieData.push({ 
          value: this.stats.real_count, 
          name: '真实新闻', 
          itemStyle: { color: '#67C23A' } 
        });
      }
      
      // 添加虚假新闻数据
      if (this.stats.fake_count > 0) {
        pieData.push({ 
          value: this.stats.fake_count, 
          name: '虚假新闻', 
          itemStyle: { color: '#F56C6C' } 
        });
      }
      
      // 添加其他类型的数据
      const otherCount = this.stats.completed_count - this.stats.real_count - this.stats.fake_count;
      if (otherCount > 0) {
        pieData.push({ 
          value: otherCount, 
          name: '其他类型', 
          itemStyle: { color: '#909399' } 
        });
      }
      
      const option = {
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b}: {c} ({d}%)'
        },
        legend: {
          orient: 'vertical',
          left: 10,
          data: pieData.map(item => item.name)
        },
        series: [
          {
            name: '检测结果',
            type: 'pie',
            radius: ['50%', '70%'],
            avoidLabelOverlap: false,
            label: {
              show: false,
              position: 'center'
            },
            emphasis: {
              label: {
                show: true,
                fontSize: '20',
                fontWeight: 'bold'
              }
            },
            labelLine: {
              show: false
            },
            data: pieData
          }
        ]
      };
      this.pieChart.setOption(option);
    },
    
    initLineChart() {
      if (!this.$refs.lineChart || !this.recentDetections || this.recentDetections.length === 0) return;
      if (this.lineChart) {
        this.lineChart.dispose();
      }
      this.lineChart = echarts.init(this.$refs.lineChart);
      
      const countsByDate = this.recentDetections.reduce((acc, detection) => {
        const date = this.formatDate(detection.created_at, true);
        acc[date] = (acc[date] || 0) + 1;
        return acc;
      }, {});
      
      const dates = Object.keys(countsByDate).sort();
      const counts = dates.map(date => countsByDate[date]);
      
      const option = {
        tooltip: {
          trigger: 'axis'
        },
        xAxis: {
          type: 'category',
          boundaryGap: false,
          data: dates
        },
        yAxis: {
          type: 'value',
           minInterval: 1
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        series: [
          {
            name: '检测数量',
            type: 'line',
            smooth: true,
            data: counts,
            itemStyle: { color: '#409EFF' },
            areaStyle: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                    {
                        offset: 0,
                        color: 'rgba(64, 158, 255, 0.3)'
                    },
                    {
                        offset: 1,
                        color: 'rgba(64, 158, 255, 0)'
                    }
                ])
            }
          }
        ]
      };
      this.lineChart.setOption(option);
    },
    
    handleResize() {
      if (this.pieChart) {
        this.pieChart.resize();
      }
      if (this.lineChart) {
        this.lineChart.resize();
      }
    },

    formatDate(dateString, dateOnly = false) {
      if (!dateString) return '-'
      const date = new Date(dateString)
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      if (dateOnly) {
          return `${year}-${month}-${day}`;
      }
      const hours = String(date.getHours()).padStart(2, '0');
      const minutes = String(date.getMinutes()).padStart(2, '0');
      return `${year}-${month}-${day} ${hours}:${minutes}`
    },
    
    getStatusType(status) {
      switch (status) {
        case 'completed': return 'success'
        case 'pending': return 'info'
        case 'processing': return 'warning'
        case 'failed': return 'danger'
        default: return 'info'
      }
    },
    
    getStatusText(status) {
      switch (status) {
        case 'completed': return '完成'
        case 'pending': return '等待中'
        case 'processing': return '处理中'
        case 'failed': return '失败'
        default: return '未知'
      }
    },
    
    viewDetail(id) {
      this.$router.push(`/dashboard/detection/detail/${id}`)
    },
    
    viewMore() {
      this.$router.push('/dashboard/detection/history')
    },

    getResultTagType(result) {
      if (result === 'fake') return 'danger';
      if (result === 'real') return 'success';
      if (result === 'uncertain') return 'warning';
      if (result === 'mixed') return 'warning';
      return 'info';
    },

    getResultText(result) {
      if (result === 'fake') return '虚假';
      if (result === 'real') return '真实';
      if (result === 'uncertain') return '不确定';
      if (result === 'mixed') return '混合';
      return result || '未知';
    },
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.dashboard-container {
  padding: 20px;
  height: calc(100vh - 84px);
  overflow-y: auto;
}

.dashboard-card {
  height: 120px;
  
  .card-content {
    display: flex;
    align-items: center;
    height: 100%;
  }
  
  .card-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: $primary-color;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-right: 20px;
    
    i {
      font-size: 30px;
      color: white;
    }
    
    &.real {
      background-color: $success-color;
    }
    
    &.fake {
      background-color: $danger-color;
    }
    
    &.pending {
      background-color: $warning-color;
    }
  }
  
  .card-info {
    display: flex;
    flex-direction: column;
    
    .card-title {
      font-size: 14px;
      color: $regular-font-color;
      margin-bottom: 10px;
    }
    
    .card-value {
      font-size: 24px;
      font-weight: bold;
      color: $main-font-color;
    }
  }
}

.chart-row {
  margin-top: 20px;
  margin-bottom: 20px;
}

.chart-card {
  height: 400px;
  
  .chart-container {
    height: 320px;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #909399;
    font-size: 16px;
  }
}
</style> 

================================================================================
文件路径: src\views\detection\Create.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\detection\Create.vue
================================================================================

<template>
  <div class="detection-create-container">
    <div class="page-title">新闻检测</div>
    
    <el-row :gutter="20">
      <el-col :span="16">
        <el-card shadow="hover" class="detection-card">
          <div slot="header" class="clearfix">
            <span>输入新闻信息</span>
            <el-button 
              style="float: right; padding: 3px 0;" 
              type="text" 
              @click="resetForm"
            >
              清空表单
            </el-button>
          </div>
          
          <el-form 
            ref="detectionForm" 
            :model="detectionForm" 
            :rules="rules" 
            label-position="top"
          >
            <el-form-item label="新闻标题" prop="title">
              <el-input v-model="detectionForm.title" placeholder="输入新闻标题"></el-input>
            </el-form-item>
            
            <el-form-item label="新闻内容" prop="content">
              <el-input 
                type="textarea" 
                v-model="detectionForm.content" 
                placeholder="输入新闻内容" 
                :rows="8"
              ></el-input>
            </el-form-item>
            
            <el-form-item label="新闻图片" prop="image">
              <el-upload
                class="upload-demo"
                drag
                action="#"
                :auto-upload="false"
                :on-change="handleImageChange"
                :limit="1"
                :file-list="fileList"
              >
                <i class="el-icon-upload"></i>
                <div class="el-upload__text">拖拽图片到此处，或<em>点击上传</em></div>
                <div class="el-upload__tip" slot="tip">只能上传jpg/png/jpeg文件，且不超过10MB</div>
              </el-upload>
            </el-form-item>
            
            <el-form-item>
              <el-button type="primary" @click="submitForm" :loading="loading">开始检测</el-button>
            </el-form-item>
          </el-form>
        </el-card>
      </el-col>
      
      <el-col :span="8">
        <el-card shadow="hover" class="info-card">
          <div slot="header" class="clearfix">
            <span>检测说明</span>
          </div>
          <div class="info-content">
            <p>本系统支持多模态虚假新闻检测，结合文本内容与图像分析，提供更准确的检测结果。</p>
            <h4>使用须知：</h4>
            <ul>
              <li>新闻标题和内容均为必填项</li>
              <li>图片可选（提供图片将启用多模态检测）</li>
              <li>支持JPG、JPEG、PNG格式图片</li>
              <li>检测历史可在"检测历史"页面查看</li>
            </ul>
            <h4>检测流程：</h4>
            <ol>
              <li>输入新闻内容</li>
              <li>上传相关图片（可选）</li>
              <li>点击"开始检测"按钮</li>
              <li>系统分析并返回结果</li>
            </ol>
          </div>
        </el-card>
      </el-col>
    </el-row>
  </div>
</template>

<script>
import axios from 'axios'

export default {
  name: 'DetectionCreate',
  data() {
    return {
      detectionForm: {
        title: '',
        content: '',
        image: null
      },
      rules: {
        title: [
          { required: true, message: '请输入新闻标题', trigger: 'blur' },
          { min: 2, max: 100, message: '标题长度在2到100个字符之间', trigger: 'blur' }
        ],
        content: [
          { required: true, message: '请输入新闻内容', trigger: 'blur' },
          { min: 10, message: '内容不能少于10个字符', trigger: 'blur' }
        ]
      },
      fileList: [],
      loading: false
    }
  },
  methods: {
    handleImageChange(file) {
      // 上传前校验文件类型和大小
      const isImage = file.raw.type.includes('image/')
      const isLt10M = file.raw.size / 1024 / 1024 < 10
      
      if (!isImage) {
        this.$message.error('上传文件只能是图片格式!')
        this.fileList = []
        return false
      }
      
      if (!isLt10M) {
        this.$message.error('上传图片大小不能超过 10MB!')
        this.fileList = []
        return false
      }
      
      // 设置当前图片
      this.detectionForm.image = file.raw
      this.fileList = [file]
    },
    
    submitForm() {
      this.$refs.detectionForm.validate(valid => {
        if (valid) {
          this.loading = true
          
          const formData = new FormData();
          formData.append('title', this.detectionForm.title);
          formData.append('content', this.detectionForm.content);
          
          if (this.detectionForm.image) {
            formData.append('image', this.detectionForm.image);
          }
          
          axios.post('/detection/detections/', formData, {
            headers: {
              'Content-Type': 'multipart/form-data'
            }
          })
            .then(response => {
              this.$message.success('检测任务已提交')
              // 修正：跳转到包含父路径的完整路由
              this.$router.push(`/dashboard/detection/detail/${response.data.id}`)
            })
            .catch(error => {
              console.error('检测提交失败:', error)
              this.$message.error('检测提交失败: ' + (error.response?.data?.detail || '请稍后重试'))
            })
            .finally(() => {
              this.loading = false
            })
        } else {
          return false
        }
      })
    },
    
    resetForm() {
      this.$refs.detectionForm.resetFields()
      this.fileList = []
      this.detectionForm.image = null
    }
  }
}
</script>

<style scoped>
.detection-create-container {
  padding: 20px;
}

.detection-card {
  margin-bottom: 20px;
}

.info-card {
  margin-bottom: 20px;
}

.info-content {
  font-size: 14px;
  color: #606266;
  line-height: 1.6;
}

.info-content h4 {
  margin-top: 16px;
  margin-bottom: 8px;
  color: #303133;
}

.info-content ul, .info-content ol {
  padding-left: 20px;
  margin-bottom: 16px;
}

.info-content li {
  margin-bottom: 5px;
}
</style> 

================================================================================
文件路径: src\views\detection\Detail.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\detection\Detail.vue
================================================================================

<template>
  <div class="detail-container">
    <div class="page-header">
      <el-page-header @back="goBack" :content="detection ? detection.title : '检测详情'"></el-page-header>
    </div>
    
    <div v-loading="loading">
      <el-row :gutter="20" v-if="detection">
        <el-col :span="16">
          <el-card class="detection-card">
            <div slot="header" class="clearfix">
              <span>新闻内容</span>
              <el-tag :type="getResultType" class="result-tag">{{ getResultText }}</el-tag>
            </div>
            
            <div class="detection-header">
              <h2>{{ detection.title }}</h2>
              <div class="detection-meta">
                <span>检测时间: {{ formatDate(detection.created_at) }}</span>
                <el-tag size="small" :type="getStatusType(detection.status)">{{ getStatusText(detection.status) }}</el-tag>
              </div>
            </div>
            
            <div class="detection-content">
              <div v-if="detection.image" class="detection-image">
                <el-image 
                  :src="detection.image" 
                  fit="cover"
                  :preview-src-list="[detection.image]">
                </el-image>
              </div>
              
              <div class="news-content">
                <p>{{ detection.content }}</p>
              </div>
            </div>

            <!-- LLM交叉验证结果 -->
            <div class="llm-results-section" v-if="detection.status === 'completed' && llmIndividualResults.length > 0">
              <el-divider content-position="left">LLM 交叉验证结果</el-divider>
              <el-table :data="llmIndividualResults" size="medium" border stripe style="width: 100%">
                <el-table-column prop="model" label="模型" width="160" show-overflow-tooltip></el-table-column>
                <el-table-column prop="verdict" label="判断" width="90" align="center">
                  <template slot-scope="scope">
                    <el-tag :type="getLlmVerdictType(scope.row.verdict)" size="small">{{ scope.row.verdict }}</el-tag>
                  </template>
                </el-table-column>
                <el-table-column prop="confidence" label="置信度" width="80" align="center">
                  <template slot-scope="scope">
                    <span v-if="scope.row.confidence">{{ (scope.row.confidence * 100).toFixed(1) }}%</span>
                    <span v-else>-</span>
                  </template>
                </el-table-column>
                <el-table-column prop="reason" label="理由" show-overflow-tooltip></el-table-column>
                <el-table-column prop="error" label="错误" width="100" show-overflow-tooltip></el-table-column>
              </el-table>
            </div>
          </el-card>
        </el-col>
        
        <el-col :span="8">
          <el-card class="result-card" v-if="detection.status === 'completed'">
            <div slot="header" class="clearfix">
              <span>检测结果</span>
            </div>
            
            <div class="result-info">
              <div class="result-item">
                <div class="result-label">最终结论</div>
                <div class="result-value">
                  <el-tag :type="getResultType" size="medium">{{ getResultText }}</el-tag>
                </div>
              </div>
              
              <div class="result-item">
                <div class="result-label">最终置信度</div>
                <div class="result-value">
                  <el-progress 
                    v-if="getResultType !== 'info'"
                    :percentage="getConfidenceValue" 
                    :color="getResultType === 'danger' ? '#F56C6C' : '#67C23A'">
                  </el-progress>
                  <span v-else>不适用</span>
                </div>
              </div>

              <el-collapse v-model="activeAnalysisSections" v-if="detection.analysis_result">
                <el-collapse-item title="详细分析过程" name="details">
                  <div class="analysis-section" v-if="analysisDetails.fusion">
                    <h4><i class="el-icon-connection"></i> 融合策略</h4>
                    <p>策略: {{ analysisDetails.fusion.strategy || '未知' }}</p>
                    <p v-if="analysisDetails.fusion.final_verdict !== 'unknown'">
                      置信度: {{ (analysisDetails.fusion.final_confidence * 100).toFixed(2) }}%
                    </p>
                  </div>

                  <div class="analysis-section" v-if="analysisDetails.local_model">
                    <h4><i class="el-icon-cpu"></i> 本地模型概要</h4>
                    <p>结果: 
                      <el-tag 
                        :type="getVerdictType(analysisDetails.local_model.result)" 
                        size="small"
                      >
                        {{ getVerdictText(analysisDetails.local_model.result) }}
                      </el-tag>
                    </p>
                    <p v-if="analysisDetails.local_model.result !== 'unknown'">置信度: {{ (analysisDetails.local_model.confidence * 100).toFixed(2) }}%</p>
                    <p v-if="analysisDetails.local_model.error">错误: {{ analysisDetails.local_model.error }}</p>
                  </div>

                  <div class="analysis-section" v-if="analysisDetails.llm_verification">
                    <h4><i class="el-icon-chat-dot-round"></i> LLM 交叉验证</h4>
                    <p>综合判断: 
                       <el-tag 
                         :type="getLlmVerdictType(analysisDetails.llm_verification.overall_verdict)" 
                         size="small"
                       >
                         {{ analysisDetails.llm_verification.overall_verdict || '未知' }}
                       </el-tag>
                    </p>
                    <p>综合置信度: {{ (analysisDetails.llm_verification.aggregated_confidence * 100).toFixed(2) }}%</p>
                    <p v-if="analysisDetails.llm_verification.needs_manual_review" style="color: orange;"><i class="el-icon-warning-outline"></i> 需要人工审核</p>
                    <p v-if="analysisDetails.llm_verification.error">错误: {{ analysisDetails.llm_verification.error }}</p>
                  </div>
                </el-collapse-item>
              </el-collapse>
            </div>
          </el-card>
          
          <el-card class="waiting-card" v-else-if="detection.status === 'pending' || detection.status === 'processing'">
            <div slot="header" class="clearfix">
              <span>检测中</span>
            </div>
            
            <div class="waiting-content">
              <i class="el-icon-loading"></i>
              <p>检测任务{{ detection.status === 'pending' ? '等待中' : '处理中' }}，请稍候...</p>
              <el-button type="primary" size="small" @click="refreshResult">刷新结果</el-button>
            </div>
          </el-card>
          
          <el-card class="error-card" v-else-if="detection.status === 'failed'">
            <div slot="header" class="clearfix">
              <span>检测失败</span>
            </div>
            
            <div class="error-content">
              <i class="el-icon-circle-close"></i>
              <p>很抱歉，检测任务处理失败。</p>
              <div v-if="detection.error_message" class="error-message">
                错误信息: {{ detection.error_message }}
              </div>
              <el-button type="primary" size="small" @click="retryDetection">重新检测</el-button>
            </div>
          </el-card>
        </el-col>
      </el-row>
      
      <div v-else class="empty-state">
        <i class="el-icon-warning-outline"></i>
        <p>未找到检测数据或加载失败</p>
        <el-button type="primary" @click="goToHistory">返回历史记录</el-button>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios';

export default {
  name: 'DetectionDetail',
  data() {
    return {
      loading: true,
      detectionId: null,
      pollingInterval: null,
      pollingDelay: 5000,
      activeAnalysisSections: ['details']
    }
  },
  computed: {
    detection() {
      const det = this.$store.getters.currentDetection;
      if (det && (det.status === 'completed' || det.status === 'failed')) {
        this.stopPolling();
      }
      return det;
    },
    getResultType() {
      // 读取融合结果
      const verdict = this.analysisDetails.fusion?.final_verdict;
      if (!verdict) return 'info';
      if (verdict === 'real') return 'success';
      if (verdict === 'fake') return 'danger';
      return 'info'; // 对于unknown和其他未预期的值，都返回info
    },
    getResultText() {
      // 读取融合结果
      const verdict = this.analysisDetails.fusion?.final_verdict;
      if (!verdict) return '未知';
      if (verdict === 'real') return '真实新闻';
      if (verdict === 'fake') return '虚假新闻';
      return '未能确定'; // 更明确的未知状态文本
    },
    getConfidenceValue() {
      // 读取融合结果
      const confidence = this.analysisDetails.fusion?.final_confidence;
      const verdict = this.analysisDetails.fusion?.final_verdict;
      if (confidence === null || confidence === undefined || verdict === 'unknown') return 0;
      // 确保置信度在0-100之间
      return Math.min(100, Math.max(0, Math.round(confidence * 100)));
    },
    isProcessing() {
      return this.detection && (this.detection.status === 'pending' || this.detection.status === 'processing');
    },
    analysisDetails() {
      if (this.detection && this.detection.analysis_result) {
        if (typeof this.detection.analysis_result === 'string') {
          try {
            return JSON.parse(this.detection.analysis_result);
          } catch (e) {
            console.error("Failed to parse analysis_result JSON:", e);
            return {};
          }
        } else {
          return this.detection.analysis_result;
        }
      } 
      return {};
    },
    llmIndividualResults() {
       if (this.analysisDetails && this.analysisDetails.llm_verification && this.analysisDetails.llm_verification.details) {
         const details = this.analysisDetails.llm_verification.details;
         const textResults = details.text_verifications || [];
         const imgResults = details.image_verifications || [];
         return [...textResults, ...imgResults];
       }
       return [];
    }
  },
  created() {
    this.detectionId = this.$route.params.id
    this.fetchDetailAndPoll();
  },
  beforeDestroy() {
    this.stopPolling();
  },
  methods: {
    fetchDetailAndPoll() {
      this.loading = true;
      this.$store.dispatch('detection/getDetectionDetail', this.detectionId)
        .then(() => {
          this.loading = false;
          if (this.isProcessing) {
            this.startPolling();
          }
        })
        .catch(error => {
          this.loading = false;
          console.error('获取检测详情失败:', error);
          this.$message.error('获取检测详情失败，请稍后重试');
        });
    },

    startPolling() {
      this.stopPolling();
      logger.info('开始轮询检测结果...');
      this.pollingInterval = setInterval(() => {
        if (!this.isProcessing) {
          this.stopPolling();
          return;
        }
        logger.debug(`轮询检测结果 ID: ${this.detectionId}`);
        this.$store.dispatch('detection/getDetectionDetail', this.detectionId)
          .catch(error => {
            console.error('轮询失败:', error);
          });
      }, this.pollingDelay);
    },

    stopPolling() {
      if (this.pollingInterval) {
        logger.info('停止轮询检测结果。');
        clearInterval(this.pollingInterval);
        this.pollingInterval = null;
      }
    },

    formatDate(dateString) {
      if (!dateString) return '-'
      const date = new Date(dateString)
      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`
    },
    
    getStatusType(status) {
      switch (status) {
        case 'completed': return 'success'
        case 'pending': return 'info'
        case 'processing': return 'warning'
        case 'failed': return 'danger'
        default: return 'info'
      }
    },
    
    getStatusText(status) {
      switch (status) {
        case 'completed': return '完成'
        case 'pending': return '等待中'
        case 'processing': return '处理中'
        case 'failed': return '失败'
        default: return '未知'
      }
    },
    
    goBack() {
      this.$router.go(-1)
    },
    
    goToHistory() {
      this.$router.push('/dashboard/detection/history')
    },
    
    refreshResult() {
      this.fetchDetailAndPoll();
      this.$message.info('正在刷新结果...');
    },
    
    retryDetection() {
      this.stopPolling();
      const data = {
        title: this.detection.title,
        content: this.detection.content,
        image: this.detection.original_image
      }
      
      this.$store.dispatch('detection/createDetection', data)
        .then(response => {
          this.$message.success('已重新提交检测任务')
          this.$router.push(`/detection/detail/${response.id}`)
        })
        .catch(error => {
          console.error('重新检测失败:', error)
          this.$message.error('重新检测失败: ' + (error.response?.data?.detail || '请稍后重试'))
        })
    },

    getVerdictType(result) {
      if (result === 'fake') return 'danger';
      if (result === 'real') return 'success';
      return 'info';
    },
    getVerdictText(result) {
      if (result === 'fake') return '虚假';
      if (result === 'real') return '真实';
      return '未知';
    },
    getLlmVerdictType(verdict) {
      if (!verdict) return 'info';
      const lowerVerdict = verdict.toLowerCase();
      if (lowerVerdict.includes('fake') || lowerVerdict.includes('虚假') || lowerVerdict.includes('伪造')) return 'danger';
      if (lowerVerdict.includes('true') || lowerVerdict.includes('真实')) return 'success';
      if (lowerVerdict.includes('uncertain') || lowerVerdict.includes('无法') || lowerVerdict.includes('混合')) return 'warning';
      return 'info';
    },
    fetchDetailData() {
      this.loading = true;
      
      axios.get(`/detection/detections/${this.$route.params.id}/`)
        .then(response => {
          this.detailData = response.data;
          this.loading = false;
        })
    }
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.detail-container {
  padding: 20px;
}

.page-header {
  margin-bottom: 20px;
}

.detection-card, .result-card, .waiting-card, .error-card {
  margin-bottom: 20px;
}

.detection-header {
  margin-bottom: 20px;
  
  h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1.5rem;
  }
  
  .detection-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #888;
    font-size: 0.9rem;
  }
}

.detection-content {
  .detection-image {
    margin-bottom: 20px;
    text-align: center;
    
    img {
      max-width: 100%;
      max-height: 300px;
      border-radius: 4px;
    }
  }
  
  .news-content {
    line-height: 1.6;
    color: #333;
    word-break: break-word;
  }
}

.llm-results-section {
  margin-top: 20px;
  
  .el-divider__text {
    font-weight: bold;
    color: #409EFF;
  }
  
  .el-table {
    margin-top: 15px;
    
    .el-table__row {
      font-size: 0.9rem;
    }
  }
}

.result-info {
  .result-item {
    margin-bottom: 20px;
    
    .result-label {
      font-weight: bold;
      margin-bottom: 5px;
      color: #555;
    }
    
    .result-value {
      font-size: 1.1rem;
    }
  }
}

.analysis-section {
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px dashed #eee;
  
  &:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
  }
  
  h4 {
    margin-top: 0;
    margin-bottom: 10px;
    color: #333;
    
    i {
      margin-right: 5px;
      color: #409EFF;
    }
  }
  
  p {
    margin: 5px 0;
    line-height: 1.5;
  }
}

.waiting-content, .error-content {
  text-align: center;
  padding: 20px 0;
  
  i {
    font-size: 36px;
    margin-bottom: 15px;
    display: block;
  }
  
  p {
    margin-bottom: 20px;
  }
}

.waiting-content {
  i {
    color: #E6A23C;
  }
}

.error-content {
  i {
    color: #F56C6C;
  }
  
  .error-message {
    background: #FEF0F0;
    padding: 10px;
    border-radius: 4px;
    margin-bottom: 15px;
    color: #F56C6C;
    text-align: left;
  }
}

.empty-state {
  text-align: center;
  padding: 50px 0;
  
  i {
    font-size: 48px;
    color: #909399;
    margin-bottom: 20px;
  }
  
  p {
    margin-bottom: 20px;
    color: #909399;
  }
}

.result-tag {
  float: right;
}
</style> 
</style> 
</style> 

================================================================================
文件路径: src\views\detection\History.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\detection\History.vue
================================================================================

<template>
  <div class="history-container">
    <div class="page-title">检测历史</div>
    
    <el-card shadow="hover">
      <div class="filter-container">
        <el-input
          placeholder="搜索标题"
          v-model="searchQuery"
          style="width: 200px;"
          clearable
          @clear="handleFilter"
          @keyup.enter.native="handleFilter"
        >
          <i slot="prefix" class="el-input__icon el-icon-search"></i>
        </el-input>
        
        <el-select v-model="statusFilter" placeholder="状态" clearable style="width: 120px;" @change="handleFilter">
          <el-option
            v-for="item in statusOptions"
            :key="item.value"
            :label="item.label"
            :value="item.value">
          </el-option>
        </el-select>
        
        <el-select v-model="resultFilter" placeholder="结果" clearable style="width: 120px;" @change="handleFilter">
          <el-option
            v-for="item in resultOptions"
            :key="item.value"
            :label="item.label"
            :value="item.value">
          </el-option>
        </el-select>
        
        <el-date-picker
          v-model="dateRange"
          type="daterange"
          range-separator="至"
          start-placeholder="开始日期"
          end-placeholder="结束日期"
          style="width: 300px;"
          @change="handleFilter"
        >
        </el-date-picker>
        
        <el-button class="filter-item" type="primary" icon="el-icon-search" @click="handleFilter">
          搜索
        </el-button>
      </div>
      
      <el-table
        :data="filteredDetections"
        style="width: 100%; margin-top: 20px;"
        v-loading="loading"
        border
      >
        <el-table-column
          prop="title"
          label="标题"
          min-width="200"
        ></el-table-column>
        <el-table-column
          prop="created_at"
          label="检测时间"
          width="180"
        >
          <template slot-scope="scope">
            {{ formatDate(scope.row.created_at) }}
          </template>
        </el-table-column>
        <el-table-column
          prop="status"
          label="状态"
          width="100"
        >
          <template slot-scope="scope">
            <el-tag :type="getStatusType(scope.row.status)">{{ getStatusText(scope.row.status) }}</el-tag>
          </template>
        </el-table-column>
        <el-table-column
          prop="result"
          label="结果"
          width="100"
        >
          <template slot-scope="scope">
            <el-tag v-if="scope.row.result != null" :type="scope.row.result === 'real' ? 'success' : (scope.row.result === 'fake' ? 'danger' : 'info')">
              {{ scope.row.result === 'real' ? '真实' : (scope.row.result === 'fake' ? '虚假' : '未知') }}
            </el-tag>
            <span v-else>-</span>
          </template>
        </el-table-column>
        <el-table-column
          prop="confidence_score"
          label="置信度"
          width="100"
        >
          <template slot-scope="scope">
            <div v-if="scope.row.confidence_score != null">{{ (scope.row.confidence_score * 100).toFixed(2) }}%</div>
            <span v-else>-</span>
          </template>
        </el-table-column>
        <el-table-column
          fixed="right"
          label="操作"
          width="180">
          <template slot-scope="scope">
            <el-button
              @click="viewDetail(scope.row.id)"
              type="text"
              size="small">
              查看详情
            </el-button>
            <el-button
              @click="handleDelete(scope.row)"
              type="text"
              size="small"
              style="color: #F56C6C;">
              删除
            </el-button>
          </template>
        </el-table-column>
      </el-table>
      
      <div class="pagination-container">
        <el-pagination
          background
          @size-change="handleSizeChange"
          @current-change="handleCurrentChange"
          :current-page="currentPage"
          :page-sizes="[10, 20, 30, 50]"
          :page-size="pageSize"
          layout="total, sizes, prev, pager, next, jumper"
          :total="totalItems">
        </el-pagination>
      </div>
    </el-card>

    <el-dialog
      title="确认删除"
      :visible.sync="deleteDialogVisible"
      width="30%">
      <span>确定要删除这条检测记录吗？此操作不可恢复。</span>
      <span slot="footer" class="dialog-footer">
        <el-button @click="deleteDialogVisible = false">取消</el-button>
        <el-button type="danger" @click="confirmDelete" :loading="deleteLoading">确定删除</el-button>
      </span>
    </el-dialog>
  </div>
</template>

<script>
import axios from 'axios'
import { deleteDetection } from '@/api/detection'

export default {
  name: 'DetectionHistory',
  data() {
    return {
      loading: false,
      searchQuery: '',
      statusFilter: '',
      resultFilter: '',
      dateRange: [],
      currentPage: 1,
      pageSize: 10,
      totalItems: 0,
      tableData: [],
      
      // 删除相关数据
      deleteDialogVisible: false,
      deleteLoading: false,
      currentDeleteItem: null,
      
      statusOptions: [
        { value: 'completed', label: '完成' },
        { value: 'pending', label: '等待中' },
        { value: 'processing', label: '处理中' },
        { value: 'failed', label: '失败' }
      ],
      resultOptions: [
        { value: 'real', label: '真实' },
        { value: 'fake', label: '虚假' },
        { value: 'unknown', label: '未知' }
      ]
    }
  },
  computed: {
    filteredData() {
      let filteredData = [...this.tableData];
      
      // 应用标题搜索
      if (this.searchQuery) {
        const query = this.searchQuery.toLowerCase();
        filteredData = filteredData.filter(item => 
          item.title.toLowerCase().includes(query)
        );
      }
      
      // 应用状态过滤
      if (this.statusFilter) {
        filteredData = filteredData.filter(item => 
          item.status === this.statusFilter
        );
      }
      
      // 应用结果过滤
      if (this.resultFilter !== '') {
        filteredData = filteredData.filter(item => 
          item.result === this.resultFilter
        );
      }
      
      // 应用日期范围过滤
      if (this.dateRange && this.dateRange.length === 2) {
        const startDate = new Date(this.dateRange[0]);
        startDate.setHours(0, 0, 0, 0);
        const endDate = new Date(this.dateRange[1]);
        endDate.setHours(23, 59, 59, 999);
        
        filteredData = filteredData.filter(item => {
          const itemDate = new Date(item.created_at);
          return itemDate >= startDate && itemDate <= endDate;
        });
      }
      
      return filteredData;
    },
    filteredDetections() {
      // 分页
      const start = (this.currentPage - 1) * this.pageSize;
      const end = start + this.pageSize;
      return this.filteredData.slice(start, end);
    }
  },
  mounted() {
    this.fetchData();
  },
  methods: {
    fetchData() {
      this.loading = true;
      
      // 检查是否在管理员路径下
      const isAdmin = this.$route.path.includes('/admin/');
      // 使用不同的API端点，管理员查看所有记录，普通用户查看自己的记录
      const endpoint = isAdmin ? '/detection/detections/' : '/detection/detections/my_detections/';
      const params = { page: this.currentPage, limit: this.pageSize };
      
      axios.get(endpoint, { params })
        .then(response => {
          this.tableData = response.data.results;
          this.totalItems = response.data.count;
          this.loading = false;
        })
        .catch(error => {
          console.error('获取检测历史失败:', error);
          this.$message.error(
            error.response && error.response.status === 404 
              ? 'API路径错误，请检查后端配置' 
              : '获取检测历史失败，请稍后重试'
          );
          this.loading = false;
        });
    },
    
    formatDate(dateString) {
      if (!dateString) return '-';
      const date = new Date(dateString);
      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
    },
    
    getStatusType(status) {
      switch (status) {
        case 'completed': return 'success';
        case 'pending': return 'info';
        case 'processing': return 'warning';
        case 'failed': return 'danger';
        default: return 'info';
      }
    },
    
    getStatusText(status) {
      switch (status) {
        case 'completed': return '完成';
        case 'pending': return '等待中';
        case 'processing': return '处理中';
        case 'failed': return '失败';
        default: return '未知';
      }
    },
    
    handleFilter() {
      this.currentPage = 1;
      // 本地过滤时不需要重新请求
    },
    
    handleSizeChange(val) {
      this.pageSize = val;
      this.fetchData();
    },
    
    handleCurrentChange(val) {
      this.currentPage = val;
      this.fetchData();
    },
    
    viewDetail(id) {
      // 根据当前路由判断是管理员还是普通用户视图
      const isAdmin = this.$route.path.includes('/admin/');
      const baseUrl = isAdmin ? '/admin' : '/dashboard';
      this.$router.push(`${baseUrl}/detection/detail/${id}`);
    },
    
    // 删除操作
    handleDelete(row) {
      this.currentDeleteItem = row;
      this.deleteDialogVisible = true;
    },
    
    confirmDelete() {
      if (!this.currentDeleteItem) return;
      
      this.deleteLoading = true;
      
      // 使用API方法删除
      deleteDetection(this.currentDeleteItem.id)
        .then(() => {
          this.$message({
            type: 'success',
            message: '删除成功'
          });
          this.deleteDialogVisible = false;
          // 重新加载数据
          this.fetchData();
        })
        .catch(error => {
          console.error('删除失败:', error);
          let errorMsg = '删除失败，请稍后重试';
          
          if (error.response) {
            if (error.response.status === 403) {
              errorMsg = '没有删除权限，请联系管理员';
            } else if (error.response.status === 404) {
              errorMsg = '记录不存在，可能已被删除';
            }
          }
          
          this.$message.error(errorMsg);
        })
        .finally(() => {
          this.deleteLoading = false;
          this.currentDeleteItem = null;
        });
    }
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.history-container {
  padding: 20px;
}

.filter-container {
  display: flex;
  align-items: center;
  margin-bottom: 20px;
  flex-wrap: wrap;
  gap: 10px;
}

.pagination-container {
  margin-top: 20px;
  display: flex;
  justify-content: center;
}
</style> 

================================================================================
文件路径: src\views\layout\Layout.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\layout\Layout.vue
================================================================================

<template>
  <el-container class="app-container">
    <!-- 侧边栏 -->
    <el-aside :width="isCollapsed ? '64px' : '240px'" class="sidebar-container" :class="{ 'collapsed': isCollapsed }">
      <div class="logo">
        <el-image :src="logoSrc" alt="Logo" class="logo-image"></el-image>
        <span class="logo-text" v-show="!isCollapsed">MM-DFD系统</span>
      </div>
      <el-menu
        :default-active="activeMenu"
        :collapse="isCollapsed"
        router
        :collapse-transition="false"
        background-color="#2b2d42"
        text-color="#e9ecef"
        active-text-color="#4cc9f0"
        class="sidebar-menu"
      >
        <el-menu-item v-for="item in visibleRoutes" :key="item.path" :index="'/dashboard/' + item.path">
          <i :class="item.meta ? item.meta.icon : 'el-icon-document'"></i>
          <span slot="title">{{ item.meta ? item.meta.title : item.name }}</span>
        </el-menu-item>
      </el-menu>
    </el-aside>
    
    <el-container class="main-container">
      <!-- 头部 -->
      <el-header class="app-header">
        <div class="header-left">
          <i 
            :class="isCollapsed ? 'el-icon-s-unfold' : 'el-icon-s-fold'" 
            class="toggle-btn" 
            @click="toggleSidebar"
          ></i>
        </div>
        <div class="header-right">
          <el-dropdown trigger="click" @command="handleCommand">
            <div class="user-info">
              <el-avatar :size="32" icon="el-icon-user"></el-avatar>
              <span class="username" v-if="!isSmallScreen">{{ username }}</span>
              <i class="el-icon-arrow-down"></i>
            </div>
            <el-dropdown-menu slot="dropdown">
              <el-dropdown-item command="profile">
                <i class="el-icon-user-solid"></i> 个人中心
              </el-dropdown-item>
              <el-dropdown-item v-if="isAdmin" command="admin">
                <i class="el-icon-s-tools"></i> 管理控制台
              </el-dropdown-item>
              <el-dropdown-item command="logout">
                <i class="el-icon-switch-button"></i> 退出登录
              </el-dropdown-item>
            </el-dropdown-menu>
          </el-dropdown>
        </div>
      </el-header>
      
      <!-- 主体内容 -->
      <el-main class="app-main">
        <transition name="fade" mode="out-in">
          <router-view />
        </transition>
      </el-main>
      
      <!-- 页脚 -->
      <el-footer height="40px" class="app-footer">
        <span>© 2025 多模态深度学习社交媒体虚假新闻检测系统 (MM-DFD)</span>
      </el-footer>
    </el-container>
  </el-container>
</template>

<script>
import { mapGetters } from 'vuex'

export default {
  name: 'LayoutView',
  data() {
    return {
      isCollapsed: false,
      isSmallScreen: false
    }
  },
  computed: {
    ...mapGetters(['user']),
    activeMenu() {
      const { path } = this.$route
      if (path.startsWith('/dashboard/')) {
        return path
      }
      return '/dashboard/index'
    },
    routes() {
      return this.$router.options.routes.find(route => route.path === '/dashboard').children.filter(route => !route.meta || !route.meta.hideInMenu)
    },
    visibleRoutes() {
      return this.$router.options.routes.find(route => route.path === '/dashboard').children.filter(route => !route.meta || !route.meta.hideInMenu)
    },
    username() {
      return this.user.username || '用户'
    },
    isAdmin() {
      return this.user.is_staff === true
    },
    logoSrc() {
      try {
        return require('@/assets/logo.svg')
      } catch (e) {
        return this.$defaultLogo || ''
      }
    }
  },
  methods: {
    toggleSidebar() {
      this.isCollapsed = !this.isCollapsed
    },
    handleCommand(command) {
      if (command === 'logout') {
        this.$store.dispatch('user/logout')
      } else if (command === 'profile') {
        this.$router.push('/dashboard/profile')
      } else if (command === 'admin') {
        this.$router.replace('/admin/dashboard')
      }
    },
    handleResize() {
      this.isSmallScreen = window.innerWidth < 768
      if (window.innerWidth < 992 && !this.isCollapsed) {
        this.isCollapsed = true
      }
    }
  },
  mounted() {
    this.handleResize()
    window.addEventListener('resize', this.handleResize)
  },
  beforeDestroy() {
    window.removeEventListener('resize', this.handleResize)
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.app-container {
  height: 100vh;
  overflow: hidden;
}

.sidebar-container {
  background-color: #2b2d42;
  color: #fff;
  transition: width $transition-base;
  position: relative;
  z-index: 10;
  overflow-x: hidden;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

.main-container {
  transition: margin-left $transition-base;
  position: relative;
  min-height: 100%;
  background: $background-color;
}

.logo {
  height: $header-height;
  display: flex;
  align-items: center;
  padding: 0 15px;
  background-color: #242635;
  overflow: hidden;
}

.logo-image {
  width: 32px;
  height: 32px;
  margin-right: 10px;
  transition: $transition-base;
}

.logo-text {
  color: #fff;
  font-size: 18px;
  font-weight: 600;
  white-space: nowrap;
  transition: opacity 0.3s;
}

.sidebar-menu {
  border-right: none;
  &::v-deep .el-menu-item {
    height: 50px;
    line-height: 50px;
    &.is-active {
      background-color: rgba($primary-color, 0.1) !important;
      &::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        background-color: $primary-color;
      }
    }
    &:hover {
      background-color: rgba(255, 255, 255, 0.05) !important;
    }
  }
}

.app-header {
  background-color: white;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 20px;
  height: $header-height;
  position: relative;
  z-index: 9;
}

.toggle-btn {
  cursor: pointer;
  font-size: 20px;
  color: $regular-font-color;
  transition: $transition-base;
  padding: 10px;
  border-radius: $border-radius-small;
  
  &:hover {
    color: $primary-color;
    background-color: rgba($primary-color, 0.1);
  }
}

.user-info {
  display: flex;
  align-items: center;
  cursor: pointer;
  padding: 5px 10px;
  border-radius: $border-radius-base;
  transition: $transition-base;
  
  &:hover {
    background-color: rgba($primary-color, 0.05);
  }
  
  .username {
    margin: 0 10px;
    font-weight: 500;
  }
}

.app-main {
  padding: 20px;
  overflow-y: auto;
  min-height: calc(100vh - #{$header-height} - 40px);
}

.app-footer {
  text-align: center;
  background-color: #fff;
  color: $secondary-font-color;
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.03);
}

@media (max-width: $md) {
  .app-main {
    padding: 15px;
  }
}
</style> 

================================================================================
文件路径: src\views\login\Login.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\login\Login.vue
================================================================================

<template>
  <div class="login-container">
    <div class="login-form-container">
      <div class="login-header">
        <el-image :src="logoSrc" alt="Logo" class="logo"></el-image>
        <h2>多模态虚假新闻检测系统</h2>
      </div>
      <el-form :model="loginForm" :rules="loginRules" ref="loginForm" class="login-form">
        <el-form-item prop="username">
          <el-input 
            v-model="loginForm.username" 
            placeholder="用户名" 
            prefix-icon="el-icon-user">
          </el-input>
        </el-form-item>
        <el-form-item prop="password">
          <el-input 
            v-model="loginForm.password" 
            type="password" 
            placeholder="密码" 
            prefix-icon="el-icon-lock"
            @keyup.enter.native="handleLogin">
          </el-input>
        </el-form-item>
        <el-form-item>
          <el-button 
            type="primary" 
            :loading="loading" 
            @click="handleLogin" 
            class="login-button">
            登录
          </el-button>
        </el-form-item>
      </el-form>
    </div>
  </div>
</template>

<script>
export default {
  name: 'Login',
  data() {
    return {
      loginForm: {
        username: '',
        password: ''
      },
      loginRules: {
        username: [
          { required: true, message: '请输入用户名', trigger: 'blur' }
        ],
        password: [
          { required: true, message: '请输入密码', trigger: 'blur' }
        ]
      },
      loading: false
    }
  },
  computed: {
    logoSrc() {
      try {
        return require('@/assets/logo.png')
      } catch (e) {
        return this.$defaultLogo || ''
      }
    }
  },
  methods: {
    handleLogin() {
      this.$refs.loginForm.validate(valid => {
        if (valid) {
          this.loading = true
          this.$store.dispatch('user/login', this.loginForm)
            .then(() => {
              this.$router.push({ path: this.redirect || '/' })
              this.loading = false
            })
            .catch(error => {
              this.$message.error(error.message || '登录失败')
              this.loading = false
            })
        } else {
          return false
        }
      })
    }
  }
}
</script>

<style lang="scss" scoped>
.login-container {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: $background-color;
  background-size: cover;
}

.login-form-container {
  width: 400px;
  padding: 30px;
  background-color: white;
  border-radius: $border-radius;
  box-shadow: $box-shadow;
}

.login-header {
  text-align: center;
  margin-bottom: 30px;

  h2 {
    margin-top: 15px;
    font-weight: 500;
    color: $primary-color;
  }

  .logo {
    width: 80px;
    height: 80px;
  }
}

.login-form {
  .login-button {
    width: 100%;
  }
}
</style> 

================================================================================
文件路径: src\views\user\Profile.vue
完整路径: C:\Users\lateyoung\Desktop\MM-DFD\frontend\src\views\user\Profile.vue
================================================================================

<template>
  <div class="profile-container">
    <div class="page-title">个人中心</div>
    
    <el-row :gutter="20">
      <el-col :span="8">
        <el-card shadow="hover" class="user-card">
          <div class="user-avatar">
            <el-avatar :size="100" icon="el-icon-user-solid"></el-avatar>
          </div>
          <div class="user-info">
            <h3>{{ userInfo.username }}</h3>
            <p>{{ userInfo.email }}</p>
            <p>{{ userInfo.is_staff ? '管理员' : '普通用户' }}</p>
            <p>注册时间: {{ formatDate(userInfo.date_joined) }}</p>
          </div>
        </el-card>
      </el-col>
      
      <el-col :span="16">
        <el-card shadow="hover" class="info-edit-card">
          <div slot="header" class="clearfix">
            <span>个人资料</span>
          </div>
          
          <el-form :model="userForm" :rules="rules" ref="userForm" label-width="100px">
            <el-form-item label="用户名" prop="username">
              <el-input v-model="userForm.username"></el-input>
            </el-form-item>
            
            <el-form-item label="邮箱" prop="email">
              <el-input v-model="userForm.email"></el-input>
            </el-form-item>
            
            <el-form-item>
              <el-button type="primary" @click="updateUserInfo" :loading="updateLoading">保存修改</el-button>
            </el-form-item>
          </el-form>
        </el-card>
        
        <el-card shadow="hover" class="password-card">
          <div slot="header" class="clearfix">
            <span>修改密码</span>
          </div>
          
          <el-form :model="passwordForm" :rules="passwordRules" ref="passwordForm" label-width="100px">
            <el-form-item label="当前密码" prop="old_password">
              <el-input v-model="passwordForm.old_password" type="password"></el-input>
            </el-form-item>
            
            <el-form-item label="新密码" prop="new_password">
              <el-input v-model="passwordForm.new_password" type="password"></el-input>
            </el-form-item>
            
            <el-form-item label="确认密码" prop="new_password2">
              <el-input v-model="passwordForm.new_password2" type="password"></el-input>
            </el-form-item>
            
            <el-form-item>
              <el-button type="primary" @click="changePassword" :loading="passwordLoading">修改密码</el-button>
            </el-form-item>
          </el-form>
        </el-card>
      </el-col>
    </el-row>
  </div>
</template>

<script>
import { mapGetters } from 'vuex'

export default {
  name: 'ProfileView',
  data() {
    // 密码确认验证
    const validatePass = (rule, value, callback) => {
      if (value !== this.passwordForm.new_password) {
        callback(new Error('两次输入密码不一致!'))
      } else {
        callback()
      }
    }
    
    return {
      userForm: {
        username: '',
        email: ''
      },
      passwordForm: {
        old_password: '',
        new_password: '',
        new_password2: ''
      },
      rules: {
        username: [
          { required: true, message: '请输入用户名', trigger: 'blur' },
          { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' }
        ],
        email: [
          { required: true, message: '请输入邮箱地址', trigger: 'blur' },
          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }
        ]
      },
      passwordRules: {
        old_password: [
          { required: true, message: '请输入当前密码', trigger: 'blur' }
        ],
        new_password: [
          { required: true, message: '请输入新密码', trigger: 'blur' },
          { min: 6, message: '密码长度不能小于6个字符', trigger: 'blur' }
        ],
        new_password2: [
          { required: true, message: '请再次输入密码', trigger: 'blur' },
          { validator: validatePass, trigger: 'blur' }
        ]
      },
      updateLoading: false,
      passwordLoading: false
    }
  },
  computed: {
    ...mapGetters(['user']),
    userInfo() {
      return this.user || {}
    }
  },
  mounted() {
    this.initUserForm()
  },
  methods: {
    initUserForm() {
      this.userForm = {
        username: this.userInfo.username || '',
        email: this.userInfo.email || ''
      }
    },
    
    formatDate(dateString) {
      if (!dateString) return '-'
      const date = new Date(dateString)
      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`
    },
    
    updateUserInfo() {
      this.$refs.userForm.validate(valid => {
        if (valid) {
          this.updateLoading = true
          this.$store.dispatch('user/updateUserInfo', this.userForm)
            .then(() => {
              this.$message.success('个人资料已更新')
            })
            .catch(error => {
              console.error('更新资料失败:', error)
              this.$message.error('更新资料失败: ' + (error.response?.data?.detail || '请稍后重试'))
            })
            .finally(() => {
              this.updateLoading = false
            })
        } else {
          return false
        }
      })
    },
    
    changePassword() {
      this.$refs.passwordForm.validate(valid => {
        if (valid) {
          this.passwordLoading = true
          this.$store.dispatch('user/changePassword', this.passwordForm)
            .then(() => {
              this.$message.success('密码已修改，请重新登录')
              // 清空表单
              this.passwordForm = {
                old_password: '',
                new_password: '',
                new_password2: ''
              }
              // 登出并跳转到登录页
              this.$store.dispatch('user/logout')
            })
            .catch(error => {
              console.error('修改密码失败:', error)
              this.$message.error('修改密码失败: ' + (error.response?.data?.detail || '当前密码可能不正确'))
            })
            .finally(() => {
              this.passwordLoading = false
            })
        } else {
          return false
        }
      })
    }
  }
}
</script>

<style lang="scss" scoped>
@import "@/assets/css/variables.scss";

.profile-container {
  padding: 20px;
}

.user-card {
  text-align: center;
  padding: 20px;
  margin-bottom: 20px;
  
  .user-avatar {
    margin-bottom: 20px;
  }
  
  .user-info {
    h3 {
      margin-top: 0;
      margin-bottom: 10px;
      color: $main-font-color;
    }
    
    p {
      margin: 5px 0;
      color: $regular-font-color;
    }
  }
}

.info-edit-card {
  margin-bottom: 20px;
}

.password-card {
  margin-bottom: 20px;
}
</style> 